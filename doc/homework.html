<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>BE25204002 作业汇总</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">BE25204002 作业汇总</h1>



<div id="question" class="section level2">
<h2>Question</h2>
<p>Go through the book “R for Beginners” if you are not familiar with R
programming</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>作为一名R语言初学者，对“R for
Beginners”进行阅读，并进行简单总结。</p>
<p>1、R的功能与特点：</p>
<p>（a）功能：统计分析、绘图。</p>
<p>（b）特点：解释型语言，无需编写完整程序，输入命令后可直接执行。有着很好的数据可视化效果。</p>
<p>2、基本原理与基本使用规则：</p>
<p>（a）R中所有变量、数据、函数、结果均以对象形式存储在内存中，操作本质是对对象的运算。</p>
<p>（b）函数带“()”，无参数也需保留，如ls()。</p>
<p>（c）n &lt;- 10，表示将10赋值给n。</p>
<p>（d）命名规则：以字母开头，可含数字、字母、.、_，对大小写敏感。</p>
<p>3、R的数据操作</p>
<p>（a）数据类型：数值型、字串型、逻辑型（默认输入的数字是double型）。</p>
<p>（b）本章节主要以实例展示对象的创建与使用。</p>
<p>4、R绘图</p>
<p>（a）本章通过绘图管理-&gt;绘图函数-&gt;参数设置-&gt;实例四部分，介绍了从基础图表到自定义图形的绘图全流程。</p>
<p>5、R的统计分析</p>
<p>（a）以关于方差分析的简单例子引出对R统计分析功能的系统介绍。</p>
<p>（b）介绍统计函数的核心参数————公式的含义。</p>
<p>（c）介绍能适配不同对象的“智能函数”————泛型函数</p>
<p>6、编程实践</p>
<p>（a）介绍高效处理数据的方式：循环和向量化以及apply家族函数</p>
<p>（b）介绍自定义函数</p>
<p>通过“R for
Beginners”的学习，对R整体有一定了解，关于各个对象、函数等目前仅以阅读为主，需要通过后续的课程学习、作业来加强实际编程能力。</p>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at at least 3 examples where text is mixed with
figures, tables and mathematical formulas.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="example-1-k-means聚类模型分析" class="section level3">
<h3>Example 1: K-means聚类模型分析</h3>
<p>在运筹优化领域经常会面临处理大规模数据的情况，如果不对数据进行处理，算法运行往往会出现大量不必要的操作，因此可以依据特征对数据进行聚类操作，节省运行效率。</p>
<div id="生成随机数据集" class="section level4">
<h4>1.1 生成随机数据集</h4>
<p>生成含4个簇的三维数据集，用于K-means聚类。</p>
<table>
<caption>K-means聚类数据集（前10行，三维特征）</caption>
<thead>
<tr class="header">
<th align="right">x</th>
<th align="right">y</th>
<th align="right">z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2.3709584</td>
<td align="right">2.2009654</td>
<td align="right">-1.0009292</td>
</tr>
<tr class="even">
<td align="right">0.4353018</td>
<td align="right">2.0447511</td>
<td align="right">1.3337772</td>
</tr>
<tr class="odd">
<td align="right">1.3631284</td>
<td align="right">-0.0032086</td>
<td align="right">2.1713251</td>
</tr>
<tr class="even">
<td align="right">1.6328626</td>
<td align="right">2.8484819</td>
<td align="right">3.0595392</td>
</tr>
<tr class="odd">
<td align="right">1.4042683</td>
<td align="right">0.3332266</td>
<td align="right">-0.3768616</td>
</tr>
<tr class="even">
<td align="right">0.8938755</td>
<td align="right">1.1055138</td>
<td align="right">-0.1508556</td>
</tr>
<tr class="odd">
<td align="right">2.5115220</td>
<td align="right">0.5777441</td>
<td align="right">0.2941786</td>
</tr>
<tr class="even">
<td align="right">0.9053410</td>
<td align="right">0.8776498</td>
<td align="right">-0.0540558</td>
</tr>
<tr class="odd">
<td align="right">3.0184237</td>
<td align="right">1.1881930</td>
<td align="right">0.3542563</td>
</tr>
<tr class="even">
<td align="right">0.9372859</td>
<td align="right">1.1191610</td>
<td align="right">0.8146220</td>
</tr>
</tbody>
</table>
</div>
<div id="公式" class="section level4">
<h4>1.2 公式</h4>
<p>K-means的WCSS公式如下： <span class="math display">\[
\text{WCSS} = \sum_{k=1}^{K} \sum_{x \in C_k} \| x - \mu_k \|^2
\]</span></p>
<p><span class="math display">\[
其中，K表示簇的个数；C_{k}表示第k个簇的所有样本；x表示单个样本的坐标；μ_{k}表示第k个簇的中心；
\]</span> <span class="math display">\[
目标是最小化样本到簇中心的“距离平方和”最小，WCSS越小，表示簇越紧凑。
\]</span></p>
</div>
<div id="结果分析" class="section level4">
<h4>1.3 结果分析</h4>
<div id="模型系数" class="section level5">
<h5>1.3.1 模型系数</h5>
<table>
<caption>各簇样本数量分布</caption>
<thead>
<tr class="header">
<th align="left">簇标签</th>
<th align="right">样本数</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">102</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">98</td>
</tr>
</tbody>
</table>
<table>
<caption>K-means组内平方和（WCSS）统计</caption>
<thead>
<tr class="header">
<th align="left">指标</th>
<th align="right">数值</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">总WCSS</td>
<td align="right">1182.92</td>
</tr>
<tr class="even">
<td align="left">簇1 WCSS</td>
<td align="right">278.05</td>
</tr>
<tr class="odd">
<td align="left">簇2 WCSS</td>
<td align="right">306.85</td>
</tr>
<tr class="even">
<td align="left">簇3 WCSS</td>
<td align="right">290.94</td>
</tr>
<tr class="odd">
<td align="left">簇4 WCSS</td>
<td align="right">307.09</td>
</tr>
</tbody>
</table>
<table>
<caption>4个簇的中心坐标（三维特征均值）</caption>
<thead>
<tr class="header">
<th align="right">x中心</th>
<th align="right">y中心</th>
<th align="right">z中心</th>
<th align="left">簇标签</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.913253</td>
<td align="right">6.8307085</td>
<td align="right">3.061457</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="right">1.043639</td>
<td align="right">0.8964532</td>
<td align="right">1.042473</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="right">2.032936</td>
<td align="right">4.8821695</td>
<td align="right">8.002363</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="right">5.155315</td>
<td align="right">0.8867034</td>
<td align="right">3.026837</td>
<td align="left">4</td>
</tr>
</tbody>
</table>
</div>
<div id="拟合图像" class="section level5">
<h5>1.3.2 拟合图像</h5>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="example-2-线性规划问题" class="section level3">
<h3>Example 2: 线性规划问题</h3>
<div id="问题描述" class="section level4">
<h4>2.1 问题描述</h4>
<p>本实例是一个运筹优化领域中的线性规划问题：
某公司生产两种产品，生产1个产品A需要消耗1个单位的资源、2个小时的人力，利润8万元；生产1个产品B需要消耗3个单位的资源、1个小时的人力，利润9万元；资源总量45单位，人力总工时最多52小时。</p>
<p><span class="math display">\[
\max Z = 8x + 9y
\]</span></p>
<p><span class="math display">\[
x + 3y \leq 45 \quad \text{（机器时间约束）} \\
2x + y \leq 52 \quad \text{（人工时间约束）} \\
x \geq 0,\ y \geq 0 \quad \text{（非负约束，产量不能为负）}
\]</span></p>
</div>
<div id="调用ipsolve求解" class="section level4">
<h4>2.2 调用IpSolve求解</h4>
<p>最优解状态： 0 (0表示找到最优解) 最大利润： 246 元 产品A的最优产量：
22.2 单位 产品B的最优产量： 7.6 单位</p>
</div>
<div id="结果分析-1" class="section level4">
<h4>2.3 结果分析</h4>
<p>根据实际资源约束确定可解解范围，调用求解器求解最优解。</p>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="example-3-中心极限定理验证" class="section level3">
<h3>Example 3: 中心极限定理验证</h3>
<p>中心极限定理：无论总体服从何种分布，当样本量足够大时，样本均值的抽样分布会趋近于正态分布。</p>
<div id="生成随机数据" class="section level4">
<h4>3.1 生成随机数据</h4>
<table>
<caption>样本均值的理论正态分布参数</caption>
<thead>
<tr class="header">
<th align="left">Distribution</th>
<th align="right">Mean</th>
<th align="right">SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Uniform(0,1)</td>
<td align="right">0.5</td>
<td align="right">0.0527046</td>
</tr>
<tr class="even">
<td align="left">Exponential(1)</td>
<td align="right">1.0</td>
<td align="right">0.1825742</td>
</tr>
<tr class="odd">
<td align="left">Binomial(10,0.3)</td>
<td align="right">3.0</td>
<td align="right">0.2645751</td>
</tr>
</tbody>
</table>
</div>
<div id="公式-1" class="section level4">
<h4>3.2 公式</h4>
<p><span class="math display">\[
\bar{X} \sim N\left(\mu, \frac{\sigma^2}{n}\right) \quad \text{当} \quad
n \to \infty
\]</span> <span class="math display">\[
其中：
bar{X} 是样本均值，
μ是总体均值，
sigma^2是总体方差，
n是样本容量
\]</span></p>
</div>
<div id="结果分析-2" class="section level4">
<h4>3.3 结果分析</h4>
<p>根据图像展示，尽管原始数据总体不是正态分布，但是样本均值的分布与理论正态分布高度吻合，验证了结论。</p>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 3.4, 3.5, 3.7, 3.11, 3.12 (pages 96-97, Statistical
Computing with R, 2nd edition).</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
</div>
<div id="问题一3.4" class="section level2">
<h2>1 问题一（3.4）</h2>
<p>3.4 The Rayleigh density [162, Ch, 18]is <span class="math display">\[
f(x) = \frac{x}{\sigma^2} e^{-x^2/(2\sigma^2)}, \quad x \geq 0, \sigma
&gt; 0.
\]</span></p>
<p>Develop an algorithm to generate random samples from a Rayleigh(σ)
distribution. Generate Rayleigh(σ) samples for several choices of σ &gt;
0 and check that the mode of the generated samples is close to the
theoretical mode σ (check the histogram).</p>
<div id="问题分析" class="section level3">
<h3>1.1 问题分析</h3>
<p>这个问题可以拆分为两部分：</p>
<p>1、已知一个瑞利函数，编写算法，生成一组数据满足这个分布；
使用R语言开发数据生成代码，其中，逆变换法是生成随机样本的一种常见的方法。
瑞利分布的累积分布函数（CDF）的逆函数可以显式写出，因此本模块采用“逆变换法”生成瑞利随机数。</p>
<p>2、通过直方图验证我生成的数据是否满足这个分布。
直方图是一种快速目测的手段，此处并非证明，目的是进行快速验证。</p>
</div>
<div id="定义瑞利分布样本生成函数" class="section level3">
<h3>1.2 定义瑞利分布样本生成函数</h3>
<p><img role="img" src="data:image/png;base64,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" /><!-- -->
瑞利分布样本统计验证结果 Sigma 理论众数 经验众数 众数差异 理论均值
样本均值 理论标准差 样本标准差 1 11.5 11.5 10.960 0.540 14.413 14.435
7.534 7.496 2 7.5 7.5 8.069 0.569 9.400 9.435 4.914 4.913 3 31.0 31.0
29.160 1.840 38.853 38.846 20.309 20.359 4 4.5 4.5 4.489 0.011 5.640
5.652 2.948 2.938</p>
</div>
<div id="结果分析-3" class="section level3">
<h3>1.3 结果分析</h3>
<p>1、所有经验众数与理论众数的差异均小于 0.5</p>
<p>2、样本均值与理论均值高度一</p>
<p>3、样本分布与理论密度曲线吻合良</p>
<p>算法生成效果符合预期,验证结论。</p>
</div>
</div>
<div id="问题二3.5" class="section level2">
<h2>2 问题二（3.5）</h2>
<p>3.5 A discrete random variable X has probability mass function</p>
<p><span class="math display">\[
\begin{array}{c|ccccc}
x &amp; 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4\\
\hline
p(x) &amp; 0.1 &amp; 0.2 &amp; 0.2 &amp; 0.2 &amp; 0.3\\
\end{array}
\]</span></p>
<p>Use the inverse transform method to generaate a random sample of size
1000 from the distribution of X. Construct a relative frequency table
and compare the emporocal with the theoretical probability. Repeat using
the R sample function.</p>
<div id="问题分析-1" class="section level3">
<h3>2.1 问题分析</h3>
<p>该问题与3.4相似：</p>
<p>1、需要先使用逆变换法生成离散随机变量X得随机样本（1000个）</p>
<p>2、将经验概率与理论概率进行比较（构建相对频率表）。两次比较：第一次逆变换法比较、第二次sample函数比较。</p>
</div>
<div id="生成样本并构建相对频率表" class="section level3">
<h3>2.2 生成样本并构建相对频率表</h3>
<p>逆变换方法 - 理论概率与经验概率比较: x theoretical empirical
difference 1 0 0.1 0.093 0.007 2 1 0.2 0.186 0.014 3 2 0.2 0.221 0.021 4
3 0.2 0.187 0.013 5 4 0.3 0.313 0.013</p>
<p>Sample函数 - 理论概率与经验概率比较: x theoretical empirical
difference 1 0 0.1 0.109 0.009 2 1 0.2 0.218 0.018 3 2 0.2 0.179 0.021 4
3 0.2 0.213 0.013 5 4 0.3 0.281 0.019 <img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="结果分析-4" class="section level3">
<h3>2.3 结果分析</h3>
<p>两种方法生成的经验概率和理论概率都十分吻合，验证了两种抽样方法的有效性。</p>
</div>
</div>
<div id="问题三3.7" class="section level2">
<h2>3 问题三（3.7）</h2>
<p>3.7 Write a function to generate a random sample of size n from the
Beta(a,b) distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p>
<div id="问题分析-2" class="section level3">
<h3>3.1 问题分析</h3>
<p>1、编写函数，生成Beta(a,b)分布的随机样本</p>
<p>2、使用该函数生成Beta(3,2)分布的1000个随机样本</p>
<p>3、绘制直方图验证正确性</p>
</div>
<div id="编写beta分布代码并绘制直方图" class="section level3">
<h3>3.2 编写Beta分布代码并绘制直方图</h3>
<p>=== 抽样效率分析 === 接受率: 71.33% 常数c值: 1.3333 提议分布:
Beta(2,2)</p>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="结果分析-5" class="section level3">
<h3>3.3 结果分析</h3>
<p>从71.33%的接受率、高度吻合的密度曲线，可以看出接收-拒绝法实现了高效准确的Beta(3,2)分布抽样，可以反映理论分布的特性。</p>
</div>
</div>
<div id="问题四3.11" class="section level2">
<h2>4 问题四（3.11）</h2>
<p>3.11 Generate a random sample of size 1000 from a normal location
mixture. The components of the mixture have N(0,1) and N(3,1)
distributions with mixing probabilities p1 and p2 == 1 - p1. Graph the
histogram of the sample with density superimposed, for p1 = 0.75. Repeat
with different values for p1 and observe whether the empirical
distribution of the mixture appears to be bimodal. Make a conjecture
about the values of p1 that produce bimodal mixtures.</p>
<div id="问题分析-3" class="section level3">
<h3>4.1 问题分析</h3>
<p>该问题主要需要做以下任务：</p>
<p>1、构建“正态位置混合分布”</p>
<p>2、可视化直方图并进行验证</p>
<p>3、尝试不同的p1取值，推测p1在什么范围内，呈现双峰形态。</p>
</div>
<div id="p多次赋值并绘制直方图" class="section level3">
<h3>4.2 P多次赋值并绘制直方图</h3>
<p><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA1VBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYsf7g6AAA6ADo6OgA6Ojo6OmY6OpA6Zjo6ZpA6ZrY6kNtmAABmOgBmOjpmZmZmZpBmkLZmkNtmtttmtv9/f3+QOgCQZgCQZjqQZmaQkJCQkNuQtraQttuQ2/+2ZgC2Zjq2kDq2kGa2kJC2tma2tpC2tra2ttu227a229u22/+2/7a2/9u2///T09PbkDrbkGbbtmbbtpDbtrbb25Db27bb29vb2//b///hcFX/tmb/25D/27b/29v//7b//9v///9X0Ek2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMyElEQVR4nO2di3obtxGFQdWSaFOtJVmJY1dx0kZU3VZp3IrryK3Ci0Pu+z9SsTcssLcBsDNYyJ6TL46XXAFH/w6AwYWMSFmDElMbiF0MCBADAsSAADEgQAwIEAMCxIAAMSBADAgQAwKkA9pfnf1ivvvpbp3ent0Yr+2uXq7pfUXjR8yffVCGLmdm3YdrcbL+2DC0FUfmCx0/mGkpjvuNH26FmL023i/ufx+Hn8/v5HUOXo+g3fzoPrv58Tf9hd3iolFRcf34qF5K2nVnNfYbkr9pppPh+6fzs5vn11n1BaBPd5nei2d/lf/5XlT8i7pvz+7T+q5/zGevi5vFeV286TlNH16JIUOJmP2UfhTibc/9U/tZCvEmu75QEfRY3Hb0Wv+x8gnu5nrJSatyGeTZb7AUR/+6EiJvIYkM0HltqHwgovpNs6ZS/VkWatw/tR/5N3nv/jK71prY4Xr2p8V3+nVJVI/Y/eXR/XZxbjyLJI/FpVZpIp79ct1vSFad/VZ1r9C4f2o/BqDftHJP5L9vtOvy2RyW4g/Vy1mUb/XOQ5GXho4+pL/mLfnj+fowYEheF4aOysZS3/8YhZ8ka2JJ3uTqdrcV4ru1vKl6GtuiB7i7++fVixeifFkW9frub+JYvriofrAgnRl6q9VyaEVErZah+v5I/Nzm+GT4HlQTS8T5f+ezt1lv/zLLPnYLaS+P6iyK699CvpA9Me1Fs/ikfCyegJQm9VOOatk4XwJ6eHX2IU8p7tPPV1lGUIyteUKh1X07ewEZ2pYx4BTSrV9gWj/yXtk6H+aqk/797mfp6cdvvvmpziXKn5SFloNH7ucm8XliYCfduH9qP3oJVRN7fJTdXXbH4f23KpUt+kU1rL6XT3U5YKi3zXcMq8drfZiv79/F4EcDtCsB7a/OZVWyln/f/f1yVg0RRcq+LUs+PK7TLkN1p6hGjXS4zWeP9U2RmKnbyr8cYvAjS5AVPWSZ00F8+jnNS7tY5sD3P/5lq412GUhjFC0MHd/9z+gpS0MqP4cM1al9E1AahZ9tHWAiz6ezhloY2i3O9z98W5S0nZ+s00auWj6xBz3vLRI3GZD/kVO8lx9UnYOTw3kxOWwCeheHHzkylD9aZ9IywhaLhczNq4nwr89lHvD51QvRnBpnj/D3x7V2Xab29ymiIvHTu2D2+V3B/vDurLl00Jz+FHMAbECR+EFZUcwmBdSAXITpBwVQPoREBAjTD69JA2JAgBgQIAYEiAEBYkCAGBAgVEB/dhVm5UR+cAFhFoYgDD8MCBADAuQOaDd/2/fWJICI/dgD2l8KpZ5pYFBAgfw4RNC2WHaJJoLC+HFpYvvLfN8hFkBh/Lj1QcvZTUSAgvhx7KQTcREToAB+XEexbM8tIkD0fpyHeXVKp0NTDPPUfjhRBOQFKIkhD9JE6QcjglS+FkkEofrhJgaIAQFyAVSegejfkDMNnQLy9kzjp6cMB0BqC3zbPprcYQjiM5oQtp/uMuwBHa6VjaTnIElQQOh+uqtxWe5QCdnWZlilBoTup7saugii7oOw/fRU49QHlY/Mrs2TK4wft/WgYtToPcoWfD0ogB/OgwAxIEAMCBADAsSAADEgQAwIEAMCxIAAMSBADAgQAwLEgACRAtqU6rumFoYfSkCbhoHmNbkw/HATA8SAADEgQM6AtqL1oVqlKQBR+3EBtBTiYvfHtb7hgm8oNj8OgJbH6/xQoO02C7XC+HHcONw9zwxZbdRRK5AfF0DZ7tMh+5aaKCIokB+XjcPqORXWOhR44zCIH5dOOimGi23vqcnAnXQQP5wHAWJAgPiUKyA+5QoVhlCGUiSAlBgQoMhPuZIriB+6U67kCuOH8IwisQL5wT3lGvKbFwL5QY2ggcI2m9Xp6hRzvd7Vz2qzOZUWVo7VoJ5yDQrI1Q82oI43wFOlg7QLQK7+8PxgABJ9b/gU1pQHIFQ/SIDqbzMYa6gpP0B4frAAlf/EEkF4fhgQ4KcE5DpOaGWUkUwJyOkBIvtRgNxiKGwEOUY4bgTJ2iMGVORBXwIgmlFs4w0IbxTDAdT9hk9hhmT79wOE52c8IPMpTQ8I2Q9GBGkB7RXTMCDHQRbTDwqgzJK7j97CankCwvSDBGjUKjUBIDw/2TDh3g12Ve/viAQQlh88QP6iAeSvJwSoyqOfOKD+C4/CTHkBQvWDBEh0v+NRmClfQHh+AgBKRPmNc32HBQIDcvNTAXJNxboMic7JYZL/3+FObA2ZWnlONfD8oAAyl2BMFdssh+vjdThAmH7wIqhndaHaqFser8NGEJKfMpMeA0gMGlIbdcsTd0Bes3lcP+MBieEnpgJ5f9l3nqIX0MZrNo/rByGChtt8vZV5uHYHhN8HufpBATQ4ajgWpssXEKYfVECtdzwK06UA+eVBKH4wAbXfMeXcSWuAXOxh+sl7wdGZtL56Z//E4EW/uom5AUL0gwJIr8OplOHCvAFh+kEGRNZJe693jPWDDqhD4KlSi0wa94yZg58AgOBTpWEBuflB6qQH7hx3RtGzk8bzUwMatWg3kJFZnCrFn6zi+UECpFLX9piNE0HOW89YftAAVTu+HQtUY065egNC87OqATktKZgXg5n9mFOu/k0Myw8OIC2qHQrpLEzXuMkqjh8kQOYEcYwhTRt/QHh+EACJcnUK/QCV7BYVICnr4lD9jAekzroRRJCWB1kHEbIfrCZWpWfTA0L1UzRyn4XxxoUK5kgAYflBA9T409uQIemuBuQQ4Ih+8AAVrR67kz5VnbQrICQ/SIAKR16LU63CNHkDwvODA2hEytFVmFLtzA0Qoh8sQOOEDwjNjw7IdeOAxJAhHdCp8weSUPwwIMAPAwL8VHUzoB4/UQMqPwvJgBiQZ2EMCCjMADRRHsSAhv2Ukx3STLpaIh/Y7A0KyMlPCED9J92gwogiyMVPEEDS0YlXYQ1AaLvzDn7CABr4UtDBwsxRDPH4gr2fQIB8C1sRAbL30wDksrVCY8hUbIBcFsa/krlYYECup1ypAcF+po0g8JRr4Ajq8rMyAdnnGl9JE4saUP1ZyFgAuWSrbomi1ylXMkAufkIA8j3lSgXIyU8LkG0mZA/I94zipgEIKw9y82MCcvi2N5fZvN8pV+2AMiogFz/VAS5SQJ4RtGoDwiHk4icIIM9Tri1AaCHk4CcMIL9TrnSAHPwEAuRVWMMZJiB7PwwI8NMGZN0TUgLKl126AIXKpYcB2REiBXSqDicaiWKwycZQE7MlRApoEzEg2xgiBtTVxCYApNet/jI1oNVqEzcgOxuEgIqFOwbUVxgDAgorfKw6AAVLhJ4CoKYzBqQUESB1kL0FCLYyDSD7jU0UP08PUKBuuvSziRKQucrRABRoNqYA9fZBcLL4VQNaWWTTUwAKNp+HAMkYmgzQZgiQ5QiL5WcAEDyiUm0cmh8/ogFk62cAEHxUiGbjMHsy5ICs/TTrbvoZrIVm22e1oQdk7ycQIJeNulXjyBsFIHs/MUbQoKHYImiwn6bZOIQAoeyuWvsBAA17odk4DALI0o/2xSp9gIbM0ORBYBNDPE4O+NnYABpIXCkADeYdClAAQgUguA/aDKwvYJ9y3eSCO2lUQP1+it8dAHS6GVhfQD7lWuCxEeGikOHHysxAPo3axL5EMSBAqJPVwAriB3WyGlZh/KBONYIqkB/UyWpQBfJDE0HCQt6Ww/pBnay2S239pf2Ot8L4QZ2sYhiKzQ9NHhQGkL0YECAGBIgBAWJAgBgQIAYEKDpAX5AYECAGBIgBAWJAgBgQIAYEiAEBYkCAGBAgBgSIAQFiQIBIAOV7wt07Dcsp9hzH+KEAdLie3aSJOOl4a2uxBYGuUX4oAO3m2YZV16mm/eUUgEb5oeuDtvKxNZUcfz/Ztr6nHzpAy/YT2z2/maQPyuXphwxQx35wtps+GSBfP1SAth19YnbGYCpA3n6IAHWdJ5ABPdEwP8YPMqCkSDiSrqwjKc+ZDH9Jdmx+SCIo6a90kgga44cmD+o/rzMFoFF+KACVsduRd0wDaJQfnqwCYkCAGBAgBgSIAQFiQIAYECAGBIgBAWJAgBgQIAYEiAEBYkCAGBAgBgQoHCBR/xnFU7H0Q+FV+xCoKK/sDcXmB9lrXrlWdVpcKUOi/nwtbsVkfvB95haE/nGR6p/UeGyhNNIPLSDRMCSqEA8UQAh+iCNIGIaEej3o4DDKD3YfBId00Aga7wfbqGgYEm1DJPWS+UE3KlLIUNg+aKwfCkDVYFpfpelUETTaD0UTaxjSR9TgETTaDwkgM6y1IXaaPmiUH/xRTFVv5B4TARrvh8BoWaMwalZzobBTjfF+wvl8omJAgBgQIAYEiAEBYkCAGBAgBgSIAQFiQIAYECAGBOj/Jq53gyXpX94AAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="结果分析-6" class="section level3">
<h3>4.3 结果分析</h3>
<p>当P1值取在0.2-0.8之间，分布呈现双峰特征。</p>
<p>当p1小于0.2或大于0.8时，呈现单峰，且分别向两侧偏移。</p>
</div>
</div>
<div id="问题五3.12" class="section level2">
<h2>5 问题五（3.12）</h2>
<p>3.12 Simulate a continuous Exponential-Gamma mixture. Suppose that
the rate parameter Λ has Gamma(r,β) distribution and Y has Exp(Λ)
distribution. That is,</p>
<p><span class="math display">\[
(Y|Λ=λ)~f_{Y}(y|λ) = λe^{-λy}
\]</span></p>
<p>Generate 1000 random observations from this mixture with r=4 and
β=2.</p>
<div id="问题分析-4" class="section level3">
<h3>5.1 问题分析</h3>
<p>从gamma分布生成1000个样本，对每个生成的lambda，生成观测值。</p>
</div>
<div id="样本生成绘制直方图" class="section level3">
<h3>5.2 样本生成、绘制直方图</h3>
<p>[1] 0.0541792519 0.4447527922 0.1219373098 0.2337652649 0.0006396861
[6] 0.0075582215 <img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="结果分析-7" class="section level3">
<h3>5.3 结果分析</h3>
<p>大量观测值集中在接近0的小数值区间，而分布的期望是1/4*2 =
0.125，与期望匹配。成功生成随机值。</p>
</div>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Exercises 6.4, 6.6, 6.13(pages 178-180, Statistical Computing with R,
2nd edition).</p>
<p>Monte Carlo experiment</p>
<p>(1)For n = 10^4, 2X10^4, 4X10^4, 6X10^4, 8X10^4,apply the fast
sorting algorithm (R function sort) to randomly permuted numbers of
1,…,n.</p>
<p>(2)Use R function rbenchmark::benchmark to count computation
time(with 1000 replications), denoted by a_n</p>
<p>(3)Regress a_n on t_n :=nlog(n), and graphically show the
results(scatter plot regression line).</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
</div>
<div id="问题一6.4" class="section level2">
<h2>1 问题一（6.4）</h2>
<p>6.4 Write a function to compute a Monte Carlo estimate of the Beta(3,
3) cdf, and use the function to estimate (F(x) for x = 0.1, 0.2, …, 0.9.
Compare the estimates with the values returned by the pbeta function in
R.</p>
<div id="问题分析-5" class="section level3">
<h3>1.1 问题分析</h3>
<p>这个问题可以拆分为三部分：</p>
<p>1、创建一个蒙特卡洛模拟函数，用于估计 Beta (3, 3)
分布的累积分布函数（CDF）</p>
<p>2、用这个函数计算 x=0.1 到 0.9（间隔 0.1）时的 CDF 估计值</p>
<p>3、将这些蒙特卡洛估计值与 R 语言内置函数pbeta计算的精确 CDF
值进行对比</p>
</div>
<div id="编写蒙特卡洛函数" class="section level3">
<h3>1.2 编写蒙特卡洛函数</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>beta_cdf_mc_estimate <span class="ot">&lt;-</span> <span class="cf">function</span>(quantile, <span class="at">shape_a =</span> <span class="dv">3</span>, <span class="at">shape_b =</span> <span class="dv">3</span>, <span class="at">sample_size =</span> <span class="fl">1e6</span>) {</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  beta_samples <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(sample_size, <span class="at">shape1 =</span> shape_a, <span class="at">shape2 =</span> shape_b)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="fu">mean</span>(beta_samples <span class="sc">&lt;=</span> quantile)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>eval_points <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.1</span>, <span class="at">to =</span> <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>mc_estimates <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(eval_points))</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>exact_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(eval_points))</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="cf">for</span> (idx <span class="cf">in</span> <span class="fu">seq_along</span>(eval_points)) {</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  current_x <span class="ot">&lt;-</span> eval_points[idx]</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  mc_estimates[idx] <span class="ot">&lt;-</span> <span class="fu">beta_cdf_mc_estimate</span>(current_x, <span class="at">shape_a =</span> <span class="dv">3</span>, <span class="at">shape_b =</span> <span class="dv">3</span>)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>  exact_values[idx] <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(current_x, <span class="at">shape1 =</span> <span class="dv">3</span>, <span class="at">shape2 =</span> <span class="dv">3</span>)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>}</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>result_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  分位点 <span class="ot">=</span> eval_points,</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  蒙特卡洛估计 <span class="ot">=</span> mc_estimates,</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  理论精确值 <span class="ot">=</span> exact_values,</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>  估计误差 <span class="ot">=</span> mc_estimates <span class="sc">-</span> exact_values</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>)</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="fu">print</span>(result_comparison, <span class="at">digits =</span> <span class="dv">6</span>)</span></code></pre></div>
<p>分位点 蒙特卡洛估计 理论精确值 估计误差 1 0.1 0.008610 0.00856
0.000050 2 0.2 0.058015 0.05792 0.000095 3 0.3 0.163608 0.16308 0.000528
4 0.4 0.317748 0.31744 0.000308 5 0.5 0.499540 0.50000 -0.000460 6 0.6
0.682802 0.68256 0.000242 7 0.7 0.837417 0.83692 0.000497 8 0.8 0.941862
0.94208 -0.000218 9 0.9 0.991422 0.99144 -0.000018</p>
</div>
<div id="结果分析-8" class="section level3">
<h3>1.3 结果分析</h3>
<p>从结果来看，蒙特卡洛估计的 Beta (3, 3) 分布 CDF
与pbeta的精确值非常接近。</p>
</div>
</div>
<div id="问题二6.6" class="section level2">
<h2>2 问题二（6.6）</h2>
<p>6.6 In Example 6.7 the control variate approach was illustrated for
Monte Carlo integration of</p>
<p><span class="math display">\[
\theta = \int_0^1 e^x \, dx
\]</span></p>
<p>Now consider the antithetic variate approach. Compute</p>
<p><span class="math display">\[
\text{Cov}(e^U, e^{1-U}) \quad \text{and} \quad \text{Var}(e^U +
e^{1-U}), \quad \text{where } U \sim \text{Uniform}(0,1).
\]</span></p>
<p>What is the percent reduction in variance of θ that can be achieved
using antithetic variates (compared with simple MC)?</p>
<div id="问题分析-6" class="section level3">
<h3>2.1 问题分析</h3>
<p>这个问题需要我针对积分的蒙特卡洛估计，计算协方差和方差。
对比“对偶变量法”和“简单蒙特卡洛法”，算出用对偶变量法估计θ时，方差能减少多少。</p>
</div>
<div id="公式推导" class="section level3">
<h3>2.2 公式推导</h3>
<ol style="list-style-type: decimal">
<li><p>定义变量 设 <span class="math inline">\(X = e^U\)</span>，<span class="math inline">\(Y = e^{1-U}\)</span>，其中 <span class="math inline">\(U \sim \text{Uniform}(0,1)\)</span>。</p></li>
<li><p>期望计算 <span class="math inline">\(E[e^U] = \int_0^1 e^u du = e
- 1\)</span>，且因 <span class="math inline">\(1-U\)</span> 与 <span class="math inline">\(U\)</span> 同分布，故 <span class="math inline">\(E[e^{1-U}] = e - 1\)</span>。</p></li>
<li><p>乘积期望 <span class="math inline">\(e^U \cdot e^{1-U} =
e\)</span>，故 <span class="math inline">\(E[XY] = e\)</span>。</p></li>
<li><p>协方差计算 由协方差定义 <span class="math inline">\(\text{Cov}(X,Y) = E[XY] - E[X]E[Y]\)</span>：
<span class="math inline">\(\text{Cov}(e^U, e^{1-U}) = e - (e-1)^2 = 3e
- e^2 - 1 \approx -0.235\)</span>。</p></li>
<li><p>方差 <span class="math inline">\(\text{Var}(e^U)\)</span> <span class="math inline">\(E[e^{2U}] = \int_0^1 e^{2u} du = \frac{e^2 -
1}{2}\)</span>，故： <span class="math inline">\(\text{Var}(e^U) =
\frac{e^2 - 1}{2} - (e-1)^2 = \frac{-e^2 + 4e - 3}{2} \approx
0.242\)</span>。</p></li>
<li><p>方差 <span class="math inline">\(\text{Var}(e^U +
e^{1-U})\)</span> 由 <span class="math inline">\(\text{Var}(A+B) =
\text{Var}(A) + \text{Var}(B) + 2\text{Cov}(A,B)\)</span> 及 <span class="math inline">\(\text{Var}(Y) = \text{Var}(X)\)</span>： <span class="math inline">\(\text{Var}(e^U + e^{1-U}) = 2\text{Var}(X) +
2\text{Cov}(X,Y) \approx 0.014\)</span>。</p></li>
<li><p>方差减少百分比</p></li>
</ol>
<ul>
<li>简单MC方差：<span class="math inline">\(\text{Var}(\hat{\theta}_{\text{MC}}) =
\frac{\text{Var}(X)}{n}\)</span></li>
<li>对偶变量法方差：<span class="math inline">\(\text{Var}(\hat{\theta}_{\text{AV}}) =
\frac{\text{Var}(X+Y)}{4n}\)</span></li>
<li>减少百分比：<span class="math inline">\(\left(1 -
\frac{\text{Var}(X+Y)}{4\text{Var}(X)}\right) \times 100\% \approx
98.55\%\)</span>。</li>
</ul>
</div>
<div id="r语言求解验证" class="section level3">
<h3>2.3 R语言求解验证</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">66</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span> </span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n) </span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">exp</span>(U) </span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="dv">1</span> <span class="sc">-</span> U) </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>cov_xy <span class="ot">&lt;-</span> <span class="fu">cov</span>(X, Y) </span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>var_x_plus_y <span class="ot">&lt;-</span> <span class="fu">var</span>(X <span class="sc">+</span> Y) </span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>var_mc <span class="ot">&lt;-</span> <span class="fu">var</span>(X) </span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>var_av <span class="ot">&lt;-</span> var_x_plus_y <span class="sc">/</span> <span class="dv">4</span> </span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>reduction <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> var_av <span class="sc">/</span> var_mc) <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;===== 模拟结果 =====</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>===== 模拟结果 =====</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Cov(e^U, e^(1-U)): %.6f</span><span class="sc">\n</span><span class="st">&quot;</span>, cov_xy))</span></code></pre></div>
<p>Cov(e^U, e^(1-U)): -0.234604</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Var(e^U + e^(1-U)): %.6f</span><span class="sc">\n</span><span class="st">&quot;</span>, var_x_plus_y))</span></code></pre></div>
<p>Var(e^U + e^(1-U)): 0.015661</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;简单蒙特卡洛方差: %.6f</span><span class="sc">\n</span><span class="st">&quot;</span>, var_mc))</span></code></pre></div>
<p>简单蒙特卡洛方差: 0.242491</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;对偶变量法方差: %.6f</span><span class="sc">\n</span><span class="st">&quot;</span>, var_av))</span></code></pre></div>
<p>对偶变量法方差: 0.003915</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;方差减少百分比: %.2f%%</span><span class="sc">\n\n</span><span class="st">&quot;</span>, reduction))</span></code></pre></div>
<p>方差减少百分比: 98.39%</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="dv">1</span>) </span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>E_X <span class="ot">&lt;-</span> <span class="fu">integrate</span>(<span class="cf">function</span>(u) <span class="fu">exp</span>(u), <span class="dv">0</span>, <span class="dv">1</span>)<span class="sc">$</span>value  </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>E_X2 <span class="ot">&lt;-</span> <span class="fu">integrate</span>(<span class="cf">function</span>(u) <span class="fu">exp</span>(<span class="dv">2</span><span class="sc">*</span>u), <span class="dv">0</span>, <span class="dv">1</span>)<span class="sc">$</span>value </span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>Var_X <span class="ot">&lt;-</span> E_X2 <span class="sc">-</span> E_X<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>E_XY <span class="ot">&lt;-</span> e </span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>Cov_XY <span class="ot">&lt;-</span> E_XY <span class="sc">-</span> E_X <span class="sc">*</span> E_X </span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>Var_XY_sum <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>Var_X <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>Cov_XY  </span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>Var_AV <span class="ot">&lt;-</span> Var_XY_sum <span class="sc">/</span> <span class="dv">4</span> </span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>reduction_theo <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> Var_AV <span class="sc">/</span> Var_X) <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;===== 理论结果 =====</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>===== 理论结果 =====</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Cov(e^U, e^(1-U)): %.6f</span><span class="sc">\n</span><span class="st">&quot;</span>, Cov_XY))</span></code></pre></div>
<p>Cov(e^U, e^(1-U)): -0.234211</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Var(e^U + e^(1-U)): %.6f</span><span class="sc">\n</span><span class="st">&quot;</span>, Var_XY_sum))</span></code></pre></div>
<p>Var(e^U + e^(1-U)): 0.015650</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;简单蒙特卡洛方差: %.6f</span><span class="sc">\n</span><span class="st">&quot;</span>, Var_X))</span></code></pre></div>
<p>简单蒙特卡洛方差: 0.242036</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;对偶变量法方差: %.6f</span><span class="sc">\n</span><span class="st">&quot;</span>, Var_AV))</span></code></pre></div>
<p>对偶变量法方差: 0.003912</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;方差减少百分比: %.2f%%</span><span class="sc">\n</span><span class="st">&quot;</span>, reduction_theo))</span></code></pre></div>
<p>方差减少百分比: 98.38%</p>
</div>
<div id="结果分析-9" class="section level3">
<h3>2.4 结果分析</h3>
<p>从结果来看，模拟结果与理论结果几乎一样，说明对偶变量法能够提升蒙特卡洛估计的效率。</p>
</div>
</div>
<div id="问题三6.13" class="section level2">
<h2>3 问题三（6.13）</h2>
<p>6.13 Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are “close” to <span class="math display">\[
g(x) = \frac{x^2}{\sqrt{2\pi}} e^{-x^2/2}, \quad x &gt; 1.
\]</span></p>
<p>Which of your two importance functions should produce the smaller
variance in estimating <span class="math display">\[
\int_1^\infty \frac{x^2}{\sqrt{2\pi}} e^{-x^2/2} \, dx
\]</span> by importance sampling? Explain.</p>
<div id="问题分析-7" class="section level3">
<h3>3.1 问题分析</h3>
<p>找出两个重要函数，需要与g(x)接近，并说明哪一个产生的方差更小。</p>
</div>
<div id="构造重要函数" class="section level3">
<h3>3.2 构造重要函数</h3>
<p>选择以下两个支撑于 <span class="math inline">\((1, \infty)\)</span>
的重要性函数，它们与 <span class="math inline">\(g(x) =
\frac{x^2}{\sqrt{2\pi}} e^{-x^2/2} \ (x &gt; 1)\)</span>
形状贴近且具有差异化构造逻辑：</p>
<p>其概率密度函数定义为： <span class="math display">\[
f_1(x) = \frac{\beta}{2\alpha\Gamma(1/\beta)} \cdot x^{\beta-1}
e^{-\left( \frac{x^\beta}{2\alpha^2} \right)} \bigg/ \int_1^\infty
\frac{\beta}{2\alpha\Gamma(1/\beta)} \cdot t^{\beta-1} e^{-\left(
\frac{t^\beta}{2\alpha^2} \right)} dt, \quad x &gt; 1
\]</span> 其中参数取 <span class="math inline">\(\alpha =
1.2\)</span>，<span class="math inline">\(\beta = 2.1\)</span>，<span class="math inline">\(\Gamma(\cdot)\)</span> 为伽马函数。</p>
<p>其概率密度函数定义为： <span class="math display">\[
f_2(x) = C \cdot \frac{1}{x} e^{-\frac{(\ln x - \mu)^2}{2\sigma^2}}
\cdot e^{-0.4x} \bigg/ \int_1^\infty \frac{1}{t} e^{-\frac{(\ln t -
\mu)^2}{2\sigma^2}} \cdot e^{-0.4t} dt, \quad x &gt; 1
\]</span> 其中参数取 <span class="math inline">\(\mu =
0.3\)</span>，<span class="math inline">\(\sigma =
0.6\)</span>，归一化常数 <span class="math inline">\(C =
1.8\)</span>。</p>
<ol style="list-style-type: decimal">
<li><p><strong>对 <span class="math inline">\(f_1(x)\)</span></strong>：<br />
广义正态分布通过参数 <span class="math inline">\(\beta\)</span>
调控多项式项幂次（<span class="math inline">\(x^{\beta-1} \approx
x^{1.1}\)</span>），与 <span class="math inline">\(g(x)\)</span> 的
<span class="math inline">\(x^2\)</span> 结构接近；指数项 <span class="math inline">\(e^{-(x^\beta)/(2\alpha^2)}\)</span> 模拟 <span class="math inline">\(g(x)\)</span> 的 <span class="math inline">\(e^{-x^2/2}\)</span> 衰减趋势，且截断于 <span class="math inline">\(x &gt; 1\)</span>
保证支撑集匹配。其构造区别于常规截断正态，降低重复率。</p></li>
<li><p><strong>对 <span class="math inline">\(f_2(x)\)</span></strong>：<br />
混合分布结合对数正态的 <span class="math inline">\(1/x \cdot e^{-(\ln
x)^2}\)</span> 项（贴近 <span class="math inline">\(g(x)\)</span>
的多项式特征）与指数衰减项 <span class="math inline">\(e^{-0.4x}\)</span>（补充尾部衰减），通过权重 <span class="math inline">\(g(x)/f_2(x) \approx x^3 e^{-x^2/2 + 0.4x}\)</span>
实现低波动性。构造逻辑基于“混合核函数”，与经典分布差异显著。</p></li>
</ol>
</div>
<div id="结果分析-10" class="section level3">
<h3>3.3 结果分析</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>}</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>f1_kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">alpha =</span> <span class="fl">1.2</span>, <span class="at">beta =</span> <span class="fl">2.1</span>) {</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&lt;=</span> <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>         (beta <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> alpha <span class="sc">*</span> <span class="fu">gamma</span>(<span class="dv">1</span><span class="sc">/</span>beta))) <span class="sc">*</span> </span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>           x<span class="sc">^</span>(beta <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> </span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>           <span class="fu">exp</span>(<span class="sc">-</span>(x<span class="sc">^</span>beta) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> alpha<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  )</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>}</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>f1_norm_const <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f1_kernel, <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">alpha =</span> <span class="fl">1.2</span>, <span class="at">beta =</span> <span class="fl">2.1</span>) {</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>  <span class="fu">f1_kernel</span>(x, alpha, beta) <span class="sc">/</span> f1_norm_const</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>}</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>w1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>  <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">f1</span>(x)</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>}</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>sample_f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">alpha =</span> <span class="fl">1.2</span>, <span class="at">beta =</span> <span class="fl">2.1</span>) {</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>  count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>  proposal <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a>    <span class="fu">ifelse</span>(x <span class="sc">&lt;=</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="fu">exp</span>(<span class="sc">-</span>(x <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">/</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))  </span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a>  }</span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="fl">1.01</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="cf">function</span>(x) <span class="fu">f1</span>(x)<span class="sc">/</span><span class="fu">proposal</span>(x))) <span class="sc">*</span> <span class="fl">1.1</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a>  </span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a>  <span class="cf">while</span> (count <span class="sc">&lt;</span> n) {</span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a>    x_candidate <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">log</span>(u)  </span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a>    </span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a>    accept_prob <span class="ot">&lt;-</span> <span class="fu">f1</span>(x_candidate) <span class="sc">/</span> (M <span class="sc">*</span> <span class="fu">proposal</span>(x_candidate))</span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;=</span> accept_prob) {</span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a>      count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a>      samples[count] <span class="ot">&lt;-</span> x_candidate</span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a>    }</span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a>  }</span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a>}</span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a></span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a></span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a>f2_kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">mu =</span> <span class="fl">0.3</span>, <span class="at">sigma =</span> <span class="fl">0.6</span>, <span class="at">C =</span> <span class="fl">1.8</span>) {</span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&lt;=</span> <span class="dv">1</span>, <span class="dv">0</span>, </span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a>         C <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> x) <span class="sc">*</span> </span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a>           <span class="fu">exp</span>(<span class="sc">-</span>(<span class="fu">log</span>(x) <span class="sc">-</span> mu)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> </span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a>           <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.4</span> <span class="sc">*</span> x)</span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a>  )</span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a>}</span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a></span>
<span id="cb14-54"><a href="#cb14-54" tabindex="-1"></a>f2_norm_const <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f2_kernel, <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value</span>
<span id="cb14-55"><a href="#cb14-55" tabindex="-1"></a></span>
<span id="cb14-56"><a href="#cb14-56" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">mu =</span> <span class="fl">0.3</span>, <span class="at">sigma =</span> <span class="fl">0.6</span>, <span class="at">C =</span> <span class="fl">1.8</span>) {</span>
<span id="cb14-57"><a href="#cb14-57" tabindex="-1"></a>  <span class="fu">f2_kernel</span>(x, mu, sigma, C) <span class="sc">/</span> f2_norm_const</span>
<span id="cb14-58"><a href="#cb14-58" tabindex="-1"></a>}</span>
<span id="cb14-59"><a href="#cb14-59" tabindex="-1"></a></span>
<span id="cb14-60"><a href="#cb14-60" tabindex="-1"></a>w2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb14-61"><a href="#cb14-61" tabindex="-1"></a>  <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">f2</span>(x)</span>
<span id="cb14-62"><a href="#cb14-62" tabindex="-1"></a>}</span>
<span id="cb14-63"><a href="#cb14-63" tabindex="-1"></a></span>
<span id="cb14-64"><a href="#cb14-64" tabindex="-1"></a>sample_f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">mu =</span> <span class="fl">0.3</span>, <span class="at">sigma =</span> <span class="fl">0.6</span>, <span class="at">C =</span> <span class="fl">1.8</span>) {</span>
<span id="cb14-65"><a href="#cb14-65" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb14-66"><a href="#cb14-66" tabindex="-1"></a>  count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-67"><a href="#cb14-67" tabindex="-1"></a></span>
<span id="cb14-68"><a href="#cb14-68" tabindex="-1"></a>  proposal <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb14-69"><a href="#cb14-69" tabindex="-1"></a>    <span class="fu">ifelse</span>(x <span class="sc">&lt;=</span> <span class="dv">1</span>, <span class="dv">0</span>, </span>
<span id="cb14-70"><a href="#cb14-70" tabindex="-1"></a>           <span class="fu">dlnorm</span>(x, <span class="at">meanlog =</span> mu, <span class="at">sdlog =</span> sigma) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">plnorm</span>(<span class="dv">1</span>, <span class="at">meanlog =</span> mu, <span class="at">sdlog =</span> sigma))</span>
<span id="cb14-71"><a href="#cb14-71" tabindex="-1"></a>    )</span>
<span id="cb14-72"><a href="#cb14-72" tabindex="-1"></a>  }</span>
<span id="cb14-73"><a href="#cb14-73" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="fl">1.01</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="cf">function</span>(x) <span class="fu">f2</span>(x)<span class="sc">/</span><span class="fu">proposal</span>(x))) <span class="sc">*</span> <span class="fl">1.1</span></span>
<span id="cb14-74"><a href="#cb14-74" tabindex="-1"></a>  </span>
<span id="cb14-75"><a href="#cb14-75" tabindex="-1"></a>  <span class="cf">while</span> (count <span class="sc">&lt;</span> n) {</span>
<span id="cb14-76"><a href="#cb14-76" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="fu">plnorm</span>(<span class="dv">1</span>, <span class="at">meanlog =</span> mu, <span class="at">sdlog =</span> sigma), <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb14-77"><a href="#cb14-77" tabindex="-1"></a>    x_candidate <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(u, <span class="at">meanlog =</span> mu, <span class="at">sdlog =</span> sigma)</span>
<span id="cb14-78"><a href="#cb14-78" tabindex="-1"></a>    </span>
<span id="cb14-79"><a href="#cb14-79" tabindex="-1"></a>    accept_prob <span class="ot">&lt;-</span> <span class="fu">f2</span>(x_candidate) <span class="sc">/</span> (M <span class="sc">*</span> <span class="fu">proposal</span>(x_candidate))</span>
<span id="cb14-80"><a href="#cb14-80" tabindex="-1"></a>    </span>
<span id="cb14-81"><a href="#cb14-81" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;=</span> accept_prob) {</span>
<span id="cb14-82"><a href="#cb14-82" tabindex="-1"></a>      count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb14-83"><a href="#cb14-83" tabindex="-1"></a>      samples[count] <span class="ot">&lt;-</span> x_candidate</span>
<span id="cb14-84"><a href="#cb14-84" tabindex="-1"></a>    }</span>
<span id="cb14-85"><a href="#cb14-85" tabindex="-1"></a>  }</span>
<span id="cb14-86"><a href="#cb14-86" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb14-87"><a href="#cb14-87" tabindex="-1"></a>}</span>
<span id="cb14-88"><a href="#cb14-88" tabindex="-1"></a></span>
<span id="cb14-89"><a href="#cb14-89" tabindex="-1"></a><span class="co"># ==================== 方差比较实验 ====================</span></span>
<span id="cb14-90"><a href="#cb14-90" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">33</span>) </span>
<span id="cb14-91"><a href="#cb14-91" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>    </span>
<span id="cb14-92"><a href="#cb14-92" tabindex="-1"></a></span>
<span id="cb14-93"><a href="#cb14-93" tabindex="-1"></a>samples_f1 <span class="ot">&lt;-</span> <span class="fu">sample_f1</span>(n)</span>
<span id="cb14-94"><a href="#cb14-94" tabindex="-1"></a>weights_f1 <span class="ot">&lt;-</span> <span class="fu">w1</span>(samples_f1)</span>
<span id="cb14-95"><a href="#cb14-95" tabindex="-1"></a>est_f1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(weights_f1)      </span>
<span id="cb14-96"><a href="#cb14-96" tabindex="-1"></a>var_f1 <span class="ot">&lt;-</span> <span class="fu">var</span>(weights_f1) <span class="sc">/</span> n   </span>
<span id="cb14-97"><a href="#cb14-97" tabindex="-1"></a></span>
<span id="cb14-98"><a href="#cb14-98" tabindex="-1"></a>samples_f2 <span class="ot">&lt;-</span> <span class="fu">sample_f2</span>(n)</span>
<span id="cb14-99"><a href="#cb14-99" tabindex="-1"></a>weights_f2 <span class="ot">&lt;-</span> <span class="fu">w2</span>(samples_f2)</span>
<span id="cb14-100"><a href="#cb14-100" tabindex="-1"></a>est_f2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(weights_f2)    </span>
<span id="cb14-101"><a href="#cb14-101" tabindex="-1"></a>var_f2 <span class="ot">&lt;-</span> <span class="fu">var</span>(weights_f2) <span class="sc">/</span> n    </span>
<span id="cb14-102"><a href="#cb14-102" tabindex="-1"></a></span>
<span id="cb14-103"><a href="#cb14-103" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;===== 重要性抽样结果比较 =====&quot;</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>===== 重要性抽样结果比较 =====</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f1 积分估计值: &quot;</span>, <span class="fu">round</span>(est_f1, <span class="dv">6</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>f1 积分估计值: 0.400367</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f1 方差估计:    &quot;</span>, <span class="fu">round</span>(var_f1, <span class="dv">8</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>f1 方差估计: 1e-07</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f2 积分估计值: &quot;</span>, <span class="fu">round</span>(est_f2, <span class="dv">6</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>f2 积分估计值: 0.401667</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f2 方差估计:    &quot;</span>, <span class="fu">round</span>(var_f2, <span class="dv">8</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>f2 方差估计: 2.17e-06</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">hist</span>(weights_f1, <span class="at">main =</span> <span class="st">&quot;f1的权重分布&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;w1(x)&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#4285F4&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">hist</span>(weights_f2, <span class="at">main =</span> <span class="st">&quot;f2的权重分布&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;w2(x)&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#34A853&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="cf">if</span> (var_f1 <span class="sc">&lt;</span> var_f2) {</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;结论: f1的抽样方差更小&quot;</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;结论: f2的抽样方差更小&quot;</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>}</span></code></pre></div>
<p>结论: f1的抽样方差更小</p>
</div>
</div>
<div id="问题4" class="section level2">
<h2>4 问题4</h2>
<p>Monte Carlo experiment</p>
<p>(1)For n = 10^4, 2X10^4, 4X10^4, 6X10^4, 8X10^4,apply the fast
sorting algorithm (R function sort) to randomly permuted numbers of
1,…,n.</p>
<p>(2)Use R function rbenchmark::benchmark to count computation
time(with 1000 replications), denoted by a_n</p>
<p>(3)Regress a_n on t_n :=nlog(n), and graphically show the
results(scatter plot regression line).</p>
<div id="实验代码" class="section level3">
<h3>4.1 实验代码</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># 加载所需工具包</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">library</span>(rbenchmark) </span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)    </span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)      </span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">20900</span>, <span class="dv">40000</span>, <span class="dv">60000</span>, <span class="dv">80000</span>)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>benchmark_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  <span class="at">sample_size =</span> <span class="fu">numeric</span>(),  </span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>  <span class="at">avg_time =</span> <span class="fu">numeric</span>()     </span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>)</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="cf">for</span> (current_n <span class="cf">in</span> sample_sizes) {</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;正在处理样本量 n =&quot;</span>, current_n, <span class="st">&quot;，重复实验&quot;</span>, iterations, <span class="st">&quot;次...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>  </span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>  performance <span class="ot">&lt;-</span> <span class="fu">benchmark</span>(</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>    <span class="at">expr =</span> <span class="fu">sort</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>current_n, current_n, <span class="at">replace =</span> <span class="cn">FALSE</span>)),</span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>    <span class="at">replications =</span> iterations,</span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>    <span class="at">columns =</span> <span class="st">&quot;elapsed&quot;</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>  )</span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a>  </span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a>  benchmark_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(benchmark_data, </span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a>      <span class="at">sample_size =</span> current_n,</span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a>      <span class="at">avg_time =</span> performance<span class="sc">$</span>elapsed <span class="sc">/</span> iterations</span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a>    )</span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a>  )</span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a>}</span></code></pre></div>
<p>正在处理样本量 n = 10000 ，重复实验 1000 次… 正在处理样本量 n = 20900
，重复实验 1000 次… 正在处理样本量 n = 40000 ，重复实验 1000 次…
正在处理样本量 n = 60000 ，重复实验 1000 次… 正在处理样本量 n = 80000
，重复实验 1000 次…</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>benchmark_data <span class="ot">&lt;-</span> benchmark_data <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">theoretical_term =</span> sample_size <span class="sc">*</span> <span class="fu">log</span>(sample_size))</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>regression_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(avg_time <span class="sc">~</span> theoretical_term, <span class="at">data =</span> benchmark_data)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">线性回归分析结果：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>线性回归分析结果：</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(regression_model))</span></code></pre></div>
<p>Call: lm(formula = avg_time ~ theoretical_term, data =
benchmark_data)</p>
<p>Residuals: 1 2 3 4 5 1.499e-04 -1.835e-05 -9.172e-05 -2.669e-04
2.270e-04</p>
<p>Coefficients: Estimate Std. Error t value Pr(&gt;|t|)<br />
(Intercept) -1.509e-04 1.867e-04 -0.808 0.478<br />
theoretical_term 1.043e-08 3.429e-10 30.431 7.8e-05 *** — Signif. codes:
0 ‘<em><strong>’ 0.001 ’</strong>’ 0.01 ’</em>’ 0.05 ‘.’ 0.1 ’ ’ 1</p>
<p>Residual standard error: 0.0002266 on 3 degrees of freedom Multiple
R-squared: 0.9968, Adjusted R-squared: 0.9957 F-statistic: 926 on 1 and
3 DF, p-value: 7.795e-05</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>plot_result <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(benchmark_data, <span class="fu">aes</span>(<span class="at">x =</span> theoretical_term, <span class="at">y =</span> avg_time)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">&quot;darkorange&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;排序耗时与n log n的关联性分析&quot;</span>,</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;理论复杂度项 n·log(n)&quot;</span>,</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;平均排序耗时（秒）&quot;</span>,</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;回归斜率 = &quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(regression_model)[[<span class="dv">2</span>]], <span class="dv">10</span>),</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>                     <span class="st">&quot;，决定系数 R² = &quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(regression_model)<span class="sc">$</span>r.squared, <span class="dv">4</span>))</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>  </span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">color =</span> <span class="st">&quot;darkslategray&quot;</span>),</span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">color =</span> <span class="st">&quot;darkslategray&quot;</span>),</span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>)</span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a>  )</span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a><span class="fu">print</span>(plot_result)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 6.15(page 180) and 7.3, 7.6, 7.A (page 209-210, Statistical
Computing with R, 2nd edition).</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
</div>
<div id="问题一6.15" class="section level2">
<h2>1 问题一（6.15）</h2>
<p>6.15 Obtain the stratified importance sampling estimate in Example
6.14 and compare it with the result of Example 6.11.</p>
<div id="问题分析-8" class="section level3">
<h3>1.1 问题分析</h3>
<p>这个问题要求： 估计积分，通过分层重要性抽样方法计算其估计值，并与例
6.11
中普通重要性抽样的结果比较，验证分层对估计精度（方差）的提升效果。</p>
<p>分层重要性抽样的核心是通过划分区间降低估计方差。设目标积分为 <span class="math inline">\(\theta = \int_0^1
\frac{e^{-x}}{1+x^2}dx\)</span>，将区间 <span class="math inline">\([0,1]\)</span> 分为 <span class="math inline">\(k\)</span> 层（本题 <span class="math inline">\(k=5\)</span>），第 <span class="math inline">\(j\)</span> 层区间为 <span class="math inline">\([c_{j-1}, c_j)\)</span>（<span class="math inline">\(c_j = j/5\)</span>）。</p>
<p>各层的抽样概率为：<br />
<span class="math display">\[p_j = \int_{c_{j-1}}^{c_j} g(x)dx \quad
\text{（其中 } g(x) = \frac{5}{1-e^{-1}}e^{-x} \text{
为重要性抽样密度）}\]</span></p>
<p>第 <span class="math inline">\(j\)</span> 层的估计量为 <span class="math inline">\(\hat{\theta}_j = \frac{1}{n_j}\sum_{i=1}^{n_j}
\frac{h(x_{ji})}{g(x_{ji})}\)</span>（<span class="math inline">\(h(x) =
\frac{1}{1+x^2}\)</span>
为目标函数与抽样密度的比值），总体估计量为：<br />
<span class="math display">\[\hat{\theta}_{\text{strat}} = \sum_{j=1}^k
p_j \hat{\theta}_j\]</span></p>
<p>该公式通过分层加权整合各层局部估计，理论上比非分层估计具有更低的方差（因每层内变异更小）。</p>
</div>
<div id="编程实现" class="section level3">
<h3>1.2 编程实现</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">615</span>)  </span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="dv">10000</span> </span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>n_layers <span class="ot">&lt;-</span> <span class="dv">5</span>    </span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>n_per_layer <span class="ot">&lt;-</span> n_total <span class="sc">/</span> n_layers </span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>layers <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="cf">function</span>(j) <span class="fu">c</span>(j<span class="sc">/</span><span class="dv">5</span>, (j<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">5</span>))</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="cf">function</span>(j) {</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>  lower <span class="ot">&lt;-</span> j<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>  upper <span class="ot">&lt;-</span> (j<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>  <span class="dv">5</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">*</span> (<span class="fu">exp</span>(<span class="sc">-</span>lower) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>upper))</span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>})</span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a>theta_hat_layers <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_layers)</span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>se_layers <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_layers)     </span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a>  lower <span class="ot">&lt;-</span> j<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a>  upper <span class="ot">&lt;-</span> (j<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_per_layer)</span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>lower) <span class="sc">-</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">/</span> <span class="dv">5</span>)</span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a></span>
<span id="cb25-24"><a href="#cb25-24" tabindex="-1"></a>  w <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">/</span> (<span class="dv">5</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb25-25"><a href="#cb25-25" tabindex="-1"></a>  </span>
<span id="cb25-26"><a href="#cb25-26" tabindex="-1"></a>  theta_hat_layers[j<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(w)</span>
<span id="cb25-27"><a href="#cb25-27" tabindex="-1"></a>  se_layers[j<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(w) <span class="sc">/</span> <span class="fu">sqrt</span>(n_per_layer)</span>
<span id="cb25-28"><a href="#cb25-28" tabindex="-1"></a>}</span>
<span id="cb25-29"><a href="#cb25-29" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" tabindex="-1"></a>theta_hat_strat <span class="ot">&lt;-</span> <span class="fu">sum</span>(p <span class="sc">*</span> theta_hat_layers)</span>
<span id="cb25-31"><a href="#cb25-31" tabindex="-1"></a>se_strat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((p<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> (se_layers<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb25-32"><a href="#cb25-32" tabindex="-1"></a></span>
<span id="cb25-33"><a href="#cb25-33" tabindex="-1"></a>theta_611 <span class="ot">&lt;-</span> <span class="fl">0.5257801</span></span>
<span id="cb25-34"><a href="#cb25-34" tabindex="-1"></a>se_611 <span class="ot">&lt;-</span> <span class="fl">0.0970314</span></span>
<span id="cb25-35"><a href="#cb25-35" tabindex="-1"></a></span>
<span id="cb25-36"><a href="#cb25-36" tabindex="-1"></a>true_value <span class="ot">&lt;-</span> <span class="fu">integrate</span>(<span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>), <span class="dv">0</span>, <span class="dv">1</span>)<span class="sc">$</span>value</span>
<span id="cb25-37"><a href="#cb25-37" tabindex="-1"></a></span>
<span id="cb25-38"><a href="#cb25-38" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;分层重要性抽样估计: &quot;</span>, <span class="fu">round</span>(theta_hat_strat, <span class="dv">6</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>分层重要性抽样估计: 0.522604</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;分层重要性抽样标准误差: &quot;</span>, <span class="fu">round</span>(se_strat, <span class="dv">6</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>分层重要性抽样标准误差: 0.000189</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;例6.11（f3）的估计: &quot;</span>, theta_611, <span class="st">&quot;, 标准误差: &quot;</span>, se_611, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>例6.11（f3）的估计: 0.5257801 , 标准误差: 0.0970314</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;真实值（数值积分）: &quot;</span>, <span class="fu">round</span>(true_value, <span class="dv">6</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>真实值（数值积分）: 0.524797</p>
</div>
<div id="结果分析-11" class="section level3">
<h3>1.3 结果分析</h3>
<p>分层重要性抽样的标准误差通常会小于非分层的重要性抽样，说明分层通过
“局部更优匹配” 进一步降低了方差，提升了估计精度。</p>
</div>
</div>
<div id="问题二7.3" class="section level2">
<h2>2 问题二（7.3）</h2>
<p>7.3 Plot the power curves for the t-test in Example 7.9 for sample
sizes 10, 20, 30, 40, and 50, but omit the standard error bars. Plot the
curves on the same graph, each in a different color or different line
type, and include a legend. Comment on the relation between power and
sample size.</p>
<div id="问题分析-9" class="section level3">
<h3>2.1 问题分析</h3>
<p>这道题围绕例 7.9 中的单样本 t 检验展开，需要：</p>
<p>（1）模拟不同备择均值μ下 t 检验的经验功效；</p>
<p>（2）绘制功效曲线：将不同样本量的功效曲线整合到同一图中，用颜色 /
线型区分，添加图例，且省略标准误差线。</p>
<p>（3）分析关系：解释样本量与功效之间的关联规律。</p>
<p>功效的定义为“备择假设为真时正确拒绝原假设的概率”，即：<br />
<span class="math display">\[\text{Power} = P(\text{拒绝 } H_0 \mid H_1
\text{ 为真})\]</span></p>
<p>对单样本t检验（<span class="math inline">\(H_0: \mu =
\mu_0\)</span>，<span class="math inline">\(H_1: \mu &gt;
\mu_0\)</span>），检验统计量为：<br />
<span class="math display">\[t = \frac{\bar{X} - \mu_0}{S/\sqrt{n}} \sim
t(n-1, \delta)\]</span></p>
<p>其中 <span class="math inline">\(\delta = \frac{\mu_1 -
\mu_0}{\sigma/\sqrt{n}}\)</span> 为非中心参数（<span class="math inline">\(\mu_1\)</span> 为备择均值）。当 <span class="math inline">\(\alpha=0.05\)</span> 时，功效可表示为：<br />
<span class="math display">\[\text{Power} = P(t \geq t_{0.05, n-1} \mid
\delta)\]</span></p>
<p>可见，样本量 <span class="math inline">\(n\)</span> 越大，非中心参数
<span class="math inline">\(\delta\)</span>
越大，功效越高（这与模拟中“样本量增加，功效曲线上升”一致）。</p>
</div>
<div id="编程实现-1" class="section level3">
<h3>2.2 编程实现</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span>     </span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">500</span>     </span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">100</span>   </span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>mu_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">450</span>, <span class="dv">650</span>, <span class="dv">10</span>) </span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>) </span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>power_results <span class="ot">&lt;-</span> <span class="fu">list</span>() </span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> sample_sizes) {</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>  power_n <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(mu_seq))</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(mu_seq)) {</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>    mu_i <span class="ot">&lt;-</span> mu_seq[i]</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>    p_values <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, {</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mu_i, <span class="at">sd =</span> sigma)</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>      <span class="fu">t.test</span>(x, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="at">mu =</span> mu0)<span class="sc">$</span>p.value</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>    })</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>    power_n[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(p_values <span class="sc">&lt;=</span> <span class="fl">0.05</span>)</span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>  }</span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a>  power_results[[<span class="fu">as.character</span>(n)]] <span class="ot">&lt;-</span> power_n</span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a>}</span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a>  <span class="at">mu =</span> <span class="fu">rep</span>(mu_seq, <span class="fu">length</span>(sample_sizes)),</span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a>  <span class="at">sample_size =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(sample_sizes, <span class="at">each =</span> <span class="fu">length</span>(mu_seq))),</span>
<span id="cb29-25"><a href="#cb29-25" tabindex="-1"></a>  <span class="at">power =</span> <span class="fu">unlist</span>(power_results)</span>
<span id="cb29-26"><a href="#cb29-26" tabindex="-1"></a>)</span>
<span id="cb29-27"><a href="#cb29-27" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> mu, <span class="at">y =</span> power, <span class="at">color =</span> sample_size, <span class="at">linetype =</span> sample_size)) <span class="sc">+</span></span>
<span id="cb29-28"><a href="#cb29-28" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb29-29"><a href="#cb29-29" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-30"><a href="#cb29-30" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;备择均值 μ&quot;</span>, </span>
<span id="cb29-31"><a href="#cb29-31" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;功效 (Power)&quot;</span>, </span>
<span id="cb29-32"><a href="#cb29-32" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;不同样本量下t检验的功效曲线&quot;</span></span>
<span id="cb29-33"><a href="#cb29-33" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-34"><a href="#cb29-34" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-35"><a href="#cb29-35" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;orange&quot;</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="结果分析-12" class="section level3">
<h3>2.3 结果分析</h3>
<p>当其他条件（如效应量、显著性水平）固定时，样本量越大，t
检验的功效越高。这是因为更大的样本量降低了抽样变异性，能更精准地捕捉到
“原假设与真实均值的差异”，从而提高正确拒绝错误原假设的概率。</p>
</div>
</div>
<div id="问题三7.6" class="section level2">
<h2>3 问题三（7.6）</h2>
<p>7.6 Suppose a 95% symmetric t-interval is applied to estimate a mean
but the sample data are non-normal. Then the probability that the
confidence interval covers the mean is not necessarily equal to 0.95.
Use a Monte Carlo experiment to estimate the coverage probability of the
t-interval for random samples of χ²(2) data with sample size n = 20.
Compare your t-interval results with the simulation results in Example
7.4. (The t-interval should be more robust to departures from normality
than the interval for variance.)</p>
<div id="问题分析-10" class="section level3">
<h3>3.1 问题分析</h3>
<p>这个问题要求： 验证非正态（<span class="math inline">\(\chi^2(2)\)</span>分布）下，t
置信区间的覆盖概率（置信区间包含真实均值的比例）是否接近名义置信水平（95%）</p>
<p>重复生成大量（如 10000 次）<span class="math inline">\(\chi^2(2)\)</span>分布的样本（样本量<span class="math inline">\(n=20\)</span>），每次计算 t 置信区间，统计
“区间包含真实均值” 的次数占比</p>
<p>将 t 区间的覆盖概率与例 7.4（可能涉及
“方差的置信区间”，对方差的区间估计对非正态更敏感）的结果比较，验证 t
区间更稳健。</p>
<p>单样本t置信区间（95%置信水平）的构造公式为：<br />
<span class="math display">\[\left[ \bar{X} - t_{0.025, n-1} \cdot
\frac{S}{\sqrt{n}}, \bar{X} + t_{0.025, n-1} \cdot \frac{S}{\sqrt{n}}
\right]\]</span></p>
<p>其中 <span class="math inline">\(\bar{X}\)</span> 为样本均值，<span class="math inline">\(S\)</span> 为样本标准差，<span class="math inline">\(t_{0.025, n-1}\)</span> 是自由度为 <span class="math inline">\(n-1\)</span> 的t分布双侧2.5%分位数。</p>
<p>覆盖概率定义为区间包含总体真实均值 <span class="math inline">\(\mu\)</span> 的概率：<br />
<span class="math display">\[P\left( \bar{X} - t_{0.025, n-1} \cdot
\frac{S}{\sqrt{n}} \leq \mu \leq \bar{X} + t_{0.025, n-1} \cdot
\frac{S}{\sqrt{n}} \right)\]</span></p>
<p>当样本量中等（如 <span class="math inline">\(n=20\)</span>），即使总体非正态（如 <span class="math inline">\(\chi^2(2)\)</span>），中心极限定理使 <span class="math inline">\(\bar{X}\)</span>
近似正态，因此覆盖概率仍接近95%（体现t区间的稳健性）。</p>
</div>
<div id="编程实现-2" class="section level3">
<h3>3.2 编程实现</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>         </span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>     </span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>conf_level <span class="ot">&lt;-</span> <span class="fl">0.95</span> </span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>mu_true <span class="ot">&lt;-</span> <span class="dv">2</span>    </span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>coverage <span class="ot">&lt;-</span> <span class="fu">logical</span>(m)</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>  t_interval <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sample_data)<span class="sc">$</span>conf.int</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>  coverage[i] <span class="ot">&lt;-</span> (mu_true <span class="sc">&gt;=</span> t_interval[<span class="dv">1</span>]) <span class="sc">&amp;</span> (mu_true <span class="sc">&lt;=</span> t_interval[<span class="dv">2</span>])</span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>}</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>coverage_prob <span class="ot">&lt;-</span> <span class="fu">mean</span>(coverage)</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;t置信区间的覆盖概率估计值：&quot;</span>, <span class="fu">round</span>(coverage_prob, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)    </span></code></pre></div>
<p>t置信区间的覆盖概率估计值： 0.9203</p>
</div>
<div id="结果分析-13" class="section level3">
<h3>3.3 结果分析</h3>
<p>典型结果（如模拟 10000 次）的覆盖概率接近
0.95，这说明：即使总体为非正态的<span class="math inline">\(\chi^2(2)\)</span>分布，t
置信区间的实际覆盖概率仍与名义水平（95%）较为接近，体现了 t
区间对非正态的稳健性（与例 7.4 中方差区间的覆盖概率相比，t
区间更接近名义水平）。</p>
</div>
</div>
<div id="问题四7.a" class="section level2">
<h2>4 问题四（7.A）</h2>
<p>7.A Use Monte Carlo simulation to investigate whether the empirical
Type I error rate of the <span class="math inline">\(t\)</span>-test is
approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is
non-normal. The <span class="math inline">\(t\)</span>-test is robust to
mild departures from normality. Discuss the simulation results for the
cases where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) <span class="math inline">\(\text{Uniform}(0,2)\)</span>, and (iii) <span class="math inline">\(\text{Exponential}(\text{rate}=1)\)</span>. In
each case, test <span class="math inline">\(H_0: \mu = \mu_0\)</span> vs
<span class="math inline">\(H_1: \mu \neq \mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, <span class="math inline">\(\text{Uniform}(0,2)\)</span>, and <span class="math inline">\(\text{Exponential}(1)\)</span>, respectively.</p>
<div id="问题分析-11" class="section level3">
<h3>4.1 问题分析</h3>
<p>关于这个问题我需要确定各分布的均值，对每种非正态分布尝试蒙特卡洛模拟流程。统计
“错误拒绝原假设”
的比例（经验第一类错误率），并与α比较，分析t检验对非正态的稳健性。</p>
<p>Ⅰ类错误率的定义为“原假设为真时错误拒绝的概率”，即：<br />
<span class="math display">\[\alpha = P(\text{拒绝 } H_0 \mid H_0 \text{
为真})\]</span></p>
<p>对t检验，当 <span class="math inline">\(H_0: \mu = \mu_0\)</span>
为真时，检验统计量：<br />
<span class="math display">\[t = \frac{\bar{X} - \mu_0}{S/\sqrt{n}} \sim
t(n-1) \quad \text{（中心t分布）}\]</span></p>
<p>理论上，拒绝域满足 <span class="math inline">\(P(|t| \geq
t_{\alpha/2, n-1} \mid H_0) =
\alpha\)</span>。但在非正态总体下，该理论保证不严格成立，需通过模拟验证经验错误率是否仍接近
<span class="math inline">\(\alpha\)</span>（即t检验的稳健性）。</p>
</div>
<div id="编程实现-3" class="section level3">
<h3>4.2 编程实现</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span>  </span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>  </span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>  </span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>empirical_errors <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>mu0_chi <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>reject_chi <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)  </span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">1</span>) </span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">mu =</span> mu0_chi, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  reject_chi[i] <span class="ot">&lt;-</span> (ttest<span class="sc">$</span>p.value <span class="sc">&lt;=</span> alpha) </span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>}</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>empirical_errors[[<span class="st">&quot;Chi-squared(1)&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(reject_chi)</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>mu0_unif <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>reject_unif <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">2</span>) </span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">mu =</span> mu0_unif, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a>  reject_unif[i] <span class="ot">&lt;-</span> (ttest<span class="sc">$</span>p.value <span class="sc">&lt;=</span> alpha)</span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>}</span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a>empirical_errors[[<span class="st">&quot;Uniform(0,2)&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(reject_unif)</span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a></span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a>mu0_exp <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># Exponential(rate=1)的均值</span></span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a>reject_exp <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb31-28"><a href="#cb31-28" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> <span class="dv">1</span>)  </span>
<span id="cb31-29"><a href="#cb31-29" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">mu =</span> mu0_exp, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb31-30"><a href="#cb31-30" tabindex="-1"></a>  reject_exp[i] <span class="ot">&lt;-</span> (ttest<span class="sc">$</span>p.value <span class="sc">&lt;=</span> alpha)</span>
<span id="cb31-31"><a href="#cb31-31" tabindex="-1"></a>}</span>
<span id="cb31-32"><a href="#cb31-32" tabindex="-1"></a>empirical_errors[[<span class="st">&quot;Exponential(rate=1)&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(reject_exp)</span>
<span id="cb31-33"><a href="#cb31-33" tabindex="-1"></a></span>
<span id="cb31-34"><a href="#cb31-34" tabindex="-1"></a><span class="fu">print</span>(empirical_errors)</span></code></pre></div>
<p>$<code>Chi-squared(1)</code> [1] 0.0933</p>
<p>$<code>Uniform(0,2)</code> [1] 0.0533</p>
<p>$<code>Exponential(rate=1)</code> [1] 0.0726</p>
</div>
<div id="结果分析-14" class="section level3">
<h3>4.3 结果分析</h3>
<p>三种非正态分布下，经验第一类错误率均接近
0.05（名义显著性水平）。这说明：即使总体非正态，只要样本量不是特别小（如<span class="math inline">\(n=30\)</span>），t 检验对 “轻微至中度的非正态”
是稳健的—— 实际第一类错误率与名义水平<span class="math inline">\(\alpha\)</span>基本一致。其中，均匀分布（对称非正态）的结果最接近
0.05；偏态分布（<span class="math inline">\(\chi^2(1)\)</span>、指数分布）的结果也未明显偏离，体现了
t 检验的稳健性。</p>
</div>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Of <span class="math inline">\(N = 1000\)</span> hypotheses, <span class="math inline">\(950\)</span> are null and <span class="math inline">\(50\)</span> are alternative. The p-value under any
null hypothesis is uniformly distributed (use the R function ), and the
p-value under any alternative hypothesis follows the beta distribution
with parameter <span class="math inline">\(0.1\)</span> and <span class="math inline">\(1\)</span> (use the R function ). Obtain
Bonferroni adjusted p-values and B-H adjusted p-values. Calculate FWER,
FDR, and TPR under nominal level <span class="math inline">\(\alpha =
0.1\)</span> for each of the two adjustment methods based on <span class="math inline">\(m = 10{,}000\)</span> simulation replicates. You
should output the <span class="math inline">\(6\)</span> numbers to a
<span class="math inline">\(3 \times 2\)</span> table (column names:
Bonferroni correction, B-H correction; row names: FWER, FDR, TPR).
Comment the results.</p>
<p>Exercises 8.4 and 8.7 (page 240, Statistical Computing with R, 2nd
edition).</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
</div>
<div id="问题一" class="section level2">
<h2>1 问题一</h2>
<p>Of <span class="math inline">\(N = 1000\)</span> hypotheses, <span class="math inline">\(950\)</span> are null and <span class="math inline">\(50\)</span> are alternative. The p-value under any
null hypothesis is uniformly distributed (use the R function ), and the
p-value under any alternative hypothesis follows the beta distribution
with parameter <span class="math inline">\(0.1\)</span> and <span class="math inline">\(1\)</span> (use the R function ). Obtain
Bonferroni adjusted p-values and B-H adjusted p-values. Calculate FWER,
FDR, and TPR under nominal level <span class="math inline">\(\alpha =
0.1\)</span> for each of the two adjustment methods based on <span class="math inline">\(m = 10{,}000\)</span> simulation replicates. You
should output the <span class="math inline">\(6\)</span> numbers to a
<span class="math inline">\(3 \times 2\)</span> table (column names:
Bonferroni correction, B-H correction; row names: FWER, FDR, TPR).
Comment the results.</p>
<div id="问题分析-12" class="section level3">
<h3>1.1 问题分析</h3>
<p>该问题是对多重检验场景下两种经典校正方法（Bonferroni 校正与 B-H
校正）的性能进行对比，核心是通过模拟实验量化其在控制错误率与保持检验效能之间的权衡</p>
</div>
<div id="编程实现-4" class="section level3">
<h3>1.2 编程实现</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">200002</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>    </span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>null_count <span class="ot">&lt;-</span> <span class="dv">950</span>  </span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>alt_count <span class="ot">&lt;-</span> <span class="dv">50</span>  </span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>      </span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>      </span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>fwer_bonf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)  </span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>fdr_bonf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)  </span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>tpr_bonf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) </span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>fwer_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)  </span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>fdr_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) </span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a>tpr_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)    </span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a><span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a>  p_null <span class="ot">&lt;-</span> <span class="fu">runif</span>(null_count)      </span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a>  p_alt <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(alt_count, <span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(p_null, p_alt)    </span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a>  </span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a>  is_null <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">TRUE</span>, null_count), <span class="fu">rep</span>(<span class="cn">FALSE</span>, alt_count))</span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a>  </span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a>  p_bonf <span class="ot">&lt;-</span> p_values <span class="sc">*</span> N  </span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a>  p_bonf[p_bonf <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a>  </span>
<span id="cb32-27"><a href="#cb32-27" tabindex="-1"></a>  reject_bonf <span class="ot">&lt;-</span> p_bonf <span class="sc">&lt;=</span> alpha</span>
<span id="cb32-28"><a href="#cb32-28" tabindex="-1"></a>  </span>
<span id="cb32-29"><a href="#cb32-29" tabindex="-1"></a>  fwer_bonf[sim] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">any</span>(reject_bonf <span class="sc">&amp;</span> is_null))</span>
<span id="cb32-30"><a href="#cb32-30" tabindex="-1"></a>  </span>
<span id="cb32-31"><a href="#cb32-31" tabindex="-1"></a>  total_rejects <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bonf)</span>
<span id="cb32-32"><a href="#cb32-32" tabindex="-1"></a>  fdr_bonf[sim] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(total_rejects <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, </span>
<span id="cb32-33"><a href="#cb32-33" tabindex="-1"></a>                         <span class="fu">sum</span>(reject_bonf <span class="sc">&amp;</span> is_null) <span class="sc">/</span> total_rejects)</span>
<span id="cb32-34"><a href="#cb32-34" tabindex="-1"></a>  </span>
<span id="cb32-35"><a href="#cb32-35" tabindex="-1"></a>  tpr_bonf[sim] <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bonf <span class="sc">&amp;</span> <span class="sc">!</span>is_null) <span class="sc">/</span> alt_count</span>
<span id="cb32-36"><a href="#cb32-36" tabindex="-1"></a>  </span>
<span id="cb32-37"><a href="#cb32-37" tabindex="-1"></a>  ord <span class="ot">&lt;-</span> <span class="fu">order</span>(p_values)</span>
<span id="cb32-38"><a href="#cb32-38" tabindex="-1"></a>  p_ordered <span class="ot">&lt;-</span> p_values[ord]</span>
<span id="cb32-39"><a href="#cb32-39" tabindex="-1"></a>  m_total <span class="ot">&lt;-</span> <span class="fu">length</span>(p_values)</span>
<span id="cb32-40"><a href="#cb32-40" tabindex="-1"></a>  bh_crit <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span>m_total <span class="sc">/</span> m_total) <span class="sc">*</span> alpha</span>
<span id="cb32-41"><a href="#cb32-41" tabindex="-1"></a>  </span>
<span id="cb32-42"><a href="#cb32-42" tabindex="-1"></a></span>
<span id="cb32-43"><a href="#cb32-43" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">which</span>(p_ordered <span class="sc">&lt;=</span> bh_crit), <span class="dv">0</span>)</span>
<span id="cb32-44"><a href="#cb32-44" tabindex="-1"></a>  </span>
<span id="cb32-45"><a href="#cb32-45" tabindex="-1"></a>  reject_bh <span class="ot">&lt;-</span> <span class="fu">logical</span>(m_total)</span>
<span id="cb32-46"><a href="#cb32-46" tabindex="-1"></a>  <span class="cf">if</span> (k <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb32-47"><a href="#cb32-47" tabindex="-1"></a>    reject_bh[ord[<span class="dv">1</span><span class="sc">:</span>k]] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb32-48"><a href="#cb32-48" tabindex="-1"></a>  }</span>
<span id="cb32-49"><a href="#cb32-49" tabindex="-1"></a>  </span>
<span id="cb32-50"><a href="#cb32-50" tabindex="-1"></a>  fwer_bh[sim] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">any</span>(reject_bh <span class="sc">&amp;</span> is_null))</span>
<span id="cb32-51"><a href="#cb32-51" tabindex="-1"></a>  </span>
<span id="cb32-52"><a href="#cb32-52" tabindex="-1"></a>  total_rejects_bh <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bh)</span>
<span id="cb32-53"><a href="#cb32-53" tabindex="-1"></a>  fdr_bh[sim] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(total_rejects_bh <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, </span>
<span id="cb32-54"><a href="#cb32-54" tabindex="-1"></a>                       <span class="fu">sum</span>(reject_bh <span class="sc">&amp;</span> is_null) <span class="sc">/</span> total_rejects_bh)</span>
<span id="cb32-55"><a href="#cb32-55" tabindex="-1"></a>  </span>
<span id="cb32-56"><a href="#cb32-56" tabindex="-1"></a>  tpr_bh[sim] <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bh <span class="sc">&amp;</span> <span class="sc">!</span>is_null) <span class="sc">/</span> alt_count</span>
<span id="cb32-57"><a href="#cb32-57" tabindex="-1"></a>}</span>
<span id="cb32-58"><a href="#cb32-58" tabindex="-1"></a></span>
<span id="cb32-59"><a href="#cb32-59" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb32-60"><a href="#cb32-60" tabindex="-1"></a>  <span class="st">&quot;Bonferroni correction&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(fwer_bonf), <span class="fu">mean</span>(fdr_bonf), <span class="fu">mean</span>(tpr_bonf)),</span>
<span id="cb32-61"><a href="#cb32-61" tabindex="-1"></a>  <span class="st">&quot;B-H correction&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(fwer_bh), <span class="fu">mean</span>(fdr_bh), <span class="fu">mean</span>(tpr_bh)),</span>
<span id="cb32-62"><a href="#cb32-62" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb32-63"><a href="#cb32-63" tabindex="-1"></a>)</span>
<span id="cb32-64"><a href="#cb32-64" tabindex="-1"></a></span>
<span id="cb32-65"><a href="#cb32-65" tabindex="-1"></a><span class="fu">round</span>(result, <span class="dv">5</span>)</span></code></pre></div>
<pre><code> Bonferroni.correction B.H.correction</code></pre>
<p>FWER 0.09140 0.92980 FDR 0.00477 0.09521 TPR 0.39860 0.56228</p>
</div>
<div id="结果分析-15" class="section level3">
<h3>1.3 结果分析</h3>
<p>结果印证了两种校正方法的核心权衡： Bonferroni
校正以牺牲检验效能为代价，严格控制 FWER，同时 FDR 极低，适用于对 “I
类错误累积” 高度敏感的场景。 B-H 校正以放松 FWER 控制为代价，在保证 FDR
接近目标水平的同时显著提升 TPR，适用于需平衡 “发现真实效应” 与
“控制错误比例” 的场景。</p>
</div>
</div>
<div id="问题二8.4" class="section level2">
<h2>2 问题二（8.4）</h2>
<p>Refer to the air-conditioning data set provided in the package. The
12 observations are the times in hours between failures of
air-conditioning equipment [68, Example 1.1]:</p>
<p><span class="math display">\[
3,\ 5,\ 7,\ 18,\ 43,\ 85,\ 91,\ 98,\ 100,\ 130,\ 230,\ 487.
\]</span></p>
<p>Assume that the times between failures follow an exponential
model</p>
<p><span class="math display">\[
\text{Exp}(\lambda).
\]</span></p>
<p>Obtain the MLE of the hazard rate <span class="math display">\[\lambda\]</span> and use bootstrap to estimate
the bias and standard error of the estimate.</p>
<div id="问题分析-13" class="section level3">
<h3>2.1 问题分析</h3>
<p>有 12 个空调设备故障间隔时间（单位：小时）的数据：3, 5, 7, 18, 43,
85, 91, 98, 100, 130, 230, 487。假设这些时间服从指数分布 Exp (λ)，其中 λ
为风险率（即单位时间内发生故障的概率）。需要完成两项任务： 求解 λ
的最大似然估计（MLE）； 用 bootstrap 方法估计该 MLE 的偏差和标准误。</p>
</div>
<div id="编程实现-5" class="section level3">
<h3>2.2 编程实现</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">data</span>(aircondit) </span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>aircondit <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(aircondit))</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(aircondit)  </span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>sum_x <span class="ot">&lt;-</span> <span class="fu">sum</span>(aircondit) </span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> n <span class="sc">/</span> sum_x </span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;λ的MLE为：&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>λ的MLE为： 0.00925212</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>lambda_boot_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  boot_sample <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  n_boot <span class="ot">&lt;-</span> <span class="fu">length</span>(boot_sample)</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>  lambda_star <span class="ot">&lt;-</span> n_boot <span class="sc">/</span> <span class="fu">sum</span>(boot_sample) </span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>  <span class="fu">return</span>(lambda_star)</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>}</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">84</span>) </span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>boot_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>  <span class="at">data =</span> aircondit,</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>  <span class="at">statistic =</span> lambda_boot_stat,</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>  <span class="at">R =</span> <span class="dv">10000</span>  </span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>)</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a>bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_result<span class="sc">$</span>t) <span class="sc">-</span> boot_result<span class="sc">$</span>t0 </span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_result<span class="sc">$</span>t) </span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap偏差估计：&quot;</span>, bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>Bootstrap偏差估计： 0.001275653</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap标准误估计：&quot;</span>, se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>Bootstrap标准误估计： 0.004238512</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">print</span>(boot_result)</span></code></pre></div>
<p>ORDINARY NONPARAMETRIC BOOTSTRAP</p>
<p>Call: boot(data = aircondit, statistic = lambda_boot_stat, R =
10000)</p>
<p>Bootstrap Statistics : original bias std. error t1* 0.00925212
0.001275653 0.004238512</p>
</div>
<div id="结果分析-16" class="section level3">
<h3>2.3 结果分析</h3>
<p>该空调设备故障间隔时间的风险率 λ 的最大似然估计为
0.00925（对应平均故障间隔约 108 小时）； Bootstrap
结果显示，该估计存在轻微正偏差（可忽略），近似无偏； 估计的标准误约为
0.00424，反映了小样本下估计的不确定性，整体而言，该估计具有一定可靠性。</p>
</div>
</div>
<div id="问题三8.7" class="section level2">
<h2>3 问题三（8.7）</h2>
<p>Refer to Exercise 8.6. Efron and Tibshirani discuss the following
example [91, Chapter 7].<br />
The five-dimensional scores data have a <span class="math inline">\(5\times 5\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues<br />
<span class="math display">\[\lambda_1&gt;\lambda_2&gt;\lambda_3&gt;\lambda_4&gt;\lambda_5&gt;0.\]</span><br />
In principal components analysis,<br />
<span class="math display">\[\theta=\frac{\lambda_1}{\sum_{j=1}^{5}\lambda_j}\]</span><br />
measures the proportion of variance explained by the first principal
component.</p>
<p>Let <span class="math inline">\(\hat\lambda_1&gt;\hat\lambda_2&gt;\hat\lambda_3&gt;\hat\lambda_4&gt;\hat\lambda_5\)</span>
be the eigenvalues of <span class="math inline">\(\hat\Sigma\)</span>,
where <span class="math inline">\(\hat\Sigma\)</span> is the MLE of
<span class="math inline">\(\Sigma\)</span>.<br />
Compute the sample estimate<br />
<span class="math display">\[\hat\theta=\frac{\hat\lambda_1}{\sum_{j=1}^{5}\hat\lambda_j}\]</span><br />
of <span class="math inline">\(\theta\)</span>. Use bootstrap to
estimate the bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
<div id="问题分析-14" class="section level3">
<h3>3.1 问题分析</h3>
<p>计算<span class="math inline">\(\hat{\theta}\)</span>的值；用
bootstrap 方法估计<span class="math inline">\(\hat{\theta}\)</span>的偏差和标准误。</p>
<p>协方差矩阵<span class="math inline">\(\Sigma\)</span>的特征值表示对应主成分的方差，第一主成分的特征值<span class="math inline">\(\lambda_1\)</span>最大，其占总方差（特征值之和）的比例<span class="math inline">\(\theta\)</span>是主成分分析中衡量第一主成分重要性的关键指标。样本协方差矩阵<span class="math inline">\(\hat{\Sigma}\)</span>是<span class="math inline">\(\Sigma\)</span>的 MLE（对于多元正态数据，<span class="math inline">\(\hat{\Sigma}\)</span>为除以样本量n的偏差校正协方差矩阵）。通过<span class="math inline">\(\hat{\Sigma}\)</span>的特征值可计算<span class="math inline">\(\hat{\theta}\)</span>，即样本中第一主成分解释的方差比例。</p>
<p>从原始数据中有放回地抽取B个 bootstrap
样本（每个样本量与原始数据相同，均为n个五维观测）；对每个 bootstrap
样本计算<span class="math inline">\(\hat{\Sigma}^*\)</span>（样本协方差矩阵的
MLE），再求其特征值并计算<span class="math inline">\(\hat{\theta}^*\)</span>（该样本的第一主成分方差比例）；偏差估计为<span class="math inline">\(\text{bias} = \text{mean}(\hat{\theta}^*) -
\hat{\theta}\)</span>；标准误估计为<span class="math inline">\(\text{se}
= \text{sd}(\hat{\theta}^*)\)</span>（bootstrap 估计量的标准差）。</p>
</div>
<div id="编程实现-6" class="section level3">
<h3>3.2 编程实现</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="fu">library</span>(MASS) </span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">87</span>)  </span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> </span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">5</span>   </span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>V <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(p<span class="sc">*</span>p), <span class="at">nrow=</span>p) </span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>V_orth <span class="ot">&lt;-</span> <span class="fu">qr.Q</span>(<span class="fu">qr</span>(V))  <span class="co"># 正交化（确保特征向量正交）</span></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> V_orth <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>)) <span class="sc">%*%</span> <span class="fu">t</span>(V_orth)  <span class="co"># 协方差矩阵</span></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="at">n =</span> n, <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, p), <span class="at">Sigma =</span> Sigma)</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模拟的五维数据维度：&quot;</span>, <span class="fu">dim</span>(X), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>) </span></code></pre></div>
<p>模拟的五维数据维度： 100 5</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>sigma_hat_mle <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">*</span> <span class="fu">cov</span>(X) </span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>eigen_hat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma_hat_mle)<span class="sc">$</span>values</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>eigen_hat_sorted <span class="ot">&lt;-</span> <span class="fu">sort</span>(eigen_hat, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a>lambda1_hat <span class="ot">&lt;-</span> eigen_hat_sorted[<span class="dv">1</span>] </span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>sum_lambda_hat <span class="ot">&lt;-</span> <span class="fu">sum</span>(eigen_hat_sorted)</span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> lambda1_hat <span class="sc">/</span> sum_lambda_hat</span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;θ的样本估计θ̂：&quot;</span>, theta_hat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>θ的样本估计θ̂： 0.3026818</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>theta_boot_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>  boot_sample <span class="ot">&lt;-</span> data[indices, ] </span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>  n_boot <span class="ot">&lt;-</span> <span class="fu">nrow</span>(boot_sample)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>  </span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>  sigma_boot_mle <span class="ot">&lt;-</span> (n_boot <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>n_boot <span class="sc">*</span> <span class="fu">cov</span>(boot_sample)</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>  </span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>  eigen_boot <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma_boot_mle)<span class="sc">$</span>values</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>  eigen_boot_sorted <span class="ot">&lt;-</span> <span class="fu">sort</span>(eigen_boot, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>  </span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>  lambda1_boot <span class="ot">&lt;-</span> eigen_boot_sorted[<span class="dv">1</span>]</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>  sum_lambda_boot <span class="ot">&lt;-</span> <span class="fu">sum</span>(eigen_boot_sorted)</span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>  theta_star <span class="ot">&lt;-</span> lambda1_boot <span class="sc">/</span> sum_lambda_boot</span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>  <span class="fu">return</span>(theta_star)</span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>}</span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8877</span>)  </span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a>boot_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(</span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a>  <span class="at">data =</span> X,        </span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a>  <span class="at">statistic =</span> theta_boot_stat, </span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a>  <span class="at">R =</span> <span class="dv">10000</span>        </span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a>)</span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a></span>
<span id="cb43-23"><a href="#cb43-23" tabindex="-1"></a>bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_result<span class="sc">$</span>t) <span class="sc">-</span> boot_result<span class="sc">$</span>t0  </span>
<span id="cb43-24"><a href="#cb43-24" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_result<span class="sc">$</span>t)               </span>
<span id="cb43-25"><a href="#cb43-25" tabindex="-1"></a></span>
<span id="cb43-26"><a href="#cb43-26" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap偏差估计：&quot;</span>, bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>Bootstrap偏差估计： 0.04338784</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap标准误估计：&quot;</span>, se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>Bootstrap标准误估计： 0.02643717</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">print</span>(boot_result)</span></code></pre></div>
<p>ORDINARY NONPARAMETRIC BOOTSTRAP</p>
<p>Call: boot(data = X, statistic = theta_boot_stat, R = 10000)</p>
<p>Bootstrap Statistics : original bias std. error t1* 0.3026818
0.04338784 0.02643717</p>
</div>
<div id="结果分析-17" class="section level3">
<h3>3.3 结果分析</h3>
<p>Bootstrap 结果显示，原始估计<span class="math inline">\(\hat{\theta}\)</span>存在轻微的低估偏差（偏差约
0.0438），但偏差程度在可接受范围内；估计的标准误较小（约
2.61%），说明<span class="math inline">\(\hat{\theta}\)</span>的抽样稳定性较好，整体估计结果可靠。</p>
</div>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>Exercises 8.8, 8.11, 8.A (page 241, Statistical Computing with R, 2nd
edition).</p>
<p>Suppose the population has the exponential distribution with rate
<span class="math inline">\(\lambda\)</span>, then the MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat\lambda=1\big/\bar X,\)</span> where <span class="math inline">\(\bar X\)</span> is the sample mean. It can be
derived that the expectation of <span class="math inline">\(\hat\lambda\)</span> is <span class="math inline">\(\mathbb{E}[\hat\lambda\,]=\frac{n\lambda}{n-1},\)</span>
so that the estimation bias is <span class="math inline">\(\text{Bias}(\hat\lambda)=\frac{\lambda}{n-1}.\)</span>
The standard error of <span class="math inline">\(\hat\lambda\)</span>
is <span class="math inline">\(\text{SE}(\hat\lambda)=\frac{\lambda\,n}{(n-1)\sqrt{n-2}}.\)</span>
Conduct a simulation study to verify the performance of the bootstrap
method.</p>
<p>The true value of <span class="math inline">\(\lambda=2\)</span>.</p>
<p>The sample size <span class="math inline">\(n=5,10,20\)</span>.</p>
<p>The number of bootstrap replicates <span class="math inline">\(B=1000\)</span>.</p>
<p>Repeat simulations for <span class="math inline">\(m=1000\)</span>
times.</p>
<p>Compare the mean bootstrap bias and bootstrap standard error with the
theoretical ones. Comment on the results.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
</div>
<div id="问题一8.8" class="section level2">
<h2>1 问题一（8.8）</h2>
<p> Refer to Exercise 8.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat\lambda\)</span>.</p>
<div id="问题分析-15" class="section level3">
<h3>1.1 问题分析</h3>
<p>该问题需要利用Jackknife（刀切法）来估计<span class="math inline">\(\hat{\lambda}\)</span>的偏差和标准误。 Jackknife
的核心是通过依次删除每个观测值，生成 “伪值（jackknife
replicates）”，再基于伪值推导偏差和标准误：全样本估计：计算全样本的<span class="math inline">\(\hat{\lambda}\)</span>，记为<span class="math inline">\(\lambda_{\text{full}}\)</span>。生成伪值：对每个<span class="math inline">\(i=1,2,\dots,n\)</span>（n为样本量），删除第i个观测，计算剩余样本的<span class="math inline">\(\hat{\lambda}\)</span>，记为<span class="math inline">\(\lambda_{(i)}\)</span>。伪值定义为：<span class="math inline">\(\theta_i = n \cdot \lambda_{\text{full}} - (n-1)
\cdot \lambda_{(i)}\)</span>偏差估计：公式为<span class="math inline">\(\text{bias}_{\text{jack}} = (n-1) \cdot \left(
\bar{\theta}_{\text{jack}} - \lambda_{\text{full}}
\right)\)</span>其中<span class="math inline">\(\bar{\theta}_{\text{jack}} = \frac{1}{n}
\sum_{i=1}^n \theta_i\)</span>。标准误估计：公式为<span class="math inline">\(\text{se}_{\text{jack}} = \sqrt{(n-1) \cdot
\text{var}(\theta_{\text{jack}})}\)</span>其中<span class="math inline">\(\text{var}(\theta_{\text{jack}})\)</span>是伪值<span class="math inline">\(\theta_1, \theta_2, \dots,
\theta_n\)</span>的样本方差。</p>
</div>
<div id="编程实现-7" class="section level3">
<h3>1.2 编程实现</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10311588</span>)</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>patch_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(patch_data)</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>lambda_hat <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>  <span class="fu">mean</span>(data)</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>}</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>lambda_full <span class="ot">&lt;-</span> <span class="fu">lambda_hat</span>(patch_data)</span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a>theta_jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a>  data_leave_out <span class="ot">&lt;-</span> patch_data[<span class="sc">-</span>i] </span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a>  lambda_i <span class="ot">&lt;-</span> <span class="fu">lambda_hat</span>(data_leave_out) </span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a>  theta_jack[i] <span class="ot">&lt;-</span> n <span class="sc">*</span> lambda_full <span class="sc">-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> lambda_i </span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a>}</span>
<span id="cb46-18"><a href="#cb46-18" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" tabindex="-1"></a>bias_jack <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta_jack) <span class="sc">-</span> lambda_full)</span>
<span id="cb46-20"><a href="#cb46-20" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" tabindex="-1"></a>se_jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">mean</span>((theta_jack <span class="sc">-</span> <span class="fu">mean</span>(theta_jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb46-22"><a href="#cb46-22" tabindex="-1"></a></span>
<span id="cb46-23"><a href="#cb46-23" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Jackknife偏差估计: &quot;</span>, bias_jack, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>Jackknife偏差估计: 1.199041e-14</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Jackknife标准误估计: &quot;</span>, se_jack, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>Jackknife标准误估计: 1.162019</p>
</div>
<div id="结果分析-18" class="section level3">
<h3>1.3 结果分析</h3>
<p>偏差近乎为 0，说明<span class="math inline">\(\hat{\lambda}\)</span>无明显系统偏差，估计稳定性强；标准误有效反映了<span class="math inline">\(\hat{\lambda}\)</span>的抽样变异性，结果符合
Jackknife 方法的数学逻辑。</p>
</div>
</div>
<div id="问题二8.11" class="section level2">
<h2>2 问题二（8.11）</h2>
<p> In Example 8.17, leave-one-out (<span class="math inline">\(n\)</span>-fold) cross-validation was used to
select the best fitting model. Use leave-two-out cross-validation to
compare the models.</p>
<div id="问题分析-16" class="section level3">
<h3>2.1 问题分析</h3>
<p>需要基于 “留二法交叉验证” 重新评估 Example 8.17
中的四个模型，计算每个模型的平均预测误差（如均方误差
MSE），并根据误差大小选择最优模型。</p>
<p>留二法是留一法的扩展：每次从数据中删除 2 个观测，用剩余的<span class="math inline">\(n-2\)</span>个观测拟合模型；用拟合的模型预测被删除的
2 个观测，计算预测误差；遍历所有可能的 “删除 2 个观测”
的组合（组合数为<span class="math inline">\(\binom{n}{2} =
\frac{n(n-1)}{2}\)</span>）；最终计算每个模型的平均平方误差（MSE），MSE
最小的模型为最优。</p>
</div>
<div id="编程实现-8" class="section level3">
<h3>2.2 编程实现</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">data</span>(ironslag)</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>magnetic <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>chemical <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>chemical</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">choose</span>(n, <span class="dv">2</span>))</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>  <span class="cf">for</span> (l <span class="cf">in</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a>    train_y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span><span class="fu">c</span>(k, l)]</span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a>    train_x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span><span class="fu">c</span>(k, l)]</span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a>    </span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a>    <span class="co">#模型1</span></span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a>    model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(train_y <span class="sc">~</span> train_x)</span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a>    yhat1_k <span class="ot">&lt;-</span> <span class="fu">coef</span>(model1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(model1)[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb51-17"><a href="#cb51-17" tabindex="-1"></a>    yhat1_l <span class="ot">&lt;-</span> <span class="fu">coef</span>(model1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(model1)[<span class="dv">2</span>] <span class="sc">*</span> chemical[l]</span>
<span id="cb51-18"><a href="#cb51-18" tabindex="-1"></a>    e1[idx] <span class="ot">&lt;-</span> (magnetic[k] <span class="sc">-</span> yhat1_k)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (magnetic[l] <span class="sc">-</span> yhat1_l)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb51-19"><a href="#cb51-19" tabindex="-1"></a>    </span>
<span id="cb51-20"><a href="#cb51-20" tabindex="-1"></a>    <span class="co">#模型2</span></span>
<span id="cb51-21"><a href="#cb51-21" tabindex="-1"></a>    model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(train_y <span class="sc">~</span> train_x <span class="sc">+</span> <span class="fu">I</span>(train_x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb51-22"><a href="#cb51-22" tabindex="-1"></a>    yhat2_k <span class="ot">&lt;-</span> <span class="fu">coef</span>(model2)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(model2)[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> <span class="fu">coef</span>(model2)[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb51-23"><a href="#cb51-23" tabindex="-1"></a>    yhat2_l <span class="ot">&lt;-</span> <span class="fu">coef</span>(model2)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(model2)[<span class="dv">2</span>] <span class="sc">*</span> chemical[l] <span class="sc">+</span> <span class="fu">coef</span>(model2)[<span class="dv">3</span>] <span class="sc">*</span> chemical[l]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb51-24"><a href="#cb51-24" tabindex="-1"></a>    e2[idx] <span class="ot">&lt;-</span> (magnetic[k] <span class="sc">-</span> yhat2_k)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (magnetic[l] <span class="sc">-</span> yhat2_l)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb51-25"><a href="#cb51-25" tabindex="-1"></a>    </span>
<span id="cb51-26"><a href="#cb51-26" tabindex="-1"></a>    <span class="co">#模型3</span></span>
<span id="cb51-27"><a href="#cb51-27" tabindex="-1"></a>    model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(train_y) <span class="sc">~</span> train_x)</span>
<span id="cb51-28"><a href="#cb51-28" tabindex="-1"></a>    logyhat3_k <span class="ot">&lt;-</span> <span class="fu">coef</span>(model3)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(model3)[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb51-29"><a href="#cb51-29" tabindex="-1"></a>    yhat3_k <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3_k)</span>
<span id="cb51-30"><a href="#cb51-30" tabindex="-1"></a>    logyhat3_l <span class="ot">&lt;-</span> <span class="fu">coef</span>(model3)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(model3)[<span class="dv">2</span>] <span class="sc">*</span> chemical[l]</span>
<span id="cb51-31"><a href="#cb51-31" tabindex="-1"></a>    yhat3_l <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3_l)</span>
<span id="cb51-32"><a href="#cb51-32" tabindex="-1"></a>    e3[idx] <span class="ot">&lt;-</span> (magnetic[k] <span class="sc">-</span> yhat3_k)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (magnetic[l] <span class="sc">-</span> yhat3_l)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb51-33"><a href="#cb51-33" tabindex="-1"></a>    </span>
<span id="cb51-34"><a href="#cb51-34" tabindex="-1"></a>    <span class="co">#模型4</span></span>
<span id="cb51-35"><a href="#cb51-35" tabindex="-1"></a>    model4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(train_y) <span class="sc">~</span> <span class="fu">log</span>(train_x))</span>
<span id="cb51-36"><a href="#cb51-36" tabindex="-1"></a>    logyhat4_k <span class="ot">&lt;-</span> <span class="fu">coef</span>(model4)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(model4)[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k])</span>
<span id="cb51-37"><a href="#cb51-37" tabindex="-1"></a>    yhat4_k <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4_k)</span>
<span id="cb51-38"><a href="#cb51-38" tabindex="-1"></a>    logyhat4_l <span class="ot">&lt;-</span> <span class="fu">coef</span>(model4)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(model4)[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[l])</span>
<span id="cb51-39"><a href="#cb51-39" tabindex="-1"></a>    yhat4_l <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4_l)</span>
<span id="cb51-40"><a href="#cb51-40" tabindex="-1"></a>    e4[idx] <span class="ot">&lt;-</span> (magnetic[k] <span class="sc">-</span> yhat4_k)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (magnetic[l] <span class="sc">-</span> yhat4_l)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb51-41"><a href="#cb51-41" tabindex="-1"></a>    </span>
<span id="cb51-42"><a href="#cb51-42" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> idx <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb51-43"><a href="#cb51-43" tabindex="-1"></a>  }</span>
<span id="cb51-44"><a href="#cb51-44" tabindex="-1"></a>}</span>
<span id="cb51-45"><a href="#cb51-45" tabindex="-1"></a></span>
<span id="cb51-46"><a href="#cb51-46" tabindex="-1"></a>mse1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(e1)</span>
<span id="cb51-47"><a href="#cb51-47" tabindex="-1"></a>mse2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(e2)</span>
<span id="cb51-48"><a href="#cb51-48" tabindex="-1"></a>mse3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(e3)</span>
<span id="cb51-49"><a href="#cb51-49" tabindex="-1"></a>mse4 <span class="ot">&lt;-</span> <span class="fu">mean</span>(e4)</span>
<span id="cb51-50"><a href="#cb51-50" tabindex="-1"></a></span>
<span id="cb51-51"><a href="#cb51-51" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;四个模型的留二法MSE：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>四个模型的留二法MSE：</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模型1（线性）：&quot;</span>, mse1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>模型1（线性）： 39.14455</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模型2（二次）：&quot;</span>, mse2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>模型2（二次）： 35.74037</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模型3（对数线性）：&quot;</span>, mse3, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>模型3（对数线性）： 36.90983</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模型4（双对数）：&quot;</span>, mse4, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>模型4（双对数）： 40.93436</p>
</div>
<div id="结果分析-19" class="section level3">
<h3>2.3 结果分析</h3>
<p>在 Example 8.17 的留一法交叉验证中，模型 2 的 MSE
也是最小的（17.85）。本次留二法的结果与其结论一致，进一步验证了二次模型是该数据集的最佳拟合模型，说明模型选择具有稳定性。</p>
</div>
</div>
<div id="问题三8.a" class="section level2">
<h2>3 问题三（8.A）</h2>
<p> Conduct a Monte Carlo study to estimate the coverage probabilities
of the standard normal bootstrap confidence interval, the basic
bootstrap confidence interval, and the percentile confidence interval.
Sample from a normal population and check the empirical coverage rates
for the sample mean. Find the proportion of times that the confidence
intervals miss on the left, and the proportion of times that the
confidence intervals miss on the right.</p>
<div id="问题分析-17" class="section level3">
<h3>3.1 问题分析</h3>
<p>需要通过蒙特卡洛模拟来估计三种自助法（Bootstrap）置信区间的覆盖概率，以及它们在左侧和右侧的失误比例。</p>
<p>从正态总体中抽样，针对样本均值这一统计量，进行蒙特卡洛模拟。
估计三种自助置信区间的覆盖概率（即置信区间包含真实参数的频率）：
标准正态自助置信区间（Normal Bootstrap CI） 基本自助置信区间（Basic
Bootstrap CI） 分位数自助置信区间（Percentile Bootstrap CI）
计算每个置信区间左侧失误比例（真实值在区间左边的频率）和右侧失误比例（真实值在区间右边的频率）。</p>
</div>
<div id="编程实现-9" class="section level3">
<h3>3.2 编程实现</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1031158</span>)  </span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span>     </span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>       </span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span>    </span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>  </span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>)  </span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>cover_normal <span class="ot">&lt;-</span> cover_basic <span class="ot">&lt;-</span> cover_percentile <span class="ot">&lt;-</span> <span class="fu">logical</span>(M)</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>left_miss_normal <span class="ot">&lt;-</span> left_miss_basic <span class="ot">&lt;-</span> left_miss_percentile <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>right_miss_normal <span class="ot">&lt;-</span> right_miss_basic <span class="ot">&lt;-</span> right_miss_percentile <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a><span class="cf">for</span> (m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>  x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) </span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>  </span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>  theta_star <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, <span class="fu">mean</span>(<span class="fu">sample</span>(x, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a>  </span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>  se_star <span class="ot">&lt;-</span> <span class="fu">sd</span>(theta_star)</span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a>  ci_normal_lower <span class="ot">&lt;-</span> x_bar <span class="sc">-</span> z <span class="sc">*</span> se_star</span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a>  ci_normal_upper <span class="ot">&lt;-</span> x_bar <span class="sc">+</span> z <span class="sc">*</span> se_star</span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a>  </span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a>  q_lower <span class="ot">&lt;-</span> <span class="fu">quantile</span>(theta_star, alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a>  q_upper <span class="ot">&lt;-</span> <span class="fu">quantile</span>(theta_star, <span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb56-24"><a href="#cb56-24" tabindex="-1"></a>  ci_basic_lower <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> x_bar <span class="sc">-</span> q_upper</span>
<span id="cb56-25"><a href="#cb56-25" tabindex="-1"></a>  ci_basic_upper <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> x_bar <span class="sc">-</span> q_lower</span>
<span id="cb56-26"><a href="#cb56-26" tabindex="-1"></a>  </span>
<span id="cb56-27"><a href="#cb56-27" tabindex="-1"></a>  ci_percentile_lower <span class="ot">&lt;-</span> q_lower</span>
<span id="cb56-28"><a href="#cb56-28" tabindex="-1"></a>  ci_percentile_upper <span class="ot">&lt;-</span> q_upper</span>
<span id="cb56-29"><a href="#cb56-29" tabindex="-1"></a>  </span>
<span id="cb56-30"><a href="#cb56-30" tabindex="-1"></a>  cover_normal[m] <span class="ot">&lt;-</span> (<span class="dv">0</span> <span class="sc">&gt;=</span> ci_normal_lower) <span class="sc">&amp;</span> (<span class="dv">0</span> <span class="sc">&lt;=</span> ci_normal_upper)</span>
<span id="cb56-31"><a href="#cb56-31" tabindex="-1"></a>  left_miss_normal[m] <span class="ot">&lt;-</span> (<span class="dv">0</span> <span class="sc">&lt;</span> ci_normal_lower)</span>
<span id="cb56-32"><a href="#cb56-32" tabindex="-1"></a>  right_miss_normal[m] <span class="ot">&lt;-</span> (<span class="dv">0</span> <span class="sc">&gt;</span> ci_normal_upper)</span>
<span id="cb56-33"><a href="#cb56-33" tabindex="-1"></a>  </span>
<span id="cb56-34"><a href="#cb56-34" tabindex="-1"></a>  cover_basic[m] <span class="ot">&lt;-</span> (<span class="dv">0</span> <span class="sc">&gt;=</span> ci_basic_lower) <span class="sc">&amp;</span> (<span class="dv">0</span> <span class="sc">&lt;=</span> ci_basic_upper)</span>
<span id="cb56-35"><a href="#cb56-35" tabindex="-1"></a>  left_miss_basic[m] <span class="ot">&lt;-</span> (<span class="dv">0</span> <span class="sc">&lt;</span> ci_basic_lower)</span>
<span id="cb56-36"><a href="#cb56-36" tabindex="-1"></a>  right_miss_basic[m] <span class="ot">&lt;-</span> (<span class="dv">0</span> <span class="sc">&gt;</span> ci_basic_upper)</span>
<span id="cb56-37"><a href="#cb56-37" tabindex="-1"></a>  </span>
<span id="cb56-38"><a href="#cb56-38" tabindex="-1"></a>  cover_percentile[m] <span class="ot">&lt;-</span> (<span class="dv">0</span> <span class="sc">&gt;=</span> ci_percentile_lower) <span class="sc">&amp;</span> (<span class="dv">0</span> <span class="sc">&lt;=</span> ci_percentile_upper)</span>
<span id="cb56-39"><a href="#cb56-39" tabindex="-1"></a>  left_miss_percentile[m] <span class="ot">&lt;-</span> (<span class="dv">0</span> <span class="sc">&lt;</span> ci_percentile_lower)</span>
<span id="cb56-40"><a href="#cb56-40" tabindex="-1"></a>  right_miss_percentile[m] <span class="ot">&lt;-</span> (<span class="dv">0</span> <span class="sc">&gt;</span> ci_percentile_upper)</span>
<span id="cb56-41"><a href="#cb56-41" tabindex="-1"></a>}</span>
<span id="cb56-42"><a href="#cb56-42" tabindex="-1"></a></span>
<span id="cb56-43"><a href="#cb56-43" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb56-44"><a href="#cb56-44" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">&quot;标准正态自助区间&quot;</span>, <span class="st">&quot;基本自助区间&quot;</span>, <span class="st">&quot;分位数自助区间&quot;</span>),</span>
<span id="cb56-45"><a href="#cb56-45" tabindex="-1"></a>  <span class="at">Coverage =</span> <span class="fu">c</span>(<span class="fu">mean</span>(cover_normal), <span class="fu">mean</span>(cover_basic), <span class="fu">mean</span>(cover_percentile)),</span>
<span id="cb56-46"><a href="#cb56-46" tabindex="-1"></a>  <span class="at">Left_Miss =</span> <span class="fu">c</span>(<span class="fu">mean</span>(left_miss_normal), <span class="fu">mean</span>(left_miss_basic), <span class="fu">mean</span>(left_miss_percentile)),</span>
<span id="cb56-47"><a href="#cb56-47" tabindex="-1"></a>  <span class="at">Right_Miss =</span> <span class="fu">c</span>(<span class="fu">mean</span>(right_miss_normal), <span class="fu">mean</span>(right_miss_basic), <span class="fu">mean</span>(right_miss_percentile))</span>
<span id="cb56-48"><a href="#cb56-48" tabindex="-1"></a>)</span>
<span id="cb56-49"><a href="#cb56-49" tabindex="-1"></a></span>
<span id="cb56-50"><a href="#cb56-50" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>        Method Coverage Left_Miss Right_Miss</code></pre>
<p>1 标准正态自助区间 0.924 0.035 0.041 2 基本自助区间 0.921 0.037 0.042
3 分位数自助区间 0.917 0.037 0.046</p>
</div>
<div id="结果分析-20" class="section level3">
<h3>3.3 结果分析</h3>
<p>三种自助置信区间在 “正态总体小样本（n=20）+ 样本均值”
场景下，实际覆盖概率（91.7%~92.4%）虽低于 95%
名义水平，但差距在可接受范围内（2~3
个百分点），且无严重偏倚，整体表现稳健。</p>
</div>
</div>
<div id="问题四" class="section level2">
<h2>4 问题四</h2>
<p>Suppose the population has the exponential distribution with rate
<span class="math inline">\(\lambda\)</span>, then the MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat\lambda=1\big/\bar X,\)</span> where <span class="math inline">\(\bar X\)</span> is the sample mean. It can be
derived that the expectation of <span class="math inline">\(\hat\lambda\)</span> is <span class="math inline">\(\mathbb{E}[\hat\lambda\,]=\frac{n\lambda}{n-1},\)</span>
so that the estimation bias is <span class="math inline">\(\text{Bias}(\hat\lambda)=\frac{\lambda}{n-1}.\)</span>
The standard error of <span class="math inline">\(\hat\lambda\)</span>
is <span class="math inline">\(\text{SE}(\hat\lambda)=\frac{\lambda\,n}{(n-1)\sqrt{n-2}}.\)</span>
Conduct a simulation study to verify the performance of the bootstrap
method.</p>
<p>The true value of <span class="math inline">\(\lambda=2\)</span>.</p>
<p>The sample size <span class="math inline">\(n=5,10,20\)</span>.</p>
<p>The number of bootstrap replicates <span class="math inline">\(B=1000\)</span>.</p>
<p>Repeat simulations for <span class="math inline">\(m=1000\)</span>
times.</p>
<p>Compare the mean bootstrap bias and bootstrap standard error with the
theoretical ones. Comment on the results.</p>
<div id="问题分析-18" class="section level3">
<h3>4.1 问题分析</h3>
<p>需通过蒙特卡洛模拟 + Bootstrap 重抽样，针对指数分布（λ=2）的 MLE
估计量<span class="math inline">\(\hat{\lambda}=1/\bar{X}\)</span>，在 3
种样本量（n=5,10,20）下，验证 Bootstrap
方法估计的平均偏差和平均标准误与理论值的一致性，最终分析样本量对
Bootstrap 估计精度的影响。</p>
</div>
<div id="编程实现-10" class="section level3">
<h3>4.2 编程实现</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1031151027</span>) </span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>lambda_true <span class="ot">&lt;-</span> <span class="dv">2</span>   </span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>n_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)  </span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span>          </span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span>         </span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>  样本量<span class="at">n =</span> <span class="fu">integer</span>(),</span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>  理论偏差 <span class="ot">=</span> <span class="fu">numeric</span>(),</span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>  平均Bootstrap偏差 <span class="ot">=</span> <span class="fu">numeric</span>(),</span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>  理论标准误 <span class="ot">=</span> <span class="fu">numeric</span>(),</span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>  平均Bootstrap标准误 <span class="ot">=</span> <span class="fu">numeric</span>()</span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a>)</span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a></span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> n_list) {</span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a>  theo_bias <span class="ot">&lt;-</span> lambda_true <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>) </span>
<span id="cb58-18"><a href="#cb58-18" tabindex="-1"></a>  theo_se <span class="ot">&lt;-</span> (lambda_true <span class="sc">*</span> n) <span class="sc">/</span> ((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(n <span class="sc">-</span> <span class="dv">2</span>)) </span>
<span id="cb58-19"><a href="#cb58-19" tabindex="-1"></a>  </span>
<span id="cb58-20"><a href="#cb58-20" tabindex="-1"></a>  boot_bias_vec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb58-21"><a href="#cb58-21" tabindex="-1"></a>  boot_se_vec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb58-22"><a href="#cb58-22" tabindex="-1"></a>  </span>
<span id="cb58-23"><a href="#cb58-23" tabindex="-1"></a>  <span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb58-24"><a href="#cb58-24" tabindex="-1"></a>    x_obs <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="at">n =</span> n, <span class="at">rate =</span> lambda_true)  </span>
<span id="cb58-25"><a href="#cb58-25" tabindex="-1"></a>    lambda_obs <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(x_obs)             </span>
<span id="cb58-26"><a href="#cb58-26" tabindex="-1"></a>    </span>
<span id="cb58-27"><a href="#cb58-27" tabindex="-1"></a>    lambda_boot <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, {</span>
<span id="cb58-28"><a href="#cb58-28" tabindex="-1"></a>      x_boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(x_obs, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb58-29"><a href="#cb58-29" tabindex="-1"></a>      <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(x_boot)                                  </span>
<span id="cb58-30"><a href="#cb58-30" tabindex="-1"></a>    })</span>
<span id="cb58-31"><a href="#cb58-31" tabindex="-1"></a>    </span>
<span id="cb58-32"><a href="#cb58-32" tabindex="-1"></a>    boot_bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(lambda_boot) <span class="sc">-</span> lambda_obs  </span>
<span id="cb58-33"><a href="#cb58-33" tabindex="-1"></a>    boot_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(lambda_boot)                   </span>
<span id="cb58-34"><a href="#cb58-34" tabindex="-1"></a>    </span>
<span id="cb58-35"><a href="#cb58-35" tabindex="-1"></a>    boot_bias_vec[sim] <span class="ot">&lt;-</span> boot_bias</span>
<span id="cb58-36"><a href="#cb58-36" tabindex="-1"></a>    boot_se_vec[sim] <span class="ot">&lt;-</span> boot_se</span>
<span id="cb58-37"><a href="#cb58-37" tabindex="-1"></a>  }</span>
<span id="cb58-38"><a href="#cb58-38" tabindex="-1"></a>  </span>
<span id="cb58-39"><a href="#cb58-39" tabindex="-1"></a>  mean_boot_bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_bias_vec)</span>
<span id="cb58-40"><a href="#cb58-40" tabindex="-1"></a>  mean_boot_se <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_se_vec)</span>
<span id="cb58-41"><a href="#cb58-41" tabindex="-1"></a>  </span>
<span id="cb58-42"><a href="#cb58-42" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result, <span class="fu">data.frame</span>(</span>
<span id="cb58-43"><a href="#cb58-43" tabindex="-1"></a>    样本量<span class="at">n =</span> n,</span>
<span id="cb58-44"><a href="#cb58-44" tabindex="-1"></a>    理论偏差 <span class="ot">=</span> <span class="fu">round</span>(theo_bias, <span class="dv">4</span>),</span>
<span id="cb58-45"><a href="#cb58-45" tabindex="-1"></a>    平均Bootstrap偏差 <span class="ot">=</span> <span class="fu">round</span>(mean_boot_bias, <span class="dv">4</span>),</span>
<span id="cb58-46"><a href="#cb58-46" tabindex="-1"></a>    理论标准误 <span class="ot">=</span> <span class="fu">round</span>(theo_se, <span class="dv">4</span>),</span>
<span id="cb58-47"><a href="#cb58-47" tabindex="-1"></a>    平均Bootstrap标准误 <span class="ot">=</span> <span class="fu">round</span>(mean_boot_se, <span class="dv">4</span>)</span>
<span id="cb58-48"><a href="#cb58-48" tabindex="-1"></a>  ))</span>
<span id="cb58-49"><a href="#cb58-49" tabindex="-1"></a>}</span>
<span id="cb58-50"><a href="#cb58-50" tabindex="-1"></a></span>
<span id="cb58-51"><a href="#cb58-51" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;不同样本量下理论值与Bootstrap估计值对比：&quot;</span>)</span></code></pre></div>
<p>[1] “不同样本量下理论值与Bootstrap估计值对比：”</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<p>样本量n 理论偏差 平均Bootstrap偏差 理论标准误 平均Bootstrap标准误 1 5
0.5000 0.5674 1.4434 2.2247 2 10 0.2222 0.2165 0.7857 0.8135 3 20 0.1053
0.1021 0.4962 0.4990</p>
</div>
<div id="结果分析-21" class="section level3">
<h3>4.3 结果分析</h3>
<p>在指数分布<span class="math inline">\(\lambda\)</span>的 MLE
估计中，Bootstrap 方法的性能高度依赖样本量，当<span class="math inline">\(n\geq10\)</span>时，其能精准估计偏差和标准误；<span class="math inline">\(n=20\)</span>时，可完全替代理论计算，验证了该方法在参数估计性能评估中的实用价值。</p>
</div>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>Exercises 10.3, 10.7 (page 295-296, Statistical Computing with R, 2nd
edition).</p>
<p>prove that the stationary distribution of the Metropolis-Hastings
(M-H) sampler with proposal distribution <span class="math inline">\(g(r
| s)\)</span> is the target distribution <span class="math inline">\(f(x)\)</span> in the continuous case</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
</div>
<div id="问题一10.3" class="section level2">
<h2>1 问题一（10.3）</h2>
<p>Implement the two-sample Cramér-von Mises test for equal
distributions as a permutation test using (10.14). Apply the test to the
data in Examples 10.1 and 10.2.</p>
<div id="问题分析-19" class="section level3">
<h3>1.1 问题分析</h3>
<p>需要实现两样本 Cramér-von Mises 检验的置换检验，并将其应用到 Example
10.1 和 10.2 的数据中。</p>
</div>
<div id="编程实现-11" class="section level3">
<h3>1.2 编程实现</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>cramer_von_mises_two_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>  N <span class="ot">&lt;-</span> n <span class="sc">+</span> m</span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(x, y)) </span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a>  Fn <span class="ot">&lt;-</span> <span class="fu">sapply</span>(combined, <span class="cf">function</span>(z) <span class="fu">mean</span>(x <span class="sc">&lt;=</span> z))</span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>  Gm <span class="ot">&lt;-</span> <span class="fu">sapply</span>(combined, <span class="cf">function</span>(z) <span class="fu">mean</span>(y <span class="sc">&lt;=</span> z))</span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>  T <span class="ot">&lt;-</span> (n <span class="sc">*</span> m <span class="sc">/</span> N<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sum</span>((Fn <span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a>  <span class="fu">return</span>(T)</span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a>}</span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a></span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a>permutation_cramer <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">B =</span> <span class="dv">1000</span>) {</span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a></span>
<span id="cb60-19"><a href="#cb60-19" tabindex="-1"></a>  T_original <span class="ot">&lt;-</span> <span class="fu">cramer_von_mises_two_sample</span>(x, y)</span>
<span id="cb60-20"><a href="#cb60-20" tabindex="-1"></a></span>
<span id="cb60-21"><a href="#cb60-21" tabindex="-1"></a>  T_perms <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb60-22"><a href="#cb60-22" tabindex="-1"></a>  <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb60-23"><a href="#cb60-23" tabindex="-1"></a>    perm <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined) </span>
<span id="cb60-24"><a href="#cb60-24" tabindex="-1"></a>    x_perm <span class="ot">&lt;-</span> perm[<span class="dv">1</span><span class="sc">:</span>n]       </span>
<span id="cb60-25"><a href="#cb60-25" tabindex="-1"></a>    y_perm <span class="ot">&lt;-</span> perm[(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n<span class="sc">+</span>m)]</span>
<span id="cb60-26"><a href="#cb60-26" tabindex="-1"></a>    T_perms[b] <span class="ot">&lt;-</span> <span class="fu">cramer_von_mises_two_sample</span>(x_perm, y_perm)</span>
<span id="cb60-27"><a href="#cb60-27" tabindex="-1"></a>  }</span>
<span id="cb60-28"><a href="#cb60-28" tabindex="-1"></a>  p_val <span class="ot">&lt;-</span> (<span class="fu">sum</span>(T_perms <span class="sc">&gt;=</span> T_original) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> (B <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb60-29"><a href="#cb60-29" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb60-30"><a href="#cb60-30" tabindex="-1"></a>    <span class="at">T_original =</span> T_original, </span>
<span id="cb60-31"><a href="#cb60-31" tabindex="-1"></a>    <span class="at">T_perms =</span> T_perms, </span>
<span id="cb60-32"><a href="#cb60-32" tabindex="-1"></a>    <span class="at">p_value =</span> p_val</span>
<span id="cb60-33"><a href="#cb60-33" tabindex="-1"></a>  ))</span>
<span id="cb60-34"><a href="#cb60-34" tabindex="-1"></a>}</span>
<span id="cb60-35"><a href="#cb60-35" tabindex="-1"></a></span>
<span id="cb60-36"><a href="#cb60-36" tabindex="-1"></a></span>
<span id="cb60-37"><a href="#cb60-37" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.3</span>, <span class="fl">2.1</span>, <span class="fl">2.8</span>)</span>
<span id="cb60-38"><a href="#cb60-38" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">1.5</span>, <span class="fl">2.3</span>, <span class="fl">3.0</span>)</span>
<span id="cb60-39"><a href="#cb60-39" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">permutation_cramer</span>(x1, y1, <span class="at">B =</span> <span class="dv">1000</span>)</span>
<span id="cb60-40"><a href="#cb60-40" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Example 10.1的p值：&quot;</span>, result1<span class="sc">$</span>p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>Example 10.1的p值： 1</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.3</span>, <span class="fl">2.1</span>)</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">1.5</span>, <span class="fl">2.3</span>, <span class="fl">3.0</span>, <span class="fl">3.5</span>)</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">permutation_cramer</span>(x2, y2, <span class="at">B =</span> <span class="dv">1000</span>)</span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Example 10.2的p值：&quot;</span>, result2<span class="sc">$</span>p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>Example 10.2的p值： 0.2947053</p>
</div>
<div id="结果分析-22" class="section level3">
<h3>1.3 结果分析</h3>
<p>Example 10.1 结果分析 p 值 = 1： 在 1000 次置换中，没有一次置换后的
Cramér-von Mises 统计量大于或等于原始样本的统计量。这说明在
“两个样本来自同一分布”
的原假设下，观察到当前样本差异的概率极高，因此不拒绝原假设，认为这两个样本大概率来自相同的分布。</p>
<p>Example 10.2 结果分析 p 值 = 0.3047： 在 1000 次置换中，约有 30.47%
的置换后统计量大于或等于原始样本的统计量。由于 p
值大于常用的显著性水平（如
0.05），因此没有足够的统计证据拒绝原假设，即无法认为这两个样本的分布存在显著差异。</p>
<p>两个例子的 p 值均未小于显著性水平（如 0.05），因此在统计上都不拒绝
“两个样本来自相同分布”
的原假设，即没有足够证据表明两个样本的分布存在显著差异</p>
</div>
</div>
<div id="问题二10.7" class="section level2">
<h2>2 问题二（10.7）</h2>
<p>The Count 5 test for equal variances} in Section 7.4 is based on the
maximum number of extreme points. Example 7.15 shows that the Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily equal.
Repeat Example 7.15 using the permutation test.</p>
<div id="问题分析-20" class="section level3">
<h3>2.1 问题分析</h3>
<p>基于 “最大极值点数”
的方差齐性置换检验（适配样本量不等的情况），并重复 Example 7.15
的模拟过程。</p>
<p>通过极值点数量判断方差是否相等，并针对样本量不等的场景，用置换检验进行适配；重复
Example 7.15 的模拟：生成两个样本量不等（<span class="math inline">\(n_1=20,
n_2=30\)</span>）、方差相等的正态样本，通过置换检验估计其经验第一类错误率（原假设为真时拒绝原假设的概率）</p>
<p>原 Count 5 检验的拒绝准则是：若该统计量≥5，则拒绝 “方差相等”
的原假设。
置换检验的适配逻辑：在原假设（方差相等）下，两个样本的观测可视为来自同一分布的
“混合样本”。通过随机置换混合样本的分组，生成大量置换后的统计量，进而估计
“统计量≥5” 的概率（即经验第一类错误率）。</p>
</div>
<div id="编程实现-12" class="section level3">
<h3>2.2 编程实现</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>count5_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>  max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(y)</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>  min_y <span class="ot">&lt;-</span> <span class="fu">min</span>(y)</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>  count_x <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">&gt;</span> max_y <span class="sc">|</span> x <span class="sc">&lt;</span> min_y) </span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>  max_x <span class="ot">&lt;-</span> <span class="fu">max</span>(x)</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>  min_x <span class="ot">&lt;-</span> <span class="fu">min</span>(x)</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>  count_y <span class="ot">&lt;-</span> <span class="fu">sum</span>(y <span class="sc">&gt;</span> max_x <span class="sc">|</span> y <span class="sc">&lt;</span> min_x) </span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>  <span class="fu">max</span>(count_x, count_y)                 </span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>}</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span>      </span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb62-15"><a href="#cb62-15" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>           </span>
<span id="cb62-16"><a href="#cb62-16" tabindex="-1"></a></span>
<span id="cb62-17"><a href="#cb62-17" tabindex="-1"></a>alphahat_perm <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr =</span> {</span>
<span id="cb62-18"><a href="#cb62-18" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb62-19"><a href="#cb62-19" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb62-20"><a href="#cb62-20" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb62-21"><a href="#cb62-21" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb62-22"><a href="#cb62-22" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb62-23"><a href="#cb62-23" tabindex="-1"></a>  perm <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined)  </span>
<span id="cb62-24"><a href="#cb62-24" tabindex="-1"></a>  x_perm <span class="ot">&lt;-</span> perm[<span class="dv">1</span><span class="sc">:</span>n1]     </span>
<span id="cb62-25"><a href="#cb62-25" tabindex="-1"></a>  y_perm <span class="ot">&lt;-</span> perm[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n1<span class="sc">+</span>n2)] </span>
<span id="cb62-26"><a href="#cb62-26" tabindex="-1"></a>  stat_perm <span class="ot">&lt;-</span> <span class="fu">count5_stat</span>(x_perm, y_perm)</span>
<span id="cb62-27"><a href="#cb62-27" tabindex="-1"></a>  stat_perm <span class="sc">&gt;=</span> <span class="dv">5</span></span>
<span id="cb62-28"><a href="#cb62-28" tabindex="-1"></a>}))</span>
<span id="cb62-29"><a href="#cb62-29" tabindex="-1"></a></span>
<span id="cb62-30"><a href="#cb62-30" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;置换检验下的经验第一类错误率：&quot;</span>, alphahat_perm, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>置换检验下的经验第一类错误率： 0.2538</p>
</div>
<div id="结果分析-23" class="section level3">
<h3>2.3 结果分析</h3>
<p>该结果表明，若直接沿用 “最大极值点数≥5”
的拒绝规则，即使使用置换检验适配样本量不等的情况，仍会有超过 25%
的概率错误拒绝 “方差相等” 的原假设。这意味着需要调整检验准则（例如降低
“≥5”
的阈值、优化极值点的定义方式等），才能在样本量不等时有效控制第一类错误率。
综上，置换检验解决了样本量不等的适配问题，但原拒绝准则的第一类错误率仍过高，需进一步优化检验规则以实现有效的错误率控制。</p>
</div>
</div>
<div id="问题三103115" class="section level2">
<h2>3 问题三（103115）</h2>
<p>prove that the stationary distribution of the Metropolis-Hastings
(M-H) sampler with proposal distribution <span class="math inline">\(g(r
| s)\)</span> is the target distribution <span class="math inline">\(f(x)\)</span> in the continuous case</p>
<div id="问题分析-21" class="section level3">
<h3>3.1 问题分析</h3>
<p>需要证明
Metropolis-Hastings（M-H）采样器在连续情形下，其平稳分布为目标分布<span class="math inline">\(f(x)\)</span>。属于马尔可夫链蒙特卡洛（MCMC）的理论证明。</p>
<p>M-H 算法的核心是构造一个马尔可夫链，使得其平稳分布等于目标分布<span class="math inline">\(f(x)\)</span>。要证明这一点，需验证细致平衡条件（Detailed
Balance Condition）：对任意状态<span class="math inline">\(x,
y\)</span>，满足<span class="math inline">\(f(x) \cdot P(x \to y) = f(y)
\cdot P(y \to x)\)</span>其中<span class="math inline">\(P(x \to
y)\)</span>是从状态x转移到y的概率。若满足细致平衡且马尔可夫链不可约、正常返，则平稳分布唯一且为<span class="math inline">\(f(x)\)</span>。</p>
</div>
<div id="证明过程" class="section level3">
<h3>3.2 证明过程</h3>
<p>1：明确 M-H 转移概率的构造M-H
采样的转移过程分为两步：提议阶段：从当前状态x，按提议分布<span class="math inline">\(g(y|x)\)</span>生成候选状态y。接受阶段：以接受概率<span class="math inline">\(\alpha(x, y) = \min\left\{ 1, \frac{f(y) \cdot
g(x|y)}{f(x) \cdot g(y|x)}
\right\}\)</span>决定是否接受y作为下一个状态。因此，从x到y（<span class="math inline">\(y \neq x\)</span>）的转移概率为：<span class="math inline">\(P(x \to y) = g(y|x) \cdot \alpha(x,
y)\)</span>自转移概率（停在x）为：<span class="math inline">\(P(x \to x)
= 1 - \int_{\mathbb{R} \setminus \{x\}} P(x \to z) dz\)</span></p>
<p>2：验证细致平衡条件<span class="math inline">\(f(x) \cdot P(x \to y)
= f(y) \cdot P(y \to x)\)</span>分两种情况讨论接受概率<span class="math inline">\(\alpha(x, y)\)</span>：</p>
<p>情况 1：<span class="math inline">\(\frac{f(y) \cdot g(x|y)}{f(x)
\cdot g(y|x)} \leq 1\)</span>此时<span class="math inline">\(\alpha(x,
y) = \frac{f(y) \cdot g(x|y)}{f(x) \cdot g(y|x)}\)</span>，因此：<span class="math inline">\(f(x) \cdot P(x \to y) = f(x) \cdot g(y|x) \cdot
\frac{f(y) \cdot g(x|y)}{f(x) \cdot g(y|x)} = f(y) \cdot
g(x|y)\)</span></p>
<p>情况 2：<span class="math inline">\(\frac{f(y) \cdot g(x|y)}{f(x)
\cdot g(y|x)} &gt; 1\)</span>此时<span class="math inline">\(\alpha(x,
y) = 1\)</span>，因此：<span class="math inline">\(f(x) \cdot P(x \to y)
= f(x) \cdot g(y|x) \cdot 1 = f(x) \cdot g(y|x)\)</span>对<span class="math inline">\(f(y) \cdot P(y \to x)\)</span>做对称分析：若<span class="math inline">\(\frac{f(x) \cdot g(y|x)}{f(y) \cdot g(x|y)} \leq
1\)</span>（即情况 2 的反向），则<span class="math inline">\(\alpha(y,
x) = \frac{f(x) \cdot g(y|x)}{f(y) \cdot g(x|y)}\)</span>，</p>
<p>因此：<span class="math inline">\(f(y) \cdot P(y \to x) = f(y) \cdot
g(x|y) \cdot \frac{f(x) \cdot g(y|x)}{f(y) \cdot g(x|y)} = f(x) \cdot
g(y|x)\)</span>若<span class="math inline">\(\frac{f(x) \cdot
g(y|x)}{f(y) \cdot g(x|y)} &gt; 1\)</span>（即情况 1 的反向），则<span class="math inline">\(\alpha(y, x) = 1\)</span>，因此：<span class="math inline">\(f(y) \cdot P(y \to x) = f(y) \cdot g(x|y) \cdot 1
= f(y) \cdot g(x|y)\)</span>可见，两种情况下均有<span class="math inline">\(f(x) \cdot P(x \to y) = f(y) \cdot P(y \to
x)\)</span>，即细致平衡条件成立。</p>
<p>3：结合马尔可夫链理论结论若马尔可夫链满足细致平衡条件，且是不可约、正常返的，则其平稳分布唯一，且就是满足细致平衡的分布<span class="math inline">\(f(x)\)</span>。对于 M-H
采样器构造的马尔可夫链，只要提议分布g能让链 “遍历”
所有状态（不可约），且长时间运行后能回到任意状态（正常返），则平稳分布唯一且为<span class="math inline">\(f(x)\)</span>。</p>
<p>综上，M-H 采样器的平稳分布是目标分布<span class="math inline">\(f(x)\)</span>，得证。</p>
</div>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>1、Exercises 11.6 and 11.10 (pages 334, Statistical Computing with R,
2nd edition).</p>
<p>2、For each of the above exercises, use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>.</p>
<p>3、Complete the homework assigned in class.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="问题一11.6" class="section level3">
<h3>1、问题一：11.6</h3>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain</p>
<div id="问题分析-22" class="section level4">
<h4>1.1 问题分析</h4>
<p>实现一个随机游走 Metropolis
采样器，用于生成标准拉普拉斯分布（也叫双指数分布）的样本。提议分布的增量来自正态分布，比较使用不同方差的提议分布时生成的采样链，并计算每条链的接受率。</p>
<p>标准拉普拉斯分布，概率密度函数为 <span class="math inline">\(f(x) =
\frac{1}{2}e^{-|x|}\)</span></p>
<p>从初始值 <span class="math inline">\(x_0\)</span> 开始，每次迭代通过
“提议分布” 生成候选点 <span class="math inline">\(x^*\)</span>；计算接受概率 <span class="math inline">\(\alpha = \min\left(1,
\frac{f(x^*)}{f(x_t)}\right)\)</span>（因提议分布对称，提议密度比为
1，可简化）；生成均匀随机数 <span class="math inline">\(u \sim
U(0,1)\)</span>，若 <span class="math inline">\(u \leq
\alpha\)</span> 则接受 <span class="math inline">\(x^*\)</span> 作为下一个状态 <span class="math inline">\(x_{t+1}\)</span>，否则 <span class="math inline">\(x_{t+1} = x_t\)</span>。</p>
<p>候选点 <span class="math inline">\(x^* = x_t +
\varepsilon\)</span>，其中 <span class="math inline">\(\varepsilon \sim
N(0, \sigma^2)\)</span>（<span class="math inline">\(\sigma^2\)</span> 为待测试的方差参数）。</p>
</div>
<div id="问题求解" class="section level4">
<h4>1.2 问题求解</h4>
<pre><code>## Installing package into &#39;C:/Users/91627/AppData/Local/Temp/RtmpsXbC80/temp_libpath64d46ad41a39&#39;
## (as &#39;lib&#39; is unspecified)</code></pre>
<p>package ‘gridExtra’ successfully unpacked and MD5 sums checked</p>
<p>The downloaded binary packages are in C:\916274yzua_packages</p>
<pre><code>## 
## Attaching package: &#39;gridExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAk1BMVEUAAAAAADoAAGYAAP8AOmYAOpAAZmYAZrY6AAA6ADo6AGY6OpA6ZpA6ZrY6kNtmAABmADpmAGZmOgBmOjpmOmZmOpBmZgBmtv+QOgCQOjqQOmaQZjqQkDqQ27aQ29uQ2/+2ZgC2Zjq2tma229u22/+2/7a2///bkDrbtmbb/9vb////tmb/25D/27b//7b//9v///+KtgKHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJNElEQVR4nO2dC1vjNhBFDX2QdlsCfbJ9hbZb0m6yIf//1zV2AsQjS1czGq3t5d5vNwGhnJEPju3YCmn2TDLN2AOYeigIhIJAKAiEgkAoCISCQCgIhIJAKAiEgkAoCISCQCgIhIJAKAikWND2u+bzd0/f3F8+lPJiqYg+snsL8pJSQY93V//dffG++/rDr02tpaiIPrHPF+Q8pYK2i+v9+mLVfrlbXiwqLUVF9BP7bEF6yRX04W3T5kq2b5qfu/9tpR/+vitcilgVBzRiny1IL5mCdsvLdx+WJ8HrrlJzffy65V4fez0WLkW0SjkasnsLcpZMQd1D1wOPdxUUreIgCLELBbUPf378uf/emlm6FNEqDoIQu/ApdvIfPr79wfO2zWkNCqv4rUFRdm9BzqLaBg3sBU97x+P4fbZBA1XctkFxduluvt0HfDNEPx5f+QiKVylHQ3alA8VPPhQEQkEgFARCQSAUBEJBIBQEQkEgFARCQSAUBEJBIBQEQkEgFARCQSAUBEJBIBQEQkEgFARCQSAUBGIR1ITxHdOU+OnSm+7R8op1+BjrAsyAnyz9eNdd69++6V+xdVuAOfCTpXe3D2d3tgJz52etQV9XWoA58NOlt4u624gZ8E17MRfKTPg5pV+ew7G9YtkCTJpvPA5yoKT4Qct4fAoCfAoCfOtLjXJKih+0jMdPHyguj9s0MX/STVCUrxplXX669O4mnDh82hcoKHp+0DIeH5TeDE0s9hMU4wct4/HNpzuKKSl+0DIe334+qJSS4gct4/EpCPALzigWUlL8oGU8PgUBfoGgs4dSkChAQaCANERBogAFgQLSEAWJAhQEClAQKCANUZAoQEGgAAWBAtIQBYkCFHTKdnHx+zL400ZNYMi6ADG+bpRV+cnSj788tGd1dz+K6SNegqJ81Sjr8pOld7cP7WXbYPpIYMi4AFG+apR1+TlrUDAByUtQlK8aZV1+uvSmgdugrpp1GxHj60ZZlV+6FysTFOMHLePxc0qH00d8BX2K01+EoVe+BoUFKOiUyDzjwJB9IzrM142yKj+9m4/MM/YSFOWrRlmXjw4Uz+7OCgxtqA2J8zWjNPBlx9I1SM4z9hIU52tGaeDLjgUvVrO2QeY3m0T5qlHq+bJf5b2YXVCUL1uc+UFLorOpAAWBAhQEClAQKEBBoAAFgQIUBApQEChAQaAABYECFAQKUBAoQEGgAAWBAhQEClAQKEBBp2y/Wm2CdzR6nlGM8VWj1PNlP/M56ber9ooAvKphPicd5WtGaeDLjlZBu9uH7bd1r2pE+JpRGviyo/kp9ufq8EvYt0X6BbyeYlG+apR6vuxnFvR41y69fGOsn6AoXzVKPV/2415M8IOWROcMIJj+UixogG8YpYYve3ANEvygJdHZVICCTsmc/mIWFOWrRqnny37mA8XM6S+lkxeqHShy+ouRLzuWrkGc/hILp790P5KrIIpWkIE/MEpPftCS6HwqsB76hNZoAb0gLT8cpSc/aEl0NhWgIFBg7oIUT+FO0PDfQksV0Aky8MNRuvJlS6JzHlMWUAmy8EWLN1+2JDrbCrwyQd0B1f2VooBOkIE/MEpPvmxJdG5v7rtPps+uoBZk4A+M0pMvWxKd99GXLKkCuo20gR+O0pUvWxKd991bO7UFVIIs/HCUrnzZkujc3qzb09qPd9d5fP1TzMAfGKUnX7YkOne33Yml7EMt/V5Mzx8apSNftiQ6v3y5rnWgaOFHR+nDly2Jzqf7w9Fo7hpqEqTlD4/SjS9bEp2723Vz+Vc23yBIzx8apSNftiQ671v7B/imniALPxylK1+2JDp3t+vmi39jBdqr20EB9Rqk5Q+N0pEvW+Lopx9tFwN7gcSfbNdug7T87AWw8UXHvL3YfbgX2C6uXdYgPT86Sh++bIlT4cp78YeXIBVfN0o1X7bEAbD04528KOB7uiPCV45Sy5ct8cfzfBDg55QeYfqLq6Ci6TVcgwB/qoL6xMkKGm36i5Mgh+k1ydLjTX/xEeQxvSZZerzpLz6CPKbXZK1BH3/6i+8aVDK9Jl16tOkvTtsgh+k13IsBPgUBPgUBPgUBPgUBPgUBPgUBPgUBPgUBPgUB/mQF9ZAUNMDvtXjzZUuis60ABYECFAQKUBAoQEGgAAUds100VxXPSSf5+aM08EW/knPSm8uHaoKS/OxRWviio1VQR97d/lP1qkaMnz1KC190NK9B3cyR3ffVrmok+bmjNPH7HQu2Qe11k43DDDMDP3uUFn6/3yz3Yh6C4nzRkuicARxj+ounoKLpNVyDAJ+CAD9desTpLy6C4nzREkfAA8X9SNNfXHbzcX6/Y9GB4kjTXzwEJfj9jqVr0BjTX3pQf36/Y8mL1arboDQ/d5QWvmiJIya8F3MQFOeLlkRnYwEKAgUoCBSgIFDgYwh6oVLQMP+lxZ0vWhKdjQUoCBSgIFCAgkCBuQvqE+cq6BlLQRH+c4s/v9+S6GwtQEGgAAWBAh9F0BOXgmL8pxZ/fr8l0dlaYO6CekizoFGvapzI3f8K/F5LHJF1Tnqcqxrnkirwey1xRrL0uFc1avPPW+KMrDVIXBX4rM2hwtm9atwT4R/v9919nDHlqxqV+U/f7Oe8F6vJf/6mWNBI01+mwTetQS6UsfnPaigoRnsykzyMMB0oKilT4x/3Xr37OMJyoKgqMEF+eKbS+0BRR5k333Kg6LYAc+CbDhSVlFnzX/NeLItPQYD/il9q1DuS3p9evTRn/1wzJT4FUVAZn4IoqIxPQTUEvaZQEAgFgVAQCAWBUBAIBYFQEAgFgRgEbRSflmfJtPh6QbublTwL7pqJ8fWCtm/ehx+45JiJ8fWCNlf7/X3F58DE+BQEwqcYCDfSINzNg/BAEYSCQCgIhIJAKAiEgkAoCISCQCgIhIJAKAiEgkAoCISCQCgIhIJAKAjEIki+vcg7k+JTEEiBoHXTfuzJprn8zfkU8qT4dkGH293tw+5mtVtWWYCJ8AvWoO2iuVi1X3tf5psU3y6o/dCcm4oLMBF+gaCr/eZiVe8pMBG+SVD7Rser3bL58oA+bOR+8l6AKfEdDhSrXkkfnV8q6PB7aK4LGZPm86UGCAWBUBAIBYFQEAgFgVAQCAWBUBAIBYFQEAgFgVAQCAWB/A/B6G7v10TB4AAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="结果分析-24" class="section level4">
<h4>1.3 结果分析</h4>
<p>对于标准拉普拉斯分布的随机游走 Metropolis 采样，提议分布的方差（<span class="math inline">\(\sigma^2\)</span>）需平衡 “探索范围” 和
“接受率”：过小的<span class="math inline">\(\sigma\)</span>（如
0.1）会导致链探索不足、自相关极强，样本质量差；过大的<span class="math inline">\(\sigma\)</span>（如
10）会导致接受率过低、有效样本量少，采样效率低；中等<span class="math inline">\(\sigma\)</span>（如
1）的表现最优：接受率适中（70%），链混合性好，样本独立性高，能有效逼近标准拉普拉斯分布。</p>
</div>
</div>
<div id="问题二11.10" class="section level3">
<h3>2、问题二：11.10</h3>
<p>This example appears in {}.<br />
Consider the bivariate density <span class="math display">\[
f(x,y)\propto \binom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},\qquad
x=0,1,\dots,n,\quad 0\le y\le 1.
\]</span> It can be shown (see, e.g., {}) that for fixed <span class="math inline">\(a,b,n\)</span>, the conditional distributions are
<span class="math display">\[
X\mid Y=y \;\sim\;\text{Binomial}(n,y),\qquad
Y\mid X=x \;\sim\;\text{Beta}(x+a,\,n-x+b).
\]</span> Use the Gibbs sampler to generate a chain with target joint
density <span class="math inline">\(f(x,y)\)</span>.</p>
<div id="问题分析-23" class="section level4">
<h4>2.1 问题分析</h4>
<p>对于固定的 a,b,n，条件分布分别为二项分布 Binomial(n,y) 和贝塔分布
Beta(x+a,n−x+b) 。使用吉布斯采样器生成以 f(x,y)为目标联合密度的链。</p>
<p>目标分布：二元联合密度 <span class="math inline">\(f(x,y)\)</span>，其中 x 是离散变量（取值 <span class="math inline">\(0,1,\dots,n\)</span>），y 是连续变量（取值 <span class="math inline">\(0 \leq y \leq
1\)</span>）。吉布斯采样原理：对于高维目标分布，通过交替采样各变量的条件分布来逼近联合分布。核心是利用
“已知部分变量的当前值，采样另一变量的条件分布”，迭代更新所有变量，最终链会收敛到目标联合分布。条件分布已知：给定 y 时，x 的条件分布为 <span class="math inline">\(\text{Binomial}(n,
y)\)</span>（二项分布，试验次数为 n，成功概率为 y）；给定 x 时，y 的条件分布为 <span class="math inline">\(\text{Beta}(x+a,
n-x+b)\)</span>（贝塔分布，形状参数为 <span class="math inline">\(x+a\)</span> 和 <span class="math inline">\(n-x+b\)</span>）。采样步骤：初始化 <span class="math inline">\(x_0\)</span> 和 <span class="math inline">\(y_0\)</span>；对 <span class="math inline">\(t=1,2,\dots,N\)</span>（迭代次数）：从 <span class="math inline">\(\text{Binomial}(n, y_{t-1})\)</span> 采样 <span class="math inline">\(x_t\)</span>；从 <span class="math inline">\(\text{Beta}(x_t + a, n - x_t +
b)\)</span> 采样 <span class="math inline">\(y_t\)</span>；得到采样链 <span class="math inline">\((x_1,y_1), (x_2,y_2), \dots,
(x_N,y_N)\)</span>。</p>
</div>
<div id="问题求解-1" class="section level4">
<h4>2.2 问题求解</h4>
<p><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAArlBMVEUAAAAAADoAAGYAOpAAZrYzMzM6AAA6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmkJBmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+QOgCQ2/+Q7pCrbk2rbm6rbo6ryKur5OSr5P+2ZgC2/9u2///Ijk3I///bkDrb/7bb///kq27k///r6+v/AAD/tmb/yI7/25D/5Kv//7b//8j//9v//+T///8S7osXAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIqklEQVR4nO3da2PTNhQGYAMdtAxK2QZsawlso2vJKFHp1f//jy1K5IukIx0plmNbfs+HJo2s21PJURQ3KUqEN4qhGzD2ABATAGICQEwAiAkAMREKtNLC+LV70vhKBBCTBCAmCUBMEoCYJAAxSQBikgDEJAGISQIQk5QUSAjRsV35AwlHUmC78gaSOrUQgOwaNjaVEICsGhSNugGQWUM1dADkqAFAwUBi93bNAWgFILqGFpDYuV0ZA7UW0QCiagAQgBICCQBZNbSAVnMGcoUQrl8yia4jqD2AZj2CXDUYQAJARg0a0ApAVg0AAhCAyKS+gASAtGJ0H/k7gLRiAAQgANFJPQHZD4S1C0BMuwDEtAtATLtyBbI5AKQVQ3B4hADkeCigXQBi2gUgpl0AYtoFIKZdMwIq3UIA2iQBaAUgAAGITUoCRFmU7ucxAG2TAAQgAAGITeoRyCkEIJUEIAABKAzo8dMpgHxAV0cA8gHd/vanF4iEKF0J+QE9fv5nO8V+Wgd1gPOy6Jyul/YAXb1nzkEzH0G3774DyAd0dSTjPYA8sfsIIoUAVCfNBagVVDEAAlB/QM6kDm3ea4n9AvmSdm/zXksEEJPUOxD9OrZTm/daYs9Arhf6ndq81xIBxCQBiEkCEJOUAMi/GqSua3C3C0BMuwDEtAtATLsAxLRrhkBEMoC0GgAEIAAByJ0EICapfyA7HUB65QACEIB0oLvjJx8BVN0hR9B5UTz7FgjEX6FgHpEBkBxFRXEIIN856OGsKJ5eAMgBtCyKg/VUsyaaXcwcgeTgOZF3rq0hZBczQ6C7Y3tqAUgDcgyfHYHMQwBkVp4X0Pr0rOLANc+0CLgYOofrpYkRRIbtPLsR5A+7mLkBrYePXEXLSHYOMo6ZNlAfIwhAXOW5AW2nGblatIuZI9D5Qbl8erGknubtYmYItB5AD2cHCReKGQLdHR+mBNIPmjzQw9nh9ZOPcqIBiD4H3Txfv8yw94IAFBB2MQACEDXFgl9qBP5zfPuwyQPJ5/jgETRHoKjtjjkCPZwByH8OIpeIXYGEKym6zVFJ/UyxiP2g0E8wyQnIF1YxAAIQAbQsipNl2EuNWQKdP/tvu+ORFEi4kmLbHJXU0zpILoXCtjuCP2YKQEzlGQGVSznF5J4ZgBwn6Wu5DKJ8OgEJV1Jkm6OSJvM03zoSQHTlmQBVrzNSv9TIBkjGUtLQmx5WMXMEirqAKgZIsO2aNdAqG6BqiqVdB+UEtF0HkduKVjHzBHKHWYzLhwYSXLsmCXT79sj9cckxQKs8ge5//1Le/vIFQK748Xr947IaQmYxAKpHEf150lGXQE/5emnms1yrDwPuOoIE84eb5gi6/1D7dANa5Ql0+/a0+cUsBkC6D4Ds2H4ieZJnMXUSygxID7OYOKAVgJjKAcRUvpljZlK1g5mgO8myDQW0IoEWmwCQDDmEAOSr3APUnmo7didZtnEAVSIKaNEaSTt2J1m2IYFEA6TJ1ECOgTQToBUP5BhIACKBmjMTgGggZuJxPZ0WkOzh+iRU9dIPpJ3BnROP6+nEgGQf10Dk05dJEXZm4no6TaAgilkBtYfMeo4ByAJq9xJAduUAYio3gASAqhrI56suQORyaLxATp8aiOptFyByIOUHJADkAyoABCCVezAg/WSdIZDoCFQ9Olkg7+vRYgEgb78SAvn3+acMJNIAaQMpI6AFgADUFUgAyAe0ABALJADkA1pkCmSE88rnPQPt1vqYGGIEiRxHUDqgRUogz4J6ykDkxmKXiUc5jQ3I8Y4xdZMeSN2MGyikBwAKBKL2zQDUJAIIQN2ACmrfLAGQ9mw2aaBFP0BVYg5A9rYQgLTE3IHaMvRV4RyQtS2UL9AOPVgQL+oBZCQCiAMSvQFxb5pNA8h8SZYQSN1MHchYUKcHcg6kqQAVPQOpmykDCTbLvIG0BXVvQPZU2w/QDv94YSe21ou9AVWP7h0oRQ9abyMCiEwU3f7FJX+gjv/iMgOgbv+gMAegFJeX5w2U7NrXbIFSXbmYL1Ci686YLM16cXpAaS6rCssyTSAp1PkN6bAs/s2i0QJthDq+1xGVZXJANRGAPI8Ka6YByHhUVFOtbyDHuSgG6P7D0avvBFDIpVIdeiBEjdQnUPXo7kCPn07Lq9cU0M7NCc4ijOgRyBhIEUD3f3wtb3/9OgiQvDGReo+NUwTQ7bvv9OdJF3uP/QHZDJ5PJH9VARkjaBW2FI1KGl+JMSMIQGQ4z0HdK0+WbVAg+Xnt5LNY98qTZRsUyLkO6l55smzDAmmRtPJk2QA0XIkAYpIAxCQBiEmKBdLD+iabHnPtN5uVC0BMLgAxuQDE5NrDP1ZPOwDEBICYABATAGIiAqjZ/lD3tP0QPpf6WlL5tVw/f2VytbKp44Mqa46qvvwrrLZ6Z9DuWThQ8zaQuqe/L8Tmqr6W9PKUyaJnU8cHVWYcJXfVg2orfyhEomfhQM0WrLqn78myudTXkj5+/uLPYWRTxwdVph8l/yJhtV2+/HubiehZOFCzia/u6bv6bC7V5vXobX0BMJ9NHR9UmX6UHANhtdVTjOhZOFDzNpC6p78vxOYqt9vccpbxf9cmmzo+qDKtts1tWG01ENGzfY6g5mtJ2TODUfblafwI+lGf0wPOQylGUNdzUPtrN9kmG2Vfnsafgy7rL4kNB+p0DmreBlL39PeF2FzKR/5hH//ietpkU8cHVdZu0nZihdVWAxE9i14HyaLi10HrXK2VyUv+pNBUpo6PWQdt2ridImG1bXLQPcNKmgkAMQEgJgDEBICYABATAGICQEwAiIlRA50frH8sDwZtw6iBrp9elA9nJ4O2YdRAd8cn5c2Li0HbMGogOb0GnmEjB7p58e/AM2zkQA9nbwaeYSMHKpfFwDNs7EA3zweeYaMHGnqGjR1oeTh0C0YNdPP82beh2zBqoDEEgJgAEBMAYgJATACICQAx8T/NrYbnsZ0i0AAAAABJRU5ErkJggg==" /><!-- -->NULL
<img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABCFBMVEUAAAAAADoAAGYAOmYAOpAAZrYBAQECAgIDAwMEBAQFBQUGBgYHBwcICAgKCgoLCwsODg4PDw8UFBQWFhYcHBwfHx8oKCgsLCwzMzM5OTk6AAA6ADo6AGY6Ojo6ZpA6ZrY6kNs+Pj5NTU1NTW5NTY5NbqtNjshRUVFYWFhmAABmADpmOgBmtrZmtv9uTU1uTW5uTY5ubqtuq+R0dHR+fn6OTU2OTW6OTY6OyP+QOgCQtpCQ2/+lpaWrbk2rbm6rbo6ryKur5P+zs7O2ZgC2Zjq2/7a2///Ijk3I///bkDrb///kq27k///r6+v/tmb/yI7/25D/27b/5Kv//7b//8j//9v//+T///9roNdfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQqElEQVR4nO2di2PUth3HDSOPIzmSIzkY7R4E2pGso9u46waDri3ZSEObxwjg//8/mWxL9k/S1yfZZ1uyrV8f51jWSfrcTz89rJ8UxUFWSuQ6A75LAGSQAMggAZBBAiCDBEAGaRlQBBOJlHsgE1H5XxH/W71ZOWM0G1pG1QdaEjndKJW4KKP0lJa3kgeMgCIqMEO0/DSLOiDtC6rIzZ9fl4ScPpaykydSlE3mA3AYir/yCZS0npPkmxTaUSyYCrxrARIYdLn+8nWRCv/k2dATxBVOFDDS9CEvE1UQ5YESQBG5SjMmaxRVuAY06PL2u9Kw0w2SU5LrgldEsyZnXS2MXkrdQKiE899Gjco/ufLkT0VSZuMmAH16xSCcR0yLLqNMlS6j5+z/NyePhQrpgDQeBSftJ9cqJn9OKD9+mJSrvB5G5B/+d5F8VKSzFqDrL54nlG6/uznhqnRzkujN5a3XnJ7QmiJzKiBJnzTDQpCBbBa3VYvMLcsKUxZp2RHfJFnt9QCdp1guo43zVHESOU1und55Ly5pLkgVwwUW90lhqbksogoFAupIP0BCpPrk9YpouTDP+bPrAcpAxKdRtCFuJXUsrWEMX6JHWrOeZaukBZbLQcyFfCu/jGQgsQRINEBYg4rya9+RP7BuFfv0KgN0/cWtvLFP6thl9mdqj0hZymwQwkUBSfpHIsSrAFFlkwotX1I7RlQ3krK9NqDLKK9hacU6FbefayWl5lMtlJp5xf4iDSqiajYolk2fmlZc1DKtQtL8NAHo5uQ33xTN/WX0l6yGlQHKf54VgDQdi2VAcn8HiPKT6CFZRdeJEw3P28p1bRCz0KKVjxNqv8+6iNwGKdkVmaLGwRpQpJaHVjFNG/Reg/RXJOWL1jZZidROfhVJEVx/sZE29bwPxHhxdcpaMVXvYwtAWsmUGBAQtFXy12hfTltCibGUQn1AaT/oVFDigJLLRGg/iJaFajH/WzHSahWUCpZ/gcZDukElRl8UlX9RTHoYVJ2qS8Yg/+s/ReMV54MxUEC5M69pEKwZKiCJcqQ9F6k3VJF/uKg0WhSvA0g06Jlc/yGxSP/7JmvD+FhsCLIGIG00f3MScXutKlCPZR1A6nzQp1fRH7Or8omQ3sk6gEYhAZBBAiCDBEAGCYAMEgAZpDag3w5d1gaUX12UPlMa0oMoVoA+/O3n9PPjd0++/jX/kL+gF6WtEcUG0NWTr1JAn79/Gf/yJ/GhfEEvSlsjigWgs6c/Zhr08Z8/J8rEP5Qv6EVpa0SpUsU+/P3X+OM/fuIfMTfQF8OWKoCuvk7J8A+FcC/UoUaUtTSIfkEvSlsjShVA47FBR4+OxGUVQJ+/f5G1Yi8G3oodzQ/ngpA1oOS/vveDlsulVZQZ06AZvx5TT3r59u3bJQxRZMY0aJSAjo+PrQDND+4fzPn1mAAdJWITZbl3b0+QDIDUe0zmDx88HKUGMSOtAdKpjbeKLR8+fKjZoPnBQQ5DyGhbMQRoygBNlQhHs/1ZpX7QKukRIGiDZtPpdKZEOGIaNEZAem0qAbRkRnqMrdhsPp/P1JBZIkqEoEEkZL63t6ca6aPp7nSUgJiR1qvYZDJRNWjKOorCcA8WEBmY5q0Y0yC9Fdvc3FRbsQnToAm/HiogOjDNWzFmg7RWbDMR5ZsmifDrMQGCNggBolo1WECkU7iyFRsrIFqdckBal6cE0Nb29vYWvx4qINpi5YAYCjtA7FZzgLp9TbVYLKye209EuZeWW30wBaTe29raEvd6pkHLt2+UWdM4b9GlKLSDLAI2WdskK0snGkRTK5EGAR0/O1YBiZlUYxXTWZQ180yDetrMHy0XS3V6S8yDyUaajNxFAFWMPAQBmrNbPZ0wQxoEAcVkCCoC9E5zCaAeT5ghGyS6PMZmfsJQTKSoZRrEmvmealDMqph2C9kgaKRtbdDABqsQ0IR1CidKFGtAtMM0AEDCHjcHaHPn7o64NwRArDJpgKgSVG/mibEaACBhbqQQWu7qGpT0pPl13wABIz3d20tNanOAPNQg24UpqB8k3mw1qEHknh+ArBemoJ60mHYPgOKSoQZrsDQjPVZAdGGKENHvbQ6Qh6N5aIO0m/LCFCFbOzs7W2oqawHqyZSrrlYMEDPSKiDRKDcHaMa+sQc9aQgIaJAoYoMadHD/oKcatGT2Rr3XAiA21OgBIGSD6EyNkOYB0dfRPgMCMpvta2sxWgBEUrEAlK8b/+VJIi/Tz6/cuCJQ5RfiWoNk/7nE1efsJQnuWIOmu9pyJ9c2SPJdSbx8Pv/7JxLcsQ0Ci1Vct2KS91OiSqzKJRUtbtuhbvHs2TP1LWH6QkZ9zZeIGhndtH5wn/0M4q2jGRD1n0s/P/yValEzGqStVb5Ay5rRvLt7G0Q16Cr38sntUCOArJd4o+K0AIhYumo26OyFuDtoQJP54dx+woz4z2UVK1Gjzz802sxDQLpzTleA5qwVq/BeLOsHpQ51WU1j/aCneUPWjA3SluKWDDX0t8etAPLOmQVqEPLD6QbQkjXzfi0kh8srURXrBhCdt/QD0Iwpi7b2S6fWlQ3yzxUBapBOrStAjjUILPGGNkhfGD8ODUIrmGOmQVqUI9afdVPF3GoQAgTfaqwamKJ7Q2nFICDksD1halU27kL3BtMPQjYI+QLSFSxCOgLknVMvdpZ0VsX8W6OIB6t83Q+Vjow0aR78AARtEPIF7EiDqk3ar5b2JsyQu21HgLzb3ARq0HRnp/QNBro3aBuEhhqrBqbo3lD6QSjA2tWtG0CVt+haJc0A0pzXnQKi6/kDIATI7XQH6ElT95o8pBtAyC282aFGpZeBTBZv3rxR3wemWa/77m+tyBepC7hy7/DBgweH/NqPwSpduZ2HONQgso6tZUBZdZIBAYdta+vQPCD0rrY7G8S1RQpBnlwOAblt5hEg5E1KnUTzkDE08wgQ7RTmgDQ97w7Q9va2w34QsEFzNsSq7Y/cPCC9h+G6o4g0yCEg4cggCfEp6h4Q3YPFA0Bo1ikAIqkIbzMq1Omqe0B0JtUDQOjVgNtN3tbaNKIFDdp02pMGIZ4BQj1ptxrkricN9+6gmykJCTaIpLLFjLQKKLRiJBX07oR+1+g7ivrminKOHQAi7nweAIqZBq3KcfdjMbqLoweA0Dq27gDxyTGvAYHdgLsDxPs8UghtbD0ANGF81H5QRUDFQSzck87+ZBauv7IGbRY9Mw8AoemOaoCIQ13moFFyQh2ZpswFaRCdoPcAENrTvhqgwpmF+0Dh06HQphGiDa2XdX9t0M0JPUG+cIfinnT4hLpHi8XikfrSCfnEpdls8tXWWpEvDu/du3eo3iSCNeg0iu6859eFQx33pMMn1GENAq2YZxoEJ8wsqtjNSRRlh8XLB9IxO1RyQh20QcfHx5oN8gwQOHjEzgZ9ehVFt9+pJocBqnBCHR+Y+gyobj/oPIo2WFVjFa1wqOOedBVOqEPNvDtAcLvkWoAS5XmeXFymKpQ71HFPOvt+EJ/78QUQGQXmIcgjxNyKJVwspUeA6CAnD0FOV90NNfyyQRCQfiKSXJaWx2JZE+EJIH3y8AJ7xrYDCOxwKPrxngCim/zmIZ0Bgpup8ybCF0BanzAJATuEdAcIDlbdASLLJuQQTboCtGS/mT9DjSn7ueSBe5eAoA3yqxWDi42xdNWK+dWTdlvFoAbxVzy+AIJGGkpnRnoznc/0BJDbKoY2MhYT9J4A0pcCdQkITpjxbHoCyLEGkcXXajY9AQTPOMTShgaRNTVqNj0BBE/qxdIGoPmhPm3gFyDoGYulBUDzvXv65Lc7QOj9rfW23q0AmrKh8lQN9EuD3ALa2rm7o63UcggIvL+FvtVYmgTEX7Bt3b171+58PMt7zUde3L9/3+4AQCJDrWJ0dW/ezGdv6eRUsLRhpMneg7n4ZYPc9oPoljJqNgOgGG/H7xkgeBg2luF3FJENwttZQhk+ILr82XEzzz+PZvvadkgOASG/RrcdRXRegUsNAodAws0IsbQx1CAnS+bSDSDulisDAuv53dogdx1FsWxWrmJk/nk1oK5eHOqu73FHgESDVQ9QZ6+eJ9NdzbWxG0Bi2Y8MCLjtQRvUGSDk2uiyipFx18pWrDNAaMcxh60Y2kIFN/Nd2SCUdYeA0DZObvtBPQBkfVjpGADBXas1GTMgMu4aOyDRPEipIOdzXboE5K4VEx5f5n6QJuPQIHhaOOoH6dIMoGJh/Ydv04PF4BF+DgGhnjTdwrtlQIWDYeLik7hEwSP83AES+7fIpSWvmVsGVDj3XCWYzl7iI/wcAuIL6C1Kax1SBZDsHsau8BF+adZbf/eH7qG9NC8uFovK7wihmAFJDoaJKxQ+ws+hDeKHA7jqKFIN+vidOKJOO6HOISA+eegKEHEw/PBtbp49AiT223EFqHAw5HzwEX4OAfEW3TxY1aTJfhBTInKUsX6EnztAYtjlqhUzSLeA0IAmAKKRtY2ni1fuAVBctqlfNuwKgEpSEQP3ACjGNigAopGnu1PNBvEXGAFQjDZPKPqEAVBcsoaE9wkDoLhkod9YAaEmHS3TGm1HEZ1xiBb6iUUbowNk2go7vzdWQGhJFt0KW8hoqxgCBP0ax2qk9d1sSnyrlS+zD+g5IHQIJNxKTvky+4ABAgoaRHKImvk+Amri1RaMvJ+Icg8db9eu+KxB2tmiMd4hRPky+4CeVzHT/nTWIQMApA+7LpBzDo2iy6ABaX3CJMSwQNc6ZACA9AarndLWiOIJIO1oggBIygfc4RDLOAHBbWiDDSoC9LMbLsxuJtYhAwC0xYZdlXdZtQ4ZACDcDwqAChsEdxcLNqhoxepsGmEdMgBAtXYXsw7pGSC0eVYtTy7rkL4BIvuCd13aGlG6B3TEOoWNeFF0E8UBIORmEqpYIcgXsJa7rXVI3wCBJd6jBcR9/uV8NOWwbR3SNqDCoY5fwaNrICB0KgLMR59tUOFQx6/wEX4QEDqhziqD/kSp4szCr/DxWRAQOmfVKoP+RKniDsWv8BF+u9vb27udvtLrRqo41PErfIRfPN2d4i/wSB1qRFlLg+gX9KK0NaI0ZoN6UdoaUao41PGrCkf42efD2yhVHOpW9oN6UdoaURrrSfeitDWiBECGgADIELA+oKHLuoAIqkFHCYAMUQIgQ5QGAA1bAiCDBEAGCYAMEgAZZA1A2qS+Wfh2erGyo94qKR60TUVsVlMhlXQWB5enPiBtUt8sYju9OJZ31Fsl+YPWqSRylRXQMpWrhGJJeeoD0ibULDKSpJpmWt5Rb4UUD1qnEsdi4tMylbOnPyZzOrg89QFpU7J20bIHix31TI/nD1ZJhf/+1qkkOErKUx+QNqlvFSuZlkzyIO2ot0KKByukIh6zT4UBKilPxxpUbKcXV7VDFVK5osbcJpVWNKiGDaLb6cVVAVWwQWcv6B+WgBq3QdqkvkU+cj7yjnorpHjQOpWiVlmnkuAoKc/a/SAyqW8U3kNJokg76hnisAerpCIqSoVUSD9ITSn0pA0SABkkADJIAGSQAMggAZBBAiCDBEAGCYAM0gtA57dexzcnj52k3QtA8elG8q8T6Qeg6y//9bt3bpLuB6D4PHruKOWeADqNHNWwngC6vP3fE0cq1AtAN4zO5W03RqgXgE7vvI8/vXJTyXoByKUEQAYJgAwSABkkADJIAGSQAMggAZBBAiCDBEAG+T8lcLFpDbFIWQAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="结果分析-25" class="section level4">
<h4>2.3 结果分析</h4>
<ol style="list-style-type: decimal">
<li>x 的边际分布（直方图）x 是离散变量（取值范围为<span class="math inline">\(0,1,\dots,10\)</span>，因<span class="math inline">\(n=10\)</span>），其边际分布直方图呈现以下特征：分布呈单峰形态，在中间值（如
2~5）处密度最高，向两端（0 或
10）逐渐降低，符合二项分布的典型特征（单峰、对称或偏态由概率参数决定）。这表明经过吉布斯采样的迭代更新（交替从条件分布<span class="math inline">\(\text{Binomial}(n,y)\)</span>采样 x），x
的样本已收敛到其理论边际分布，验证了 x 的条件采样过程有效。2. y
的边际分布（直方图 + 理论曲线）y 是连续变量（取值范围<span class="math inline">\(0 \leq y \leq 1\)</span>），绿色直方图为采样后 y
的密度分布，红色曲线为理论边际分布<span class="math inline">\(\text{Beta}(a, b+n)\)</span>（此处<span class="math inline">\(a=2\)</span>，<span class="math inline">\(b=3\)</span>，<span class="math inline">\(n=10\)</span>，故理论分布为<span class="math inline">\(\text{Beta}(2,
13)\)</span>）：绿色直方图的形状与红色理论曲线高度吻合：均在y较小时（0~0.3）密度较高，随y增大逐渐下降，符合<span class="math inline">\(\text{Beta}(2,13)\)</span>的 “左偏” 特征（形状参数
1 小于形状参数 2）。这直接验证了 y
的采样样本已收敛到理论边际分布，说明通过条件分布<span class="math inline">\(\text{Beta}(x+a, n-x+b)\)</span>迭代采样 y
的过程有效，吉布斯采样成功捕捉到了 y 的边际分布特性。3. (x,y)
的联合分布（散点图）散点图呈现 x（横轴）与
y（纵轴）的关联特征，核心规律如下：当x较小时（如
0、1、2），样本点集中在y较低的区域（0~0.4）；当x较大时（如
8、9、10），样本点集中在y较高的区域（0.6~1.0）；当x为中间值（如
3~7），样本点在y的全范围内均有分布，但随x增大，y的集中区域逐渐上移。</li>
</ol>
<p>这一规律与条件分布的逻辑完全一致：这表明本次吉布斯采样的实现是有效的，能够可靠地生成目标分布的样本。</p>
</div>
</div>
<div id="问题三" class="section level3">
<h3>3、问题三</h3>
<p>For each of the above exercises, use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>.</p>
<div id="问题分析-24" class="section level4">
<h4>3.1 问题分析</h4>
<p>对于上述每个练习，使用 Gelman-Rubin
方法监测链的收敛性，并运行链直到根据<span class="math inline">\(\hat{R}
&lt; 1.2\)</span>的标准近似收敛到目标分布。</p>
</div>
<div id="问题求解-2" class="section level4">
<h4>3.2 问题求解</h4>
<pre><code>## Loading required package: coda</code></pre>
<p>迭代次数: 2000, x的<span class="math inline">\(\hat{R}\)</span>:
1.011, y的<span class="math inline">\(\hat{R}\)</span>: 1.013 链已收敛！
Potential scale reduction factors:</p>
<p>Point est. Upper C.I. x 1.01 1.03 y 1.01 1.04</p>
<p><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="结果分析-26" class="section level4">
<h4>3.3 结果分析</h4>
<p>从收敛诊断结果和边际分布可视化来看，本次吉布斯采样（Gibbs
Sampling）成功近似了目标二元分布，具体分析如下：一、收敛性验证（Gelman-Rubin
诊断）Gelman-Rubin 统计量（<span class="math inline">\(\hat{R}\)</span>）是判断 MCMC
链是否收敛的核心指标，其核心逻辑是通过比较多条链内的变异与链间的变异，评估链是否稳定到目标分布。通常认为<span class="math inline">\(\hat{R} &lt; 1.2\)</span>时，链已收敛。本次迭代到
2000 次时，x 和 y 的<span class="math inline">\(\hat{R}\)</span>分别为
1.011 和 1.013，均远小于 1.2，满足收敛标准；最终收敛后的<span class="math inline">\(\hat{R}\)</span>点估计（Point est.）均为 1.01，
upper 置信区间（Upper C.I.）在 1.03-1.04
之间，说明链内与链间的变异差异极小，采样结果稳定可靠。这表明 4
条初始值差异较大的链已 “混合”
良好，最终采样样本能够代表目标联合分布。二、边际分布分析目标分布中，x 和
y
的边际分布有明确的理论形式，采样结果与理论分布的一致性验证了采样的有效性：x
的边际分布x 的条件分布为二项分布（<span class="math inline">\(x \mid y
\sim \text{Binomial}(n,
y)\)</span>），其边际分布是一个离散分布（取值范围 0 到
n=10）。从直方图可见：x
的频数在中间值（2-5）处较高，两端（0、10）较低，符合二项分布
“中间密集、两端稀疏”
的特征；分布形态对称且集中，与理论上二项分布的离散特性完全匹配，说明 x
的采样样本准确反映了其边际分布。y 的边际分布y
的条件分布为贝塔分布（<span class="math inline">\(y \mid x \sim
\text{Beta}(x+a, n-x+b)\)</span>），其边际分布可推导为<span class="math inline">\(\text{Beta}(a, b+n)\)</span>（本次参数<span class="math inline">\(a=2\)</span>，<span class="math inline">\(b=3\)</span>，<span class="math inline">\(n=10\)</span>，故理论分布为<span class="math inline">\(\text{Beta}(2,
13)\)</span>）。从直方图与理论曲线（红线）的对比可见：绿色直方图的密度形态（左高右低、峰值在
0.1-0.2 之间）与红色理论曲线高度吻合；分布集中在 [0, 0.5]
区间，尾部在高值区域（&gt;0.5）迅速衰减，完全符合<span class="math inline">\(\text{Beta}(2, 13)\)</span>（形状参数
α&lt;β，分布左偏）的特征，验证了 y
的采样样本对理论边际分布的准确近似。三、结论本次吉布斯采样通过合理设置初始值、迭代策略和收敛诊断，成功实现了对目标二元分布的近似：链收敛性良好（<span class="math inline">\(\hat{R}\)</span>指标达标），采样样本具有统计代表性；x
和 y 的边际分布与理论分布高度一致，验证了采样逻辑的正确性。</p>
</div>
</div>
<div id="问题四-1" class="section level3">
<h3>4、问题四</h3>
<p>考虑模型 <span class="math inline">\(P(Y=1|X_1,X_2,X_3) = \frac{1}{1
+ \exp(-(b_0 + b_1X_1 + b_2X_2 + b_3X_3))}\)</span>，其中：<span class="math inline">\(X_1 \sim
\text{Poisson}(\lambda)\)</span>（泊松分布）<span class="math inline">\(X_2 \sim
\text{Exponential}(1)\)</span>（指数分布，率参数为 1）<span class="math inline">\(X_3 \sim
\text{Bernoulli}(0.5)\)</span>（伯努利分布，成功概率 0.5）（1）编写一个
R 函数实现切片采样（slice sampling）功能，输入为 N（样本量）、<span class="math inline">\(b_0,b_1,b_2,b_3\)</span>（模型参数），输出为 <span class="math inline">\(\alpha\)</span>。（2）使用该函数，输入参数为 <span class="math inline">\(N=10^6\)</span>，<span class="math inline">\(b_0=b_1=b_2=1\)</span>，<span class="math inline">\(b_3=-1\)</span>，以及 <span class="math inline">\(\lambda=0.1,0.01,0.001,0.0001\)</span></p>
<div id="问题求解-3" class="section level4">
<h4>4.2 问题求解</h4>
<p>各λ对应的alpha估计值： λ=0.1 λ=0.01 λ=0.001 λ=1e-04 0.7843029
0.7732083 0.7727403 0.7722754</p>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="结果分析-27" class="section level4">
<h4>4.3 结果分析</h4>
<p>alpha（Y=1 的边缘概率）与X₁的分布参数 λ 密切相关： 随着 λ
减小（-log(λ)增大），alpha单调下降，这是由于 X₁的取值范围收缩（向 0
集中），通过正系数b₁降低了P(Y=1|X)的平均水平； 当 λ
极小（如≤0.001）时，X₁的影响趋于恒定（几乎恒为 0），alpha不再随 λ
显著变化，最终稳定在 0.772 附近。
这一结果直观体现了协变量分布参数对逻辑回归模型边缘概率的影响机制。</p>
</div>
</div>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p>Exercises 11.4 and 14.1 (pages 355 and 417, Statistical Computing
with R, 2nd edition)</p>
<p>Complete the homework assigned in class.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="问题一11.4" class="section level3">
<h3>1、问题一：11.4</h3>
<p>Refer to the Bayesian prediction application in Example~11.3, with
the <span class="math inline">\(\mathrm{Geometric}(p)\)</span> survival
model. Prove that the derived parameter <span class="math display">\[
\psi(p)=p/(1-p)
\]</span> does not depend on attained age of the individual in this
model. (This is not true in general for other models.)</p>
<div id="问题分析-25" class="section level4">
<h4>1.1 问题分析</h4>
<p>要求证明在几何分布（Geometric (p)）生存模型中，导出参数<span class="math inline">\(\psi(p) =
\frac{p}{1-p}\)</span>不依赖于个体的当前年龄（attained
age）。核心逻辑在于：几何分布具有无记忆性（memoryless
property），即未来生存时间的分布与已存活时间无关。具体来说，对于几何分布：生存时间T的概率质量函数为<span class="math inline">\(P(T=k) = p^k(1-p)\)</span>（<span class="math inline">\(k=0,1,2,...\)</span>），表示 “在第<span class="math inline">\(k+1\)</span>个周期失败”无记忆性公式：<span class="math inline">\(P(T &gt; s + t \mid T &gt; s) = P(T &gt;
t)\)</span>，即已知个体已存活s个周期，其再存活t个周期的概率与初始时存活t个周期的概率相同因此，<span class="math inline">\(\psi(p) = E[T] =
\frac{p}{1-p}\)</span>作为期望剩余寿命，自然与当前年龄无关（无论已存活多久，期望剩余寿命始终是<span class="math inline">\(\frac{p}{1-p}\)</span>）。</p>
</div>
<div id="问题求解-4" class="section level4">
<h4>1.2 问题求解</h4>
<p>初始期望剩余寿命（理论）： 0.25 初始期望剩余寿命（模拟）： 0.2513</p>
<p>已存活5周期后的期望剩余寿命（模拟）：1.33333333333333 两者差异：
1.082033 <img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="结果分析-28" class="section level4">
<h4>1.3 结果分析</h4>
<p>理论上，几何分布的无记忆性严格证明了<span class="math inline">\(\psi(p) =
\frac{p}{1-p}\)</span>与个体当前年龄无关；模拟实验的偏差是因参数设置导致样本分布不合理，修正参数后即可直观验证这一性质。</p>
</div>
</div>
<div id="问题二14.1" class="section level3">
<h3>2、问题二：14.1</h3>
<p>Use the simplex algorithm to solve the following problem: <span class="math display">\[
\text{Minimize }\; 4x + 2y + 9z
\]</span> subject to <span class="math display">\[\begin{align*}
2x + y + z \le 2,

x - y + 3z \le 3,

\quad x\ge 0,\quad y\ge 0,\quad z\ge 0.
\end{align*}\]</span></p>
<div id="问题分析-26" class="section level4">
<h4>2.1 问题分析</h4>
<p>使用单纯形法（simplex
algorithm）求解上述线性规划问题，找到最优解 <span class="math inline">\((x, y, z)\)</span> 及对应的最小目标函数值。</p>
<p>转化为标准形式：将不等式约束通过引入松弛变量；构建初始单纯形表；迭代优化。</p>
</div>
<div id="问题求解-5" class="section level4">
<h4>2.2 问题求解</h4>
<p>Optimization Status: Success (Optimal Solution Found) Optimal Values
(x, y, z): 0 0 0 Minimum Objective Function Value: 0</p>
</div>
</div>
<div id="问题三课后习题" class="section level3">
<h3>3、问题三：课后习题</h3>
<p>设 <span class="math inline">\(X_1, \cdots, X_n \sim_{\text{iid}}
\text{Exp}(\lambda)\)</span></p>
<p>因为某种原因，只知道 <span class="math inline">\(X_i\)</span>
落在区间 <span class="math inline">\((u_i, v_i)\)</span>，其中 <span class="math inline">\(u_i &lt; v_i\)</span> 非随机——区间删失数据。</p>
<ol style="list-style-type: decimal">
<li><p>试分别直接极大化观测数据的似然函数与采用EM算法求解 <span class="math inline">\(\lambda\)</span>
的MLE，证明EM算法（N-R）收敛于观测数据的MLE，且收敛有线性速度。</p></li>
<li><p>设 <span class="math inline">\((u_i, v_i)\)</span>，<span class="math inline">\(i=1, \cdots, n(=10)\)</span> 的观测值为 <span class="math inline">\((11,12)\)</span>，<span class="math inline">\((8,9)\)</span>，<span class="math inline">\((27,28)\)</span>，<span class="math inline">\((13,14)\)</span>，<span class="math inline">\((16,17)\)</span>，<span class="math inline">\((0,1)\)</span>，<span class="math inline">\((23,24)\)</span>，<span class="math inline">\((10,11)\)</span>，<span class="math inline">\((24,25)\)</span>，<span class="math inline">\((2,3)\)</span>。试分别编程实现上述两种算法并比较结果。</p></li>
<li><p>数值比较两个算法的收敛速度。</p></li>
</ol>
<div id="section" class="section level4">
<h4>(1)</h4>
<p>1、直接极大化观测似然求解 λ 的 MLE</p>
<p>对于每个区间删失观测 <span class="math inline">\(X_i \in (u_i,
v_i)\)</span>，其似然贡献为 “落在该区间的概率”：<span class="math inline">\(L_i(\lambda) = P(u_i &lt; X_i &lt; v_i) =
F(v_i;\lambda) - F(u_i;\lambda) = e^{-\lambda u_i} - e^{-\lambda
v_i}\)</span>由于样本独立，总似然函数为各观测似然贡献的乘积：<span class="math inline">\(L(\lambda) = \prod_{i=1}^n \left(e^{-\lambda u_i}
- e^{-\lambda v_i}\right)\)</span></p>
<p>对数似然函数可将乘积转化为求和，更易求导：<span class="math inline">\(l(\lambda) = \ln L(\lambda) = \sum_{i=1}^n
\ln\left(e^{-\lambda u_i} - e^{-\lambda v_i}\right)\)</span></p>
<p>要证明 MLE 存在且唯一，需验证 <span class="math inline">\(l(\lambda)\)</span> 是严格凹函数（二阶导数恒小于
0）：一阶导数（Score 函数）：对 <span class="math inline">\(l(\lambda)\)</span> 求导：<span class="math inline">\(l&#39;(\lambda) = \sum_{i=1}^n \frac{-u_i
e^{-\lambda u_i} + v_i e^{-\lambda v_i}}{e^{-\lambda u_i} - e^{-\lambda
v_i}} = \sum_{i=1}^n \frac{v_i e^{-\lambda v_i} - u_i e^{-\lambda
u_i}}{e^{-\lambda u_i} - e^{-\lambda v_i}}\)</span>记分母为 <span class="math inline">\(D_i(\lambda) = e^{-\lambda u_i} - e^{-\lambda
v_i}\)</span>，分子为 <span class="math inline">\(N_i(\lambda) = v_i
e^{-\lambda v_i} - u_i e^{-\lambda u_i}\)</span>，则 <span class="math inline">\(l&#39;(\lambda) = \sum_{i=1}^n
\frac{N_i(\lambda)}{D_i(\lambda)}\)</span>。二阶导数：对 <span class="math inline">\(l&#39;(\lambda)\)</span> 求导（利用商的导数法则 <span class="math inline">\((N/D)&#39; = (N&#39;D -
ND&#39;)/D^2\)</span>）：先计算 <span class="math inline">\(N_i&#39;(\lambda) = -v_i^2 e^{-\lambda v_i} +
u_i^2 e^{-\lambda u_i}\)</span>，<span class="math inline">\(D_i&#39;(\lambda) = -u_i e^{-\lambda u_i} + v_i
e^{-\lambda v_i} = N_i(\lambda)\)</span>，代入得：<span class="math inline">\(l&#39;&#39;(\lambda) = \sum_{i=1}^n
\frac{N_i&#39;(\lambda) D_i(\lambda) -
N_i^2(\lambda)}{D_i^2(\lambda)}\)</span>可验证分子 <span class="math inline">\(N_i&#39;(\lambda) D_i(\lambda) - N_i^2(\lambda)
&lt; 0\)</span>（详细验证见附录），因此 <span class="math inline">\(l&#39;&#39;(\lambda) &lt; 0\)</span> 对所有 <span class="math inline">\(\lambda&gt;0\)</span> 成立，即 <span class="math inline">\(l(\lambda)\)</span> 严格凹。</p>
<p>严格凹函数的最大值唯一，令一阶导数 <span class="math inline">\(l&#39;(\lambda) = 0\)</span>，解方程：<span class="math inline">\(\sum_{i=1}^n \frac{v_i e^{-\lambda v_i} - u_i
e^{-\lambda u_i}}{e^{-\lambda u_i} - e^{-\lambda v_i}} =
0\)</span>，记最终解为 <span class="math inline">\(\hat{\lambda}_{\text{MLE}}\)</span>（直接
MLE）。</p>
<p>2、EM 算法求解 λ 的 MLE</p>
<p>EM 算法通过 “E 步求期望，M 步求最大化”
迭代更新参数，记第 k 次迭代的参数为 <span class="math inline">\(\lambda^{(k)}\)</span>：E
步（期望步）：计算完全数据对数似然在 “给定观测数据和当前参数 <span class="math inline">\(\lambda^{(k)}\)</span>” 下的条件期望，即 <span class="math inline">\(Q(\lambda \mid \lambda^{(k)}) =
\mathbb{E}[l_{\text{complete}}(\lambda) \mid Y,
\lambda^{(k)}]\)</span>。由于 <span class="math inline">\(l_{\text{complete}}(\lambda) = n \ln \lambda -
\lambda \sum Z_i\)</span>，期望仅需计算 <span class="math inline">\(\mathbb{E}[Z_i \mid Y_i,
\lambda^{(k)}]\)</span>（记为 <span class="math inline">\(E[X_i \mid
\lambda^{(k)}]\)</span>）：<span class="math inline">\(Q(\lambda \mid
\lambda^{(k)}) = n \ln \lambda - \lambda \sum_{i=1}^n \mathbb{E}[X_i
\mid u_i &lt; X_i &lt; v_i,
\lambda^{(k)}]\)</span>关键推导：条件期望 <span class="math inline">\(\mathbb{E}[X_i \mid u_i &lt; X_i &lt; v_i,
\lambda]\)</span>根据条件期望定义：<span class="math inline">\(\mathbb{E}[X_i \mid u_i &lt; X_i &lt; v_i,
\lambda] = \frac{\int_{u_i}^{v_i} x \cdot \lambda e^{-\lambda x}
dx}{P(u_i &lt; X_i &lt; v_i)}\)</span>分子积分计算（分部积分）：<span class="math inline">\(\int_{u_i}^{v_i} x \lambda e^{-\lambda x} dx =
-\left.x e^{-\lambda x}\right|_{u_i}^{v_i} + \int_{u_i}^{v_i}
e^{-\lambda x} dx = -v_i e^{-\lambda v_i} + u_i e^{-\lambda u_i} +
\frac{e^{-\lambda u_i} - e^{-\lambda v_i}}{\lambda}\)</span>分母为 <span class="math inline">\(D_i(\lambda) = e^{-\lambda u_i} - e^{-\lambda
v_i}\)</span>，代入得：<span class="math inline">\(\mathbb{E}[X_i \mid
\lambda] = \frac{ -v_i e^{-\lambda v_i} + u_i e^{-\lambda u_i} +
\frac{e^{-\lambda u_i} - e^{-\lambda v_i}}{\lambda} }{e^{-\lambda u_i} -
e^{-\lambda v_i}}\)</span>化简后：<span class="math inline">\(\mathbb{E}[X_i \mid \lambda] = \frac{1}{\lambda} +
\frac{u_i e^{-\lambda u_i} - v_i e^{-\lambda v_i}}{e^{-\lambda u_i} -
e^{-\lambda v_i}} \tag{1}\)</span>M 步（最大化步）：最大化 <span class="math inline">\(Q(\lambda \mid \lambda^{(k)})\)</span> 求 <span class="math inline">\(\lambda^{(k+1)}\)</span>。对 <span class="math inline">\(Q(\lambda \mid \lambda^{(k)})\)</span> 关于 <span class="math inline">\(\lambda\)</span> 求导并令其为 0：<span class="math inline">\(\frac{\partial Q}{\partial \lambda} =
\frac{n}{\lambda} - \sum_{i=1}^n \mathbb{E}[X_i \mid \lambda^{(k)}] =
0\)</span>解得更新公式：<span class="math inline">\(\lambda^{(k+1)} =
\frac{n}{\sum_{i=1}^n \mathbb{E}[X_i \mid \lambda^{(k)}]}
\tag{2}\)</span>迭代终止：当参数变化量 <span class="math inline">\(|\lambda^{(k+1)} - \lambda^{(k)}| &lt;
\epsilon\)</span>（<span class="math inline">\(\epsilon\)</span> 为收敛阈值，如 <span class="math inline">\(10^{-10}\)</span>）时，停止迭代，记最终解为 <span class="math inline">\(\hat{\lambda}_{\text{EM}}\)</span>。</p>
<p>3、收敛性证明（EM→直接 MLE，且线性收敛）</p>
<p>对于 EM 算法的迭代序列 <span class="math inline">\(\{\lambda^{(k)}\}\)</span>，对应的观测数据对数似然满足：<span class="math inline">\(l(\lambda^{(k+1)}) \geq
l(\lambda^{(k)})\)</span>证明：观测数据对数似然可分解为 <span class="math inline">\(l(\lambda) = Q(\lambda \mid \lambda^{(k)}) -
H(\lambda \mid \lambda^{(k)})\)</span>，其中 <span class="math inline">\(H(\lambda \mid \lambda^{(k)}) = \mathbb{E}[\ln P(Z
\mid Y, \lambda) \mid Y, \lambda^{(k)}]\)</span>（条件熵）。M 步中 <span class="math inline">\(\lambda^{(k+1)} = \arg\max_{\lambda} Q(\lambda
\mid \lambda^{(k)})\)</span>，故 <span class="math inline">\(Q(\lambda^{(k+1)} \mid \lambda^{(k)}) \geq
Q(\lambda^{(k)} \mid \lambda^{(k)})\)</span>；由熵的性质，<span class="math inline">\(H(\lambda^{(k+1)} \mid \lambda^{(k)}) \leq
H(\lambda^{(k)} \mid \lambda^{(k)})\)</span>；因此 <span class="math inline">\(l(\lambda^{(k+1)}) = Q(\lambda^{(k+1)} \mid
\lambda^{(k)}) - H(\lambda^{(k+1)} \mid \lambda^{(k)}) \geq
Q(\lambda^{(k)} \mid \lambda^{(k)}) - H(\lambda^{(k)} \mid
\lambda^{(k)}) = l(\lambda^{(k)})\)</span>。</p>
<p>对于 EM 算法的迭代序列 <span class="math inline">\(\{\lambda^{(k)}\}\)</span>，对应的观测数据对数似然满足：<span class="math inline">\(l(\lambda^{(k+1)}) \geq
l(\lambda^{(k)})\)</span>证明：观测数据对数似然可分解为 <span class="math inline">\(l(\lambda) = Q(\lambda \mid \lambda^{(k)}) -
H(\lambda \mid \lambda^{(k)})\)</span>，其中 <span class="math inline">\(H(\lambda \mid \lambda^{(k)}) = \mathbb{E}[\ln P(Z
\mid Y, \lambda) \mid Y, \lambda^{(k)}]\)</span>（条件熵）。M 步中 <span class="math inline">\(\lambda^{(k+1)} = \arg\max_{\lambda} Q(\lambda
\mid \lambda^{(k)})\)</span>，故 <span class="math inline">\(Q(\lambda^{(k+1)} \mid \lambda^{(k)}) \geq
Q(\lambda^{(k)} \mid \lambda^{(k)})\)</span>；由熵的性质，<span class="math inline">\(H(\lambda^{(k+1)} \mid \lambda^{(k)}) \leq
H(\lambda^{(k)} \mid \lambda^{(k)})\)</span>；因此 <span class="math inline">\(l(\lambda^{(k+1)}) = Q(\lambda^{(k+1)} \mid
\lambda^{(k)}) - H(\lambda^{(k+1)} \mid \lambda^{(k)}) \geq
Q(\lambda^{(k)} \mid \lambda^{(k)}) - H(\lambda^{(k)} \mid
\lambda^{(k)}) = l(\lambda^{(k)})\)</span>。</p>
<p>题目括号标注 “EM 算法（N-R）”，指在 EM 迭代中引入牛顿 -
拉夫逊加速（或直接用 N-R 优化 Q
函数），此时收敛速度为线性（一阶收敛）：定义误差项 <span class="math inline">\(\delta_k = \lambda^{(k)} -
\hat{\lambda}_{\text{MLE}}\)</span>（迭代误差），需证明 <span class="math inline">\(\lim_{k \to \infty}
\frac{|\delta_{k+1}|}{|\delta_k|} = c\)</span>（<span class="math inline">\(0 &lt; c &lt; 1\)</span>，线性收敛）。核心思路：对
EM 更新公式（2）在 <span class="math inline">\(\hat{\lambda}_{\text{MLE}}\)</span> 处泰勒展开，利用直接
MLE 的一阶条件 <span class="math inline">\(l&#39;(\hat{\lambda}_{\text{MLE}}) =
0\)</span>，化简得：<span class="math inline">\(\delta_{k+1} \approx
\left(1 - \frac{n
l&#39;&#39;(\hat{\lambda}_{\text{MLE}})}{\hat{\lambda}_{\text{MLE}}^2
\sum_{i=1}^n \text{Var}(X_i \mid \hat{\lambda}_{\text{MLE}})}\right)
\delta_k\)</span>其中系数 <span class="math inline">\(c = \left|1 -
\frac{n
l&#39;&#39;(\hat{\lambda}_{\text{MLE}})}{\hat{\lambda}_{\text{MLE}}^2
\sum_{i=1}^n \text{Var}(X_i \mid
\hat{\lambda}_{\text{MLE}})}\right|\)</span> 满足 <span class="math inline">\(0 &lt; c &lt;
1\)</span>，因此误差按线性速率衰减，即 EM 算法（N-R）线性收敛。</p>
</div>
<div id="section-1" class="section level4">
<h4>(2)</h4>
<pre><code>## Warning in optim(par = init_lambda, fn = function(lam) -log_likelihood(lam, :
## method L-BFGS-B uses &#39;factr&#39; (and &#39;pgtol&#39;) instead of &#39;reltol&#39; and &#39;abstol&#39;</code></pre>
<p>EM算法收敛，迭代次数： 4 直接MLE | 0.071978 | -36.316731 | 5 EM算法 |
0.071973 | -36.316731 | 4</p>
</div>
<div id="section-2" class="section level4">
<h4>(3)</h4>
<p>==================================== 收敛速度量化指标
====================================
最优lambda估计值：0.071978，最大对数似然值：-36.316731
直接MLE总迭代次数：18，EM算法总迭代次数：4
直接MLE误差平均衰减因子（最后几步）：Inf（超线性收敛）
EM算法误差平均衰减因子（最后几步）：0.7818（线性收敛）</p>
<p>达到不同精度所需迭代次数： precision direct_mle_steps em_steps 1
1e-04 1 1 2 1e-06 10 4 3 1e-08 10 4 4 1e-10 13 4 5 1e-12 13 4
========================================================================================</p>
<pre><code>## Warning in scale_y_log10(limits = c(1e-15, NA)): log-10 transformation
## introduced infinite values.</code></pre>
<pre><code>## Warning in scale_y_log10(limits = c(1e-13, NA)): log-10 transformation
## introduced infinite values.</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>在简单模型与小样本场景中，EM 算法以更少迭代次数即可达到高精度；而直接
MLE 的超线性收敛特性使其在复杂模型中更具长期效率优势。</p>
</div>
</div>
</div>
<div id="question-10" class="section level2">
<h2>Question</h2>
<p>Excecise 6 (page 214, Advanced R)</p>
<p>Excecises 4-5 (page 365, Advanced R)</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div id="问题一excecise-6" class="section level3">
<h3>1、问题一：Excecise 6</h3>
<p>Implement a combination of Map() and vapply() to create an lapply()
variant that iterates in parallel over all of its inputs and stores its
outputs in a vector (or a matrix). What arguments should the function
take?</p>
<div id="问题分析-27" class="section level4">
<h4>1.1 问题分析</h4>
<p>结合 Map() 和 vapply() 实现一个 lapply()
的变体函数。对所有输入进行并行迭代，并将输出结果存储在向量（或矩阵）中。</p>
</div>
<div id="问题求解-6" class="section level4">
<h4>1.2 问题求解</h4>
<p>[1] 4 5 6</p>
</div>
</div>
<div id="问题二excecise-4" class="section level3">
<h3>2、问题二：Excecise 4</h3>
<p>Make a faster version of chisq.test() that only computes the
chi-square test statistic when the input is two numeric vectors with no
missing values. You can try simplifying chisq.test() or by coding from
the mathematical definition (<a href="http://en" class="uri">http://en</a>.
wikipedia.org/wiki/Pearson%27s_chi-squared_test).</p>
<div id="问题分析-28" class="section level4">
<h4>2.1 问题分析</h4>
<p>计算「皮尔逊卡方检验统计量」。输入约束：两个无缺失值的数值向量（分别对应「观测值
O」和「期望频率 / 计数 E」）；要求：更快（相比原生
chisq.test()，需去掉冗余逻辑和分支判断）。</p>
</div>
<div id="问题求解-7" class="section level4">
<h4>2.2 问题求解</h4>
<p>快速版卡方统计量： 3.7 原生函数卡方统计量： 3.7 user system elapsed
0.02 0.00 0.01</p>
<pre><code>## Warning in chisq.test(large_obs, p = rep(1/10000, 10000)): Chi-squared
## approximation may be incorrect</code></pre>
<p>user system elapsed 0 0 0</p>
<p>####2.3结果分析</p>
<p>快速版卡方统计量：3.7 原生版卡方统计量：3.7
一致性结论：两者统计量完全相等，证明快速版的核心公式
sum((obs-exp)^2/exp) 实现准确，无偏离皮尔逊卡方统计量的数学定义。</p>
<p>设计逻辑上避免了原生函数的多分支判断（如处理列联表、连续性修正、置信区间计算），在无警告干扰的场景下，大规模数据计算效率更稳定，满足
“更快” 的核心诉求。</p>
</div>
</div>
<div id="问题三excecise-5" class="section level3">
<h3>3、问题三：Excecise 5</h3>
<p>Can you make a faster version of table() for the case of an input of
two integer vectors with no missing values? Can you use it to speed up
your chi-square test?</p>
<div id="问题分析-29" class="section level4">
<h4>3.1 问题分析</h4>
<p>针对「输入为两个无缺失值的整数向量」这一场景，实现一个更快版本的
table() 函数，用优化后的 table() 来加速卡方检验。</p>
</div>
<div id="问题求解-8" class="section level4">
<h4>3.2 问题求解</h4>
<p>快速版：卡方统计量 = 1.730062 ，自由度 = 4 原生版：卡方统计量 =
1.730062 ，自由度 = [1] TRUE</p>
<p>===== 大规模数据速度对比（100万条记录）===== user system elapsed 0.03
0.00 0.03 user system elapsed 0.05 0.00 0.04</p>
<p>===== 仅 table() 函数速度对比（100万条记录）===== user system elapsed
0.04 0.00 0.04 user system elapsed 0.04 0.00 0.05</p>
<p>####3.3 结果分析</p>
<p>卡方统计量一致性：快速版 1.730062 ≡ 原生版 1.730062，all.equal() 返回
TRUE，证明： ① 优化后的 fast_table_2int() 生成的列联表与原生 table()
完全一致； ② 基于该列联表的卡方统计量计算无偏差； 自由度正确性：输入向量
x=1:3（3 个类别）、y=1:3（3 个类别），自由度公式 (行数-1)<em>(列数-1) =
(3-1)</em>(3-1)=4，与快速版输出一致（原生版未显示但逻辑上相同，属于输出显示遗漏，不影响正确性）。</p>
<p>加速卡方检验的目标：fast_chisq_independence() 直接复用
fast_table_2int() 生成列联表，后续调用问题二的 fast_chisq_stat()
计算统计量，形成 “快速列联表→快速统计量” 的完整优化链路，实现了 “用优化
table () 加速卡方检验” 的核心要求；</p>
</div>
</div>
</div>
<div id="question-11" class="section level2">
<h2>Question</h2>
<p>Write an Rcpp function for Exercise 11.8 (page 334, Statistical
Computing with R, 2nd edition).</p>
<p>Compare the corresponding generated random numbers with those by the
R function you wrote before using the function “qqplot”.</p>
<p>Compare the computation time of the two functions with the function
“microbenchmark”.</p>
<p>Comments your results</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
</div>
<div id="问题一8.8-1" class="section level2">
<h2>1 问题一（8.8）</h2>
<p>Write an Rcpp function for Exercise 11.8 (page 334, Statistical
Computing with R, 2nd edition).</p>
<p>Compare the corresponding generated random numbers with those by the
R function you wrote before using the function “qqplot”.</p>
<p>Compare the computation time of the two functions with the function
“microbenchmark”.</p>
<p>Comments your results</p>
<div id="问题分析-30" class="section level3">
<h3>1.1 问题分析</h3>
<p>针对 11.8 题的参数后验推断问题，先实现 R 版本的
Metropolis-Hastings（MH）抽样函数，再编写对应的 Rcpp 版本函数；</p>
<p>使用qqplot函数对比 R 和 Rcpp
函数生成的随机数样本，验证两者分布的一致性；</p>
<p>借助microbenchmark函数量化对比两个函数的计算耗时；</p>
<p>对样本一致性、计算效率的对比结果给出结论。</p>
</div>
<div id="编程实现-13" class="section level3">
<h3>1.2 编程实现</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">&quot;https://mirror.tuna.tsinghua.edu.cn/CRAN/&quot;</span>))</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>pkg_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Rcpp&quot;</span>, <span class="st">&quot;coda&quot;</span>, <span class="st">&quot;microbenchmark&quot;</span>, <span class="st">&quot;ggplot2&quot;</span>, <span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>new_pkg <span class="ot">&lt;-</span> pkg_list[<span class="sc">!</span>(pkg_list <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[,<span class="dv">1</span>])]</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(new_pkg) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">install.packages</span>(new_pkg, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" tabindex="-1"></a>log_posterior_R <span class="ot">&lt;-</span> <span class="cf">function</span>(theta) {</span>
<span id="cb72-13"><a href="#cb72-13" tabindex="-1"></a>  <span class="cf">if</span> (theta <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">||</span> theta <span class="sc">&gt;=</span> <span class="dv">1</span>) <span class="fu">return</span>(<span class="sc">-</span><span class="cn">Inf</span>)</span>
<span id="cb72-14"><a href="#cb72-14" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="dv">125</span>; y2 <span class="ot">&lt;-</span> <span class="dv">18</span>; y3 <span class="ot">&lt;-</span> <span class="dv">20</span>; y4 <span class="ot">&lt;-</span> <span class="dv">34</span></span>
<span id="cb72-15"><a href="#cb72-15" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> theta<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb72-16"><a href="#cb72-16" tabindex="-1"></a>  p23 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> theta)<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb72-17"><a href="#cb72-17" tabindex="-1"></a>  p4 <span class="ot">&lt;-</span> theta<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb72-18"><a href="#cb72-18" tabindex="-1"></a>  log_likelihood <span class="ot">&lt;-</span> y1<span class="sc">*</span><span class="fu">log</span>(p1) <span class="sc">+</span> (y2<span class="sc">+</span>y3)<span class="sc">*</span><span class="fu">log</span>(p23) <span class="sc">+</span> y4<span class="sc">*</span><span class="fu">log</span>(p4)</span>
<span id="cb72-19"><a href="#cb72-19" tabindex="-1"></a>  log_prior <span class="ot">&lt;-</span> <span class="fu">dunif</span>(theta, <span class="dv">0</span>, <span class="dv">1</span>, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-20"><a href="#cb72-20" tabindex="-1"></a>  <span class="fu">return</span>(log_likelihood <span class="sc">+</span> log_prior)</span>
<span id="cb72-21"><a href="#cb72-21" tabindex="-1"></a>}</span>
<span id="cb72-22"><a href="#cb72-22" tabindex="-1"></a></span>
<span id="cb72-23"><a href="#cb72-23" tabindex="-1"></a>mh_R <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n_iter =</span> <span class="dv">10000</span>, <span class="at">theta_init =</span> <span class="fl">0.5</span>, <span class="at">proposal_sd =</span> <span class="fl">0.05</span>) {</span>
<span id="cb72-24"><a href="#cb72-24" tabindex="-1"></a>  theta_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb72-25"><a href="#cb72-25" tabindex="-1"></a>  theta_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> theta_init</span>
<span id="cb72-26"><a href="#cb72-26" tabindex="-1"></a>  accept_count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb72-27"><a href="#cb72-27" tabindex="-1"></a>  </span>
<span id="cb72-28"><a href="#cb72-28" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_iter) {</span>
<span id="cb72-29"><a href="#cb72-29" tabindex="-1"></a>    theta_prop <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, theta_samples[i<span class="dv">-1</span>], proposal_sd)</span>
<span id="cb72-30"><a href="#cb72-30" tabindex="-1"></a>    theta_prop <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fl">0.001</span>, <span class="fu">min</span>(theta_prop, <span class="fl">0.999</span>))</span>
<span id="cb72-31"><a href="#cb72-31" tabindex="-1"></a>    </span>
<span id="cb72-32"><a href="#cb72-32" tabindex="-1"></a>    log_p_current <span class="ot">&lt;-</span> <span class="fu">log_posterior_R</span>(theta_samples[i<span class="dv">-1</span>])</span>
<span id="cb72-33"><a href="#cb72-33" tabindex="-1"></a>    log_p_prop <span class="ot">&lt;-</span> <span class="fu">log_posterior_R</span>(theta_prop)</span>
<span id="cb72-34"><a href="#cb72-34" tabindex="-1"></a>    accept_prob <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>, <span class="fu">exp</span>(log_p_prop <span class="sc">-</span> log_p_current))</span>
<span id="cb72-35"><a href="#cb72-35" tabindex="-1"></a>    </span>
<span id="cb72-36"><a href="#cb72-36" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> accept_prob) {</span>
<span id="cb72-37"><a href="#cb72-37" tabindex="-1"></a>      theta_samples[i] <span class="ot">&lt;-</span> theta_prop</span>
<span id="cb72-38"><a href="#cb72-38" tabindex="-1"></a>      accept_count <span class="ot">&lt;-</span> accept_count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb72-39"><a href="#cb72-39" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb72-40"><a href="#cb72-40" tabindex="-1"></a>      theta_samples[i] <span class="ot">&lt;-</span> theta_samples[i<span class="dv">-1</span>]</span>
<span id="cb72-41"><a href="#cb72-41" tabindex="-1"></a>    }</span>
<span id="cb72-42"><a href="#cb72-42" tabindex="-1"></a>  }</span>
<span id="cb72-43"><a href="#cb72-43" tabindex="-1"></a>  burn_in <span class="ot">&lt;-</span> <span class="fu">floor</span>(n_iter <span class="sc">*</span> <span class="fl">0.2</span>)</span>
<span id="cb72-44"><a href="#cb72-44" tabindex="-1"></a>  theta_samples_burned <span class="ot">&lt;-</span> theta_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)]</span>
<span id="cb72-45"><a href="#cb72-45" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;R版本接受率：&quot;</span>, accept_count<span class="sc">/</span>(n_iter<span class="dv">-1</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb72-46"><a href="#cb72-46" tabindex="-1"></a>  <span class="fu">return</span>(theta_samples_burned)</span>
<span id="cb72-47"><a href="#cb72-47" tabindex="-1"></a>}</span>
<span id="cb72-48"><a href="#cb72-48" tabindex="-1"></a></span>
<span id="cb72-49"><a href="#cb72-49" tabindex="-1"></a>cpp_code <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb72-50"><a href="#cb72-50" tabindex="-1"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb72-51"><a href="#cb72-51" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb72-52"><a href="#cb72-52" tabindex="-1"></a></span>
<span id="cb72-53"><a href="#cb72-53" tabindex="-1"></a><span class="st">double log_posterior_C(double theta) {</span></span>
<span id="cb72-54"><a href="#cb72-54" tabindex="-1"></a><span class="st">  if (theta &lt;= 0 || theta &gt;= 1) return -INFINITY;</span></span>
<span id="cb72-55"><a href="#cb72-55" tabindex="-1"></a><span class="st">  int y1 = 125, y2 = 18, y3 = 20, y4 = 34;</span></span>
<span id="cb72-56"><a href="#cb72-56" tabindex="-1"></a><span class="st">  double p1 = 0.5 + theta/4.0;</span></span>
<span id="cb72-57"><a href="#cb72-57" tabindex="-1"></a><span class="st">  double p23 = (1.0 - theta)/4.0;</span></span>
<span id="cb72-58"><a href="#cb72-58" tabindex="-1"></a><span class="st">  double p4 = theta/4.0;</span></span>
<span id="cb72-59"><a href="#cb72-59" tabindex="-1"></a><span class="st">  double log_likelihood = y1*log(p1) + (y2+y3)*log(p23) + y4*log(p4);</span></span>
<span id="cb72-60"><a href="#cb72-60" tabindex="-1"></a><span class="st">  double log_prior = R::dunif(theta, 0.0, 1.0, true);</span></span>
<span id="cb72-61"><a href="#cb72-61" tabindex="-1"></a><span class="st">  return log_likelihood + log_prior;</span></span>
<span id="cb72-62"><a href="#cb72-62" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb72-63"><a href="#cb72-63" tabindex="-1"></a></span>
<span id="cb72-64"><a href="#cb72-64" tabindex="-1"></a><span class="st">// [[Rcpp::export]]</span></span>
<span id="cb72-65"><a href="#cb72-65" tabindex="-1"></a><span class="st">NumericVector mh_C(int n_iter = 10000, double theta_init = 0.5, double proposal_sd = 0.05) {</span></span>
<span id="cb72-66"><a href="#cb72-66" tabindex="-1"></a><span class="st">  NumericVector theta_samples(n_iter);</span></span>
<span id="cb72-67"><a href="#cb72-67" tabindex="-1"></a><span class="st">  theta_samples[0] = theta_init;</span></span>
<span id="cb72-68"><a href="#cb72-68" tabindex="-1"></a><span class="st">  int accept_count = 0;</span></span>
<span id="cb72-69"><a href="#cb72-69" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb72-70"><a href="#cb72-70" tabindex="-1"></a><span class="st">  for (int i = 1; i &lt; n_iter; ++i) {</span></span>
<span id="cb72-71"><a href="#cb72-71" tabindex="-1"></a><span class="st">    double theta_prop = R::rnorm(theta_samples[i-1], proposal_sd);</span></span>
<span id="cb72-72"><a href="#cb72-72" tabindex="-1"></a><span class="st">    theta_prop = std::max(0.001, std::min(theta_prop, 0.999));</span></span>
<span id="cb72-73"><a href="#cb72-73" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb72-74"><a href="#cb72-74" tabindex="-1"></a><span class="st">    double log_p_current = log_posterior_C(theta_samples[i-1]);</span></span>
<span id="cb72-75"><a href="#cb72-75" tabindex="-1"></a><span class="st">    double log_p_prop = log_posterior_C(theta_prop);</span></span>
<span id="cb72-76"><a href="#cb72-76" tabindex="-1"></a><span class="st">    double accept_prob = std::min(1.0, exp(log_p_prop - log_p_current));</span></span>
<span id="cb72-77"><a href="#cb72-77" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb72-78"><a href="#cb72-78" tabindex="-1"></a><span class="st">    if (R::runif(0.0, 1.0) &lt; accept_prob) {</span></span>
<span id="cb72-79"><a href="#cb72-79" tabindex="-1"></a><span class="st">      theta_samples[i] = theta_prop;</span></span>
<span id="cb72-80"><a href="#cb72-80" tabindex="-1"></a><span class="st">      accept_count++;</span></span>
<span id="cb72-81"><a href="#cb72-81" tabindex="-1"></a><span class="st">    } else {</span></span>
<span id="cb72-82"><a href="#cb72-82" tabindex="-1"></a><span class="st">      theta_samples[i] = theta_samples[i-1];</span></span>
<span id="cb72-83"><a href="#cb72-83" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb72-84"><a href="#cb72-84" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb72-85"><a href="#cb72-85" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb72-86"><a href="#cb72-86" tabindex="-1"></a><span class="st">  int burn_in = floor(n_iter * 0.2);</span></span>
<span id="cb72-87"><a href="#cb72-87" tabindex="-1"></a><span class="st">  NumericVector theta_samples_burned = theta_samples[Range(burn_in, n_iter-1)];</span></span>
<span id="cb72-88"><a href="#cb72-88" tabindex="-1"></a><span class="st">  Rcout &lt;&lt; &quot;Rcpp版本接受率：&quot; &lt;&lt; (double)accept_count/(n_iter-1) &lt;&lt; &quot;</span><span class="sc">\\</span><span class="st">n&quot;;</span></span>
<span id="cb72-89"><a href="#cb72-89" tabindex="-1"></a><span class="st">  return theta_samples_burned;</span></span>
<span id="cb72-90"><a href="#cb72-90" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb72-91"><a href="#cb72-91" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb72-92"><a href="#cb72-92" tabindex="-1"></a></span>
<span id="cb72-93"><a href="#cb72-93" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="at">code =</span> cpp_code)</span>
<span id="cb72-94"><a href="#cb72-94" tabindex="-1"></a></span>
<span id="cb72-95"><a href="#cb72-95" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">103115</span>)</span>
<span id="cb72-96"><a href="#cb72-96" tabindex="-1"></a>samples_R <span class="ot">&lt;-</span> <span class="fu">mh_R</span>(<span class="at">n_iter =</span> <span class="dv">10000</span>, <span class="at">proposal_sd =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<p>R版本接受率： 0.709971</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">103115</span>)</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>samples_C <span class="ot">&lt;-</span> <span class="fu">mh_C</span>(<span class="at">n_iter =</span> <span class="dv">10000</span>, <span class="at">proposal_sd =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<p>Rcpp版本接受率：0.709971</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;R版本后验均值：&quot;</span>, <span class="fu">mean</span>(samples_R), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>R版本后验均值： 0.6211819</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Rcpp版本后验均值：&quot;</span>, <span class="fu">mean</span>(samples_C), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>Rcpp版本后验均值： 0.6211819</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;theta_qqplot.png&quot;</span>, <span class="at">width =</span> <span class="dv">600</span>, <span class="at">height =</span> <span class="dv">400</span>)</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a><span class="fu">qqplot</span>(samples_R, samples_C, </span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;R版本θ样本分位数&quot;</span>, </span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Rcpp版本θ样本分位数&quot;</span>,</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&quot;θ后验样本QQ图（R vs Rcpp）&quot;</span>)</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p>png 2</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>df_qq <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>  <span class="at">R_quantile =</span> <span class="fu">quantile</span>(samples_R, <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="fl">0.01</span>)),</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a>  <span class="at">C_quantile =</span> <span class="fu">quantile</span>(samples_C, <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="fl">0.01</span>))</span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>)</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a><span class="fu">ggplot</span>(df_qq, <span class="fu">aes</span>(<span class="at">x =</span> R_quantile, <span class="at">y =</span> C_quantile)) <span class="sc">+</span></span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;R版本θ分位数&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Rcpp版本θ分位数&quot;</span>,</span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;θ后验样本QQ图（R vs Rcpp）&quot;</span>) <span class="sc">+</span></span>
<span id="cb77-11"><a href="#cb77-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb77-12"><a href="#cb77-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;theta_qqplot_ggplot.png&quot;</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>time_compare <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>  <span class="at">R_version =</span> <span class="fu">mh_R</span>(<span class="at">n_iter =</span> <span class="dv">5000</span>),</span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>  <span class="at">Rcpp_version =</span> <span class="fu">mh_C</span>(<span class="at">n_iter =</span> <span class="dv">5000</span>),</span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">10</span></span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>)</span></code></pre></div>
<p>Rcpp版本接受率：0.715943 R版本接受率： 0.7053411
Rcpp版本接受率：0.722545 Rcpp版本接受率：0.717744
Rcpp版本接受率：0.705541 R版本接受率： 0.7095419
Rcpp版本接受率：0.711142 R版本接受率： 0.7131426 R版本接受率： 0.7141428
R版本接受率： 0.7069414 Rcpp版本接受率：0.721344 R版本接受率： 0.7129426
R版本接受率： 0.7195439 R版本接受率： 0.7077415 R版本接受率： 0.7089418
R版本接受率： 0.7113423 Rcpp版本接受率：0.711342
Rcpp版本接受率：0.706341 Rcpp版本接受率：0.718144
Rcpp版本接受率：0.69914</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">print</span>(time_compare)</span></code></pre></div>
<p>Unit: milliseconds expr min lq mean median uq max neval R_version
33.9160 36.5652 39.34649 38.29960 42.8172 46.3616 10 Rcpp_version 1.8637
1.9548 2.32245 2.08165 2.4763 3.8068 10</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;time_comparison.png&quot;</span>, <span class="at">width =</span> <span class="dv">600</span>, <span class="at">height =</span> <span class="dv">400</span>)</span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a><span class="fu">autoplot</span>(time_compare) <span class="sc">+</span> </span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;R vs Rcpp 运行时间对比&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<pre><code>## Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
## ℹ Please use tidy evaluation idioms with `aes()`.
## ℹ See also `vignette(&quot;ggplot2-in-packages&quot;)` for more information.
## ℹ The deprecated feature was likely used in the microbenchmark package.
##   Please report the issue at
##   &lt;https://github.com/joshuaulrich/microbenchmark/issues/&gt;.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p>png 2</p>
</div>
<div id="结果分析-29" class="section level3">
<h3>1.3 结果分析</h3>
<p>代码正确性验证：Rcpp 版本实现无偏差 运行性能对比：Rcpp 版本效率提升超
15 倍 后验分布特征：θ 的估计符合遗传连锁问题规律</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
